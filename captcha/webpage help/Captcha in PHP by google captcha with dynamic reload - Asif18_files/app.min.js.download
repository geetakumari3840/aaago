var app;app=angular.module("asif18",["ui.bootstrap","ngAnimate","angular-growl","ngSanitize","vcRecaptcha"]),angular.element(document.getElementsByTagName("pre")).addClass("prettyprint"),app.config(["growlProvider",function(growlProvider){growlProvider.onlyUniqueMessages(!0)}]),app.filter("capitalize",function(){return function(input,all){var reg=all?/([^\W_]+[^\s-]*) */g:/([^\W_]+[^\s-]*)/;return input?input.replace(reg,function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase()}):""}}),app.directive("preloader",["$animate","$timeout","$q",function($animate,$timeout,$q){function link(scope,el){function startCounter(){var remaining=100-counter;counter+=.015*Math.pow(1-Math.sqrt(remaining),2),scope.loadCounter=parseInt(counter,10),timeout=$timeout(startCounter,20)}function endCounter(){$timeout.cancel(timeout),scope.loadCounter=100,$timeout(function(){$animate.addClass(el,"preloader-hidden"),angular.element("body").css("overflow","")},300)}scope.loadCounter=0;var timeout,counter=0;angular.element("body").css("overflow","hidden"),el.addClass("preloader"),endCounter(),timeout=$timeout(startCounter)}var directive={restrict:"EAC",template:'<div class="preloader-progress"><div class="preloader-progress-bar" ng-style="{width: loadCounter + \'%\'}"></div></div>',link:link};return directive}]),app.directive("sectionloader",["$animate","$timeout","$q",function($animate,$timeout,$q){function link(scope,el){}var directive={restrict:"EAC",scope:{loading:"="},template:'<div class="section-loader" ng-show="loading"><div class="section-loader-animation"><em class="fa fa-circle-o-notch fa-spin fa-3x fa-fw"></em></div></div>',link:link};return directive}]),app.directive("routerloader",["$animate",function($animate){function link(scope,el){}var directive={restrict:"EAC",scope:{loading:"="},template:'<div class="router-loader" ng-show="loading"><div class="progress progress-striped active"><div class="progress-bar progress-bar-color" id="bar" role="progressbar" style="width: 1000%;"></div></div>',link:link};return directive}]);var CommentsController=function($scope,CommentService){$scope.model={assetsUrl:APPCONFIG.assetsUrl};var self=this;this.$onInit=function(){$scope.model.articleId=self.articleId}},CommentsFormController=function($scope,$timeout,$window,$uibModal,growl,CommentService,vcRecaptchaService){$scope.model={assetsUrl:APPCONFIG.assetsUrl,isLoading:!1,gCaptchaSiteKey:APPCONFIG.gCaptchaSiteKey,response:null,widgetId:null,formData:{name:"",email:"",comment:""}};var self=this;this.$onInit=function(){$scope.model.articleId=self.articleId,$scope.model.commentType=self.commentType,$scope.model.commentId=self.commentId?self.commentId:null},$scope.setResponse=function(response){$scope.model.response=response},$scope.setWidgetId=function(widgetId){$scope.model.widgetId=widgetId},$scope.cbExpiration=function(){vcRecaptchaService.reload($scope.model.widgetId),$scope.model.response=null},$scope.autoExpand=function(e){var element="object"==typeof e?e.target:document.getElementById(e),scrollHeight=element.scrollHeight;element.style.height=scrollHeight+"px"},$scope.autoExpand("comment"),$scope.saveComment=function(){if(""==$scope.model.articleId)return growl.error("Invalid commenting on article",{ttl:3e3}),!1;if(""==$scope.model.formData.name)return growl.error("Enter name",{ttl:5e3}),!1;if(""==$scope.model.formData.email)return growl.error("Enter email",{ttl:5e3}),!1;if(""==$scope.model.formData.comment)return growl.error("Enter comments",{ttl:5e3}),!1;if(null===$scope.model.response)return growl.error("Please check the captcha",{ttl:3e3}),!1;var postData={articleId:$scope.model.articleId,commentId:$scope.model.commentId,name:$scope.model.formData.name,email:$scope.model.formData.email,comments:$scope.model.formData.comment,captcha:$scope.model.response};$scope.model.isLoading=!0,CommentService.saveComment(postData).then(function(response){$scope.cbExpiration(),$scope.model.isLoading=!1,1==response.data.status&&$uibModal.open({templateUrl:"showMessage.html",animation:!0,size:"md","static":!0,resolve:{modalData:function(){return{msg:response.data.msg}}},controller:["$scope","$window","modalData",function($scope,$window,modalData){$scope.msg=modalData.msg,$scope.okay=function(){$window.location.reload()}}]})})}},CommentsShowerController=["$scope","$timeout","CommentService",function($scope,$timeout,CommentService){$scope.model={assetsUrl:APPCONFIG.assetsUrl,isLoading:!1};var self=this;this.$onInit=function(){$scope.model.articleId=self.articleId,$scope.getComments()},$scope.getComments=function(){var postData={articleId:$scope.model.articleId};$scope.model.isLoading=!0,CommentService.getComments(postData).then(function(response){$scope.model.isLoading=!1,$scope.model.commentsData=response.data,$timeout(function(){angular.element(document.getElementsByTagName("pre")).addClass("prettyprint")},500)})}}];app.directive("comments",function(){return{restrict:"EA",controller:CommentsController,scope:{articleId:"="},bindToController:!0,templateUrl:APPCONFIG.assetsUrl+"site/app/views/comments.html"}}),app.directive("commentForm",function(){return{restrict:"E",controller:CommentsFormController,scope:{articleId:"=",commentType:"=",commentId:"="},bindToController:!0,templateUrl:APPCONFIG.assetsUrl+"site/app/views/comments-form.html"}}),app.directive("commentShower",function(){return{restrict:"EA",controller:CommentsShowerController,scope:{articleId:"=",commentId:"="},bindToController:!0,templateUrl:APPCONFIG.assetsUrl+"site/app/views/comments-shower.html"}}),app.service("AppService",["$timeout","$rootScope","$http","growl",function($timeout,$rootScope,$http,growl){var AppServiceOp={};return AppServiceOp.isJson=function(response){var contentType=typeof response;return contentType.toLowerCase(),"json"==contentType||"object"==contentType},AppServiceOp.checkNetworkException=function(response){return response&&AppServiceOp.isJson(response.data)?null===response.data.exception||!response.data.exception.status||(AppServiceOp.systemError(response.data.exception.msg),!1):(AppServiceOp.systemError(),!1)},AppServiceOp.systemError=function(msg){msg?growl.error(msg,{ttl:3e3}):growl.error("Something went wrong! Server is not giving expected response. Try again later",{ttl:3e3})},AppServiceOp}]),app.service("CommentService",["$http","AppService",function($http,AppService){var AppServiceOp={};return AppServiceOp.getComments=function(data){return $http.post(APPCONFIG.WSURLS.getComments,data).then(function(response){return!!AppService.checkNetworkException(response)&&response.data},function(response){AppService.checkNetworkException(response)})},AppServiceOp.saveComment=function(data){return $http.post(APPCONFIG.WSURLS.saveComment,data).then(function(response){return!!AppService.checkNetworkException(response)&&response.data},function(response){AppService.checkNetworkException(response)})},AppServiceOp}]),app.controller("HeaderController",["$scope",function($scope){function init(){}$scope.model={collapseMainMenu:!0},init()}]);