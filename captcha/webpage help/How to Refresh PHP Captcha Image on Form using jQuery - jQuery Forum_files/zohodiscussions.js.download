function sanitizeURL(s){if(!s||""==s)return s;var pos=s.indexOf(":");if(-1!=pos){var st=s.substr(0,pos);"http"!=st&&"https"!=st&&"ftp"!=st&&"mailto"!=st&&(s="http://"+s)}else s="http://"+s;return s}function sanitize(s){return null==s||""==s||4e4<(s=(s=(s=(s=(s=(s=(s=s.replace(/<!--(.|\n)*?-->/gm,"")).replace(/<(title|script|style|meta|link)\b((.|\n)*?)<\/\1\b(.*?)>/gim,"")).replace(/<(title|script|style|meta|link)\b((.|\n)*?)>/gim,"")).replace(/<\/?(html|head|(x?meta)|title|script|style|link|noembed|bgsound|frame|frameset|noframes)((.|\n)*?)>\n*?/gim,"")).replace(/<\/?([a-z].*)\b[^>]*>/gim,function(_1){return _1=(_1=(_1=(_1=(_1=(_1=(_1=(_1=(_1=(_1=(_1=(_1=(_1=_1.replace(/\\0/gim,"")).replace(/<\/?body/gim,function(_5){return _5="<body"==_5.toLowerCase()?"<div":"</div"})).replace(/\/\*[^*]+\*\//gim,"")).replace(/\Won[A-Z]*(\\s)*?=(\\s)*?(\'|\"|`)(.|\n)*?(\3)/gim,"")).replace(/\Wclass(\\s)*?=(\\s)*?(\'|\"|`)(.|\n)*?(\3)/gim,"")).replace(/\Wid(\\s)*?=(\\s)*?(\'|\"|`)(.|\n)*?(\3)/gim,"")).replace(/\Wdocument\.cookie/gim,"")).replace(/\.cookie/gim,"")).replace(/\Wwindow\.location/gim,"")).replace(/\.location/gim,"")).replace(/\Wjavascript(\\s|\n)*?:/gim,"")).replace(/(href|src)(\\s|\n)*?=(\\s|\n)*?(\'|\"|`)((.|\n)*?)[^\\](\4)/gim,function(_2){var sub=_2.substr(0,3).toLowerCase(),htp=null;return"hre"==sub?htp=new RegExp("('|\"|`)((https?|ftp)|(mailto)):","gmi"):"src"==sub&&(htp=new RegExp("('|\"|`)(https?):|(^/GetImage?imageName=)","gmi")),_2=_2.replace(/(\'|\"|`)((.|\n)*?)[^\\](\1)/gim,function(_3){return htp.test(_3)||(_3='""'),_3})})).replace(/style(\\s|\n)*?=(\\s|\n)*?(\'|\"|`)((.|\n)*?)[^\\](\3)/gim,function(_4){return _4=(_4=_4.replace(/url\((.|\n)*?\)/gim,"")).replace(/expression\((.|\n)*?\)/gim,"")})})).replace(/<[a-z][a-z0-9]*\s?:\s?[a-z][a-z0-9]*[^>]*>/gim,"")).replace(/\s*?\n$/gim,"")).length&&(alert(i18n["zohodiscussions.general.textExceedMaximumSizeMessage"]),s=s.substring(0,4e4)),s}function discussionsValidate($containerToValidate){var $elementsToValidate=$(":input",$containerToValidate),returnValue=!0,validate={integer_pattern:/^[\-|\+]?\d+$/,integer_message:"Please enter a valid integer number",float_pattern:/^[\-|\+]?(?:\d*\.?\d+|\d+\.)$/,float_message:"Please enter a valid number",email_pattern:"^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+.[a-zA-Z]{2,6}$",email_message:"Please enter a valid email",multipleemail_pattern:/^(?:[a-zA-Z0-9]([\w\-\.\+]*)@([\w\-\.]*)(\.[a-zA-Z]{2,4}(\.[a-zA-Z]{2}){0,2}),?\s*)+$/i,multipleemail_message:"Please enter a valid email ids",id_pattern:/^([\w-]+(?:[\w-]+)*)$/i,id_message:"Please enter a valid id. Spaces are not allowed",url_pattern:/^(?:(?:\w|\d)+\.)+[a-zA-Z0-9]{2,6}$/,url_message:"Please enter a valid URL",pattern_message:"Sorry. The entered value does not match the required pattern",color_pattern:/^[A-Fa-f0-9]*$/},isTipper="true"==$containerToValidate.attr("isTipper");return $elementsToValidate.filter('[trim="true"]').each(function(index,eachItem){$(eachItem).val($(eachItem).val().replace(/^\s+/,"").replace(/\s+$/,""))}).end().filter('[mandatory="true"]').each(function(index,eachItem){var $eachItem=$(eachItem);""==$eachItem.val()&&(message=getCustomMessage($eachItem,$eachItem.attr("title")+" cannot be left blank! Please provide a value"),showError($eachItem,message,isTipper),returnValue=!1)}).end().filter("[dataType]").each(function(index,eachItem){var $eachItem=$(eachItem),valueToValidate=$eachItem.val();if(valueToValidate&&""!=valueToValidate){var dataType=$eachItem.attr("dataType");try{dataType=dataType.toLowerCase();var patternToCheck=validate[dataType+"_pattern"],defaultMessage=validate[dataType+"_message"];void 0===defaultMessage&&(defaultMessage=$eachItem.attr("message")),null==valueToValidate.match(patternToCheck)&&(showError($eachItem,getCustomMessage($eachItem,defaultMessage),isTipper),returnValue=!1)}catch(e){return}}}),returnValue}function getCustomMessage($field,defaultMessage){try{return customMessage=$field.attr("message"),customMessage&&""!=customMessage||(customMessage=defaultMessage),customMessage}catch(e){return defaultMessage}}function showError($field,message,isTipper){if(isTipper)return showTipper(message,"failure"),!1;var errorLocation=$field.attr("name")+"_Error";return $("#"+errorLocation).html(message).show(),!1}function doAjaxAction(actionURL,options,callbackSuccessFunction,callbackErrorFunction){"undefined"!=typeof discussionsZaid?options.portalzaid=discussionsZaid:options.portalzaid="-1","undefined"!=typeof isSupportPortalCall&&1==isSupportPortalCall?options.supportPortal="portal/":options.supportPortal="","undefined"!=typeof discussionsZaaid?options.portalzaaid=discussionsZaaid:options.portalzaaid="-1",$.ajax({url:context+actionURL,type:"POST",data:options,error:1==isROMode?roFailureMessage:callbackErrorFunction,success:callbackSuccessFunction})}function roFailureMessage(errorData){var responseData=$.parseJSON(errorData.responseText);showTipper(i18n[responseData.message],"failure",3e3)}function showLoadingImage(loadingMessage){}function hideLoadingImage(){$("#loadingImg:visible").hide(),$("#ajaxLoaderSmall").remove()}function showSmallLoadingImage(event,topOffset,leftOffset){}function showSmallLoadingImageForCont($target,topOffset,leftOffset){topOffset=null!=topOffset?topOffset:0,topOffset=$target.offset().top+topOffset,leftOffset=null!=leftOffset?leftOffset:0,leftOffset=$target.offset().left+leftOffset;var currPos={};currPos.top=topOffset,currPos.left=leftOffset;var $loadingImageCont=$("#ajaxLoaderSmallTemp").clone();$loadingImageCont.attr("popoutPurpose","ajaxLoaderSmall"),$loadingImageCont.attr("id","ajaxLoaderSmall"),$loadingImageCont.css(currPos).show(),$loadingImageCont.appendTo("body"),$loadingImageCont.siblings('div[popoutPurpose="ajaxLoaderSmall"]').remove()}function goToTop(smoothScroll){return smoothScroll&&1==smoothScroll?$("html,body").animate({scrollTop:0},1e3):$(window).scrollTop(0),!1}function setFocusToContainer($container,smoothScroll,timeOut,topPx){var topDiff=$container.offset().top,topShowPx=50;return null!=topPx&&(topShowPx=topPx),smoothScroll&&1==smoothScroll?(timeOut=timeOut||1e3,$("html,body").animate({scrollTop:topDiff-topShowPx},timeOut)):(timeOut=null!=timeOut?timeOut:300,setTimeout(function(){IS_EMBEDDED&&isEmbedAllowedService()?setZDIFrameTop(topDiff-topShowPx):$(window).scrollTop(topDiff-topShowPx)},timeOut)),!1}function showDiscussionMessage(message,messageType){return showNewTopicMessage(message,messageType),!1}function showMessage(message,messageType,boxwidth){return messageType=messageType||"info",$("#messageContentCont").html(message),void 0===boxwidth&&(boxwidth="20%"),$("#messageContainer").find("div.borderBox").css("width",boxwidth),$("#messageContainer").attr("class",messageType).fadeIn(100,function(){setTimeout(function(){$("#messageContainer:visible").fadeOut(500)},6e3)}),$("#messageContainerClose").show(),!1}function showNewTopicMessage(message,messageType,boxwidth){return messageType=messageType||"info",$("#messageContentCont").html(message),void 0===boxwidth&&(boxwidth="20%"),$("#messageContainer").find("div.borderBox").css("width",boxwidth),$("#messageContainer").attr("class",messageType).fadeIn(100,function(){setTimeout(function(){$("#messageContainer:visible").fadeOut(500)},6e3)}),$("#messageContainerClose").show(),!1}function hideMessage(){$("#messageContainer").fadeOut(100)}function showTipper(message,messageType,timeOut){messageType=messageType||"info",timeOut=timeOut||4e3,$("#messageContentCont").html(message),$("#messageContainerClose").hide(),$("#messageContainer").attr("class",messageType).fadeIn(500,function(){setTimeout(function(){$("#messageContainer").fadeOut(500)},timeOut)})}function setToHotkeys(){if(isEmbedService())return!1;0==isMac&&$("#topicListMainContainer").is(":visible")&&setupKbdShortcuts()}function setHotkeysToSinglePost(){if(isEmbedService())return!1;$("#SinglePostContainer").is(":visible")&&setupKbdShortcutsToSinglePost()}function removeHotkeys(){$.hotkeys.remove("o"),$.hotkeys.remove("esc"),$.hotkeys.remove("j"),$.hotkeys.remove("return"),$.hotkeys.remove("space"),$.hotkeys.remove("k"),$.hotkeys.remove("shift+space"),$.hotkeys.remove("n"),$.hotkeys.remove("p"),$.hotkeys.remove("v")}function findCurrentSinglePost(){var $topicList=$("#topicList");return $topicList.length<1&&($topicList=$("#topicsList")),$currentSelected=$topicList.data("currentFocusPost"),(!$currentSelected||$currentSelected.length<1)&&($currentSelected=$topicList.data("currentSelectedPost")),(!$currentSelected||$currentSelected.length<1)&&($currentSelected=$topicList.find("div.singleTopicCont:first")),$currentSelected}function setupKbdShortcuts(){$.hotkeys.add("",{disableInInput:!0}),$.hotkeys.add("o",function(){var currTopicId=findCurrentSinglePost().attr("forumTopicId");handleTopicClick($("quickView_"+currTopicId),currTopicId,"topicList")}),$.hotkeys.add("v",function(){(showLoadingImage(),"false"==isTopicQuickView)||processHash("Topic/"+findCurrentSinglePost().attr("forumTopicId"))}),$.hotkeys.add("esc",function(){var currTopicId=findCurrentSinglePost().attr("forumTopicId");$("#lastResponse_"+currTopicId).is(":visible")&&handleTopicClick($("quickView_"+currTopicId),currTopicId,"topicList")}),$.hotkeys.add("return",function(){var currTopicId=findCurrentSinglePost().attr("forumTopicId");window.open(serverURL+"?ftid="+currTopicId)}),$.hotkeys.add("space",function(){var $currentSelected=findCurrentSinglePost();if($currentSelected.is("div.singleTopicContSel")){var topicListTop=$(window).height(),scrollTop=$(window).scrollTop();$currentSelected.height();if($currentSelected.next().offset().top<topicListTop+scrollTop){if(($currentSelected=$currentSelected.next()).is(".singleTopicCont")){var currTopicId=$currentSelected.attr("forumTopicId");handleTopicClick($("quickView_"+currTopicId),currTopicId,"topicList")}}else $(window).scrollTop(scrollTop+topicListTop-50)}else if($currentSelected.is(".singleTopicCont")){currTopicId=$currentSelected.attr("forumTopicId");handleTopicClick($("quickView_"+currTopicId),currTopicId,"topicList")}}),$.hotkeys.add("shift+space",function(){var $currentSelected=findCurrentSinglePost();if($currentSelected.is("div.singleTopicContSel")){var topicListTop=$(window).height(),scrollTop=$(window).scrollTop();if(scrollTop-topicListTop<$currentSelected.prev().offset().top-50){if(($currentSelected=$currentSelected.prev()).is(".singleTopicCont")){var currTopicId=$currentSelected.attr("forumTopicId");handleTopicClick($("quickView_"+currTopicId),currTopicId,"topicList")}}else $(window).scrollTop(scrollTop-topicListTop+50)}else if($currentSelected.is(".singleTopicCont")){currTopicId=$currentSelected.attr("forumTopicId");handleTopicClick($("quickView_"+currTopicId),currTopicId,"topicList")}}),$.hotkeys.add("j",function(){var $currentSelected=findCurrentSinglePost();if($currentSelected.is("div.singleTopicContSel")&&($currentSelected=$currentSelected.next()),$currentSelected.is("div.singleTopicCont")){var currTopicId=$currentSelected.attr("forumTopicId");handleTopicClick($("quickView_"+currTopicId),currTopicId,"topicList")}}),$.hotkeys.add("k",function(){var $currentSelected=findCurrentSinglePost();if($currentSelected.is("div.singleTopicContSel")&&($currentSelected=$currentSelected.prev()),$currentSelected.is("div.singleTopicCont")){var currTopicId=$currentSelected.attr("forumTopicId");handleTopicClick($("quickView_"+currTopicId),currTopicId,"topicList")}}),$.hotkeys.add("n",function(){var $currentSelected=findCurrentSinglePost(),$nextFromCurrSelected=$currentSelected.next();($nextFromCurrSelected.is("div.singleTopicCont")||$nextFromCurrSelected.is("div.singleTopicContSel"))&&($currentSelected.removeClass("hotKeyTopicCont"),$nextFromCurrSelected.addClass("hotKeyTopicCont"),$("#topicList").data("currentFocusPost",$nextFromCurrSelected),toSetFocusOnCurrPost($nextFromCurrSelected,"next"))}),$.hotkeys.add("p",function(){var $currentSelected=findCurrentSinglePost(),$prevFromCurrSelected=$currentSelected.prev();($prevFromCurrSelected.is("div.singleTopicCont")||$prevFromCurrSelected.is("div.singleTopicContSel"))&&($currentSelected.removeClass("hotKeyTopicCont"),$prevFromCurrSelected.addClass("hotKeyTopicCont"),$("#topicList").data("currentFocusPost",$prevFromCurrSelected),toSetFocusOnCurrPost($prevFromCurrSelected,"prev"))})}function toSetFocusOnCurrPost($currentSelected,isProvide){var focusPostTop=$currentSelected.offset().top,windowHeight=$(window).height(),scrollTop=$(window).scrollTop();"next"==isProvide?windowHeight-50<focusPostTop-scrollTop&&$(window).scrollTop(focusPostTop-windowHeight+80):focusPostTop<scrollTop&&$(window).scrollTop(focusPostTop)}function setupKbdShortcutsToSinglePost(){$.hotkeys.add("",{disableInInput:!0}),$.hotkeys.add("o",function(){return!1}),$.hotkeys.add("v",function(){return!1}),$.hotkeys.add("esc",function(){return!1}),$.hotkeys.add("return",function(){var currTopicId=$("#SinglePostContainer").attr("forumTopicId");window.open(serverURL+"?ftid="+currTopicId)}),$.hotkeys.add("space",function(){var topicListTop=$(window).height(),scrollTop=$(window).scrollTop();$(window).scrollTop(scrollTop+topicListTop)}),$.hotkeys.add("shift+space",function(){var topicListTop=$(window).height(),scrollTop=$(window).scrollTop();$(window).scrollTop(scrollTop-topicListTop)}),$.hotkeys.add("j",function(){$currentSelected=findCurrentSingleResponse();var keyCount=0,currKey=$currentSelected.attr("currkey");null!=currKey&&(keyCount=currKey),keyCount++,toSetFocusOnCurrResponse($currentSelected,keyCount)}),$.hotkeys.add("k",function(){$currentSelected=findCurrentSingleResponse();var keyCount=0,currKey=$currentSelected.attr("currkey");if(null==currKey)return!1;keyCount=currKey,keyCount--,toSetFocusOnCurrResponse($currentSelected,keyCount)}),$.hotkeys.add("n",function(){$currentSelected=findCurrentSingleResponse();var keyCount=0,currKey=$currentSelected.attr("currkey");null!=currKey&&(keyCount=currKey),keyCount++,toSetFocusOnCurrResponse($currentSelected,keyCount)}),$.hotkeys.add("p",function(){$currentSelected=findCurrentSingleResponse();var keyCount=0,currKey=$currentSelected.attr("currkey");if(null==currKey)return!1;keyCount=currKey,keyCount--,toSetFocusOnCurrResponse($currentSelected,keyCount)})}function findCurrentSingleResponse(){if($currentSelected=$("#SinglePostContainer").data("currentFocusResponse"),!$currentSelected||$currentSelected.length<1){var currForumTopicId=$("#SinglePostContainer").attr("forumTopicId");$currentSelected=$("#SinglePostContainer_"+currForumTopicId).find("div.postContainer")}return $currentSelected}function toSetFocusOnCurrResponse($currentSelected,keyCount){var currForumTopicId=$("#SinglePostContainer").attr("forumTopicId"),$focusResponse="";if("0"==keyCount)$focusResponse=$("#SinglePostContainer_"+currForumTopicId).find("div.postContainer"),$currentSelected.removeClass("HotKeysingleReplyContainer");else{if(0==($focusResponse=$("#SinglePostContainer_"+currForumTopicId).find("span.hotKey_"+keyCount)).length)return!1;$currentSelected.removeClass("HotKeysingleReplyContainer"),$focusResponse.addClass("HotKeysingleReplyContainer")}var currResponseTop=$focusResponse.offset().top;$("html,body").animate({scrollTop:currResponseTop-10},500),$("#SinglePostContainer").data("currentFocusResponse",$focusResponse)}function resizeZDIFRAME(zdHt){1==IS_EMBEDDED&&isEmbedAllowedService()&&(zdHt=zdHt||$("#mainContent").height())&&(DOC_HT=zdHt,document.cookie="zdHt="+zdHt+";path=/",SendMessageToParent("zdframeht:"+parseInt(zdHt+12)))}function setZDIFrameTop(top){top=top||0,SendMessageToParent("zdframetop:"+top)}function uploadShowMessage(errorMsg){forHidingSmallLoadingImg(),hideLoadingImage(),showMessage(i18n[errorMsg],"failure"),($("#publishResponse").attr("disabled")||$("#publishTopic").attr("disabled"))&&($("#publishResponse,#previewResponse").attr("disabled",!1),$("#publishTopic,#saveDraft").attr("disabled",!1),loadUploadAttachmentsCont())}function countString(count){return"0"!=count?" ("+(count-1)+")":""}function slideUpActionInModeration(actionURL,options,$this){showLoadingImage();var parent=$this.parents("div.moderateSinglePost"),itemType=$this.attr("itemType");parent.slideUp(300,function(){parent.hide()});var totalModerationSelSpanTag=$("#moderationTabCont").find('li[itemType="All"]').find("span"),totalModerationSeleCount=totalModerationSelSpanTag.attr("totalCount");countHTML=countString(totalModerationSeleCount),totalModerationSelSpanTag.html(countHTML).attr("totalCount",totalModerationSeleCount-1);var totalModerationItemSpanTag=$("#moderationTabCont").find("li[itemType="+itemType+"]").find("span"),totalModerationItemCount=totalModerationItemSpanTag.attr("totalCount");countHTML=countString(totalModerationItemCount),totalModerationItemSpanTag.html(countHTML).attr("totalCount",totalModerationItemCount-1),hideLoadingImage(),doAjaxAction(actionURL,options,function(data){if("SUCCESS"==data){var totalModerationTabCount=$("#awaitingCountCont").attr("totalCount"),countHTML=countString(totalModerationTabCount);if($("#awaitingCountCont").html(countHTML).attr("totalCount",totalModerationTabCount-1),parent.remove(),1==totalModerationSeleCount||1==totalModerationTabCount||1==totalModerationItemSpanTag){var tabPurpose=$("#moderationTabCont").find("li.selected").attr("tabPurpose");refreshingPage(tabPurpose)}}else{tabPurpose=$("#moderationTabCont").find("li.selected").attr("tabPurpose");refreshingPage(tabPurpose),showTipper(i18n["zohodiscussions.moderationAction.errormessage"],"failure",2e3)}},function(errordata){var totalModerationTabCount=$("#awaitingCountCont").attr("totalCount"),countHTML=countString(totalModerationTabCount);$("#awaitingCountCont").html(countHTML).attr("totalCount",totalModerationTabCount+1);var tabPurpose=$("#moderationTabCont").find("li.selected").attr("tabPurpose");refreshingPage(tabPurpose),showTipper(i18n["zohodiscussions.moderationAction.errormessage"],"failure",2e3)})}function isEmbedCallfromIntranet(){if(IS_EMBEDDED){var DOC_HT=$("#mainContent").height();clearTimeout(checkHt);var checkHt=setTimeout(function(){var mainHt=$("#mainContent").height();DOC_HT&&DOC_HT!=mainHt&&(DOC_HT=mainHt,clearTimeout(checkHt))},300)}}function isHistoryNotAllowedService(givenkey,fetchPage){return!isZIntranet&&!isZSupport&&(givenkey&&(1<parseInt(fetchPage)?$.history.add(givenkey+"/"+fetchPage):$.history.add(givenkey)),!0)}function isEmbedAllowedService(){return!isZIntranet&&!isZSupport}function isEmbedService(){return!(!isZIntranet&&!isZSupport)}function isFromSupportService(){return!!isZSupport}function isCancelButtonClicked(hash){return isZIntranet||isZSupport?forumClickAction(-1):processHash(hash),!1}function toEvaluateData(data){if("({"===(data=$.trim(data)).substring(0,2)&&"})"===data.substring(data.length-2)){var jsonFormatString=data.substring(1,data.length-1).replace(/'/g,'"');return jsonFormatString=$.trim(jsonFormatString),$.parseJSON(jsonFormatString)}return data}function getValidLocationHash(hash){var currHash=void 0===hash?location.hash:hash;if(null!=currHash&&""!=currHash.trim()){var hashIndex=currHash.indexOf("#");hashIndex=-1===hashIndex?0:hashIndex+1;var slashIndex=currHash.indexOf("/");slashIndex=-1===slashIndex?currHash.length:slashIndex,currHash=currHash.substring(hashIndex,slashIndex)}return null!=currHash&&""!=currHash&&isNaN(currHash)&&-1===["home","chome","alltags","allforums","stats","search","normalsearch","myarea","moderation","settings","topic","forum","filter","user","tag","newtopic","newdiscussion","newquestion","newidea","newproblem","tpw","users","gettingstarted","resourcesearch","comments"].indexOf(currHash.trim().toLowerCase())&&(hash=location.hash="home"),hash}function encodeHTML(value){return value?$("<div></div>").text(value).html():""}function decodeHTML(value){return value?$("<div></div>").html(value).text():""}function setCookie(name,value,exp_y,exp_m,exp_d,path,domain,secure){var cookie_string=name+"="+escape(value);exp_y&&(cookie_string+="; expires="+new Date(exp_y,exp_m,exp_d).toGMTString());path&&(cookie_string+="; path="+escape(path)),domain&&(cookie_string+="; domain="+escape(domain)),secure&&(cookie_string+="; secure"),document.cookie=cookie_string}function getCookie(cookie_name){var results=document.cookie.match(cookie_name+"=(.*?)(;|$)");return results?unescape(results[1]):null}function deleteCookie(cookie_name){var cookie_date=new Date;cookie_date.setTime(cookie_date.getTime()-1),document.cookie=cookie_name+="=; expires="+cookie_date.toGMTString()}function showAnnouncementDiv(cookie_name){null==getCookie(cookie_name)&&$("#ZDBanner").show()}function hideAnnouncementDiv(cookie_name){if(null==getCookie(cookie_name)){var currDate=new Date,year=currDate.getFullYear(),month=currDate.getMonth()+1,date=currDate.getDate();30<date&&(date=2==month?28:30),$("#ZDBanner").hide(),setCookie(cookie_name,!0,year,month,date)}}function newOpenEditor(location,name,textAreaID,replyLinkLocation,editorMode,utilContLocation,IsPrivateResponse){var $toMask=location.show(),$attachmentContainer=$toMask.next(),$ta=$('<textArea name = "'+name+'" id = "'+textAreaID+'" style = "display:none;"></textarea>'),originalValue="",appendSignature=!0;"Edit"==editorMode||"privateMsgContent"==name?appendSignature=!1:"true"==$("#writeNewTopic").attr("isDraft")&&(appendSignature=!1),originalValue=" "+(originalValue=$toMask.is(":input")?$toMask.val():$toMask.html());var $frm,temp_content=document.createElement("div");temp_content.innerHTML=originalValue,$(temp_content).find("div.__zd_findAndReplace").remove(),$(temp_content).find("div.__zd_findAndReplaceParent").remove(),originalValue=temp_content.innerHTML,1==appendSignature&&(originalValue+=userSignature),$ta.val($.trim(originalValue));var $finalCont,forumTopicId="",tweetStatusId="",isForumIdThere=!1;if(replyLinkLocation){$("#editorHolder").remove(),$frm=$('<form id = "editorHolder"></form>'),$replyLinkLocation=$("#"+replyLinkLocation),forumTopicId=(forumTopicId=$replyLinkLocation.attr("forumTopicId"))||$replyLinkLocation.parents('div[parentCont="actualParent"]').attr("forumTopicId");var responseId=$replyLinkLocation.attr("responseId"),isPrivate=$replyLinkLocation.attr("isPrivate"),isThread=$replyLinkLocation.attr("isThread"),forumId=$replyLinkLocation.attr("forumId"),categoryId=$replyLinkLocation.attr("categoryId"),responseAuthorId=$replyLinkLocation.attr("responseAuthorId"),threadSorting=!1;null!=$("#SinglePostContainer").attr("sortThread")&&(threadSorting=$("#SinglePostContainer").attr("sortThread"));var postTitle="";if("TweetPost"==editorMode){var tweetBy=$replyLinkLocation.attr("tweetBy");tweetStatusId=$replyLinkLocation.attr("statusId");var tweetContnet=$("#twitterCont_"+tweetStatusId).text(),tweetByImg=$("#twitterImg_"+tweetStatusId).attr("src");$finalCont=$('<div style="clear:both;" class="replyContainer" id="replyTweetContainer_'+tweetStatusId+'"></div>');var $cont=$('<div class="content"></div>');$cont.append($frm),$finalCont.append('<div class="boldText header">Reply to @'+tweetBy+"</div>"),$finalCont.append($cont);var $forumoptions=$('<div class="ndSelectionCont"</div>');$forumoptions.html($("#twitterForumsOptions").html()),$frm.append($forumoptions),$frm.append('<input type = "hidden" name = "twitterAuthorId" value = "'+tweetBy+'">').append('<input type = "hidden" name = "twitterAuthImg" value = "'+tweetByImg+'">').append('<input type = "hidden" name = "statusTwitterId" value = "'+tweetStatusId+'">').append('<input type = "hidden" name = "tweetContent" value = "'+tweetContnet+'">').append('<input type = "hidden" name = "twitterResponseContent" value = "">').append('<input type = "hidden" name = "topicStatus" value = "0">'),-1!=forumId&&($frm.append('<input type = "hidden" name = "forumId" value = "'+forumId+'">'),isForumIdThere="true"),-1!=categoryId&&$frm.append('<input type = "hidden" name = "categoryId" value = "'+categoryId+'">')}else postTitle=$replyLinkLocation.attr("postTitle"),$frm.append('<input type = "hidden" name = "forumId" value = "'+forumId+'">').append('<input type = "hidden" name = "categoryId" value = "'+categoryId+'">');$frm.append('<input value="'+postTitle+'" name = "forumPostTitle" class="normalText zdtxtboxbro" type="text"/>').append('<input type = "hidden" name = "forumTopicId" value = "'+forumTopicId+'">').append('<input type = "hidden" name = "responseId" value = "'+responseId+'">').append('<input type = "hidden" name = "forumGroupId" value = "'+forumGroupId+'">').append('<input type = "hidden" name = "isPrivate" value = "'+isPrivate+'">').append('<input type = "hidden" name = "isThread" value = "'+isThread+'">').append('<input type = "hidden" name = "'+csrfParamName+'" value = "'+csrfToken+'">').append('<input type = "hidden" name = "portalzaid" value = "'+discussionsZaid+'">').append('<input type = "hidden" name = "detectSpamPresence" value = "1">').append('<input type = "hidden" name = "isFollowTopic" value = "false">').append('<input type = "hidden" name = "sortThreads" value = "'+(threadSorting||!1)+'">'),editorMode&&"Edit"==editorMode&&responseAuthorId==ZUID&&$frm.append('<input type = "hidden" name = "responseowner" value = "true">')}else $frm=$('<div id = "editorHolder"></div>');if($frm.append($ta),"TweetPost"!=editorMode?$frm.insertAfter($toMask.hide()).show():$finalCont.insertAfter($toMask.hide()).show(),createEditor(),editorMode){$replyLinkLocation=$("#"+replyLinkLocation);forumTopicId=$replyLinkLocation.attr("forumTopicId"),responseId=$replyLinkLocation.attr("responseId");var publishButtoTxt="Write"==editorMode||"TweetPost"==editorMode?i18n["zohodiscussions.general.publish"]:i18n["zohodiscussions.general.update"],$publishButton=$('<button id="publishResponse" class="ashBtn normalText boldText">'+publishButtoTxt+"</button>"),$previewButton=$('<button id="previewResponse" class="ashBtn normalText boldText">'+i18n["zohodiscussions.writePost.preview"]+"</button>"),$cancelButton=$("<button id='cancelResponse' class='ashBtn normalText boldText'>"+i18n["zohodiscussions.general.cancel"]+"</button>"),attachementISThere="false";if($publishButton.click(function(){addForumResponse(forumTopicId,editorMode,responseId,tweetStatusId)}),$cancelButton.click(function(){$("#editorHolder").remove(),$("#responseAttachmentContActual").remove(),$("#SinglePostContainer_"+forumTopicId).find('div[purpose="editorActionUtilCont"]').remove(),$("#postTextContent_"+responseId).find('div[purpose="editorActionUtilCont"]').remove(),$("#eachTopicReplyCont_"+forumTopicId).find('div[purpose="editorActionUtilCont"]').remove(),0<$("#responsePreviewButtonInTopicList").length&&$("#responsePreviewButtonInTopicList").remove(),$toMask.show(),"TweetPost"==editorMode&&$("#replyTweetContainer_"+tweetStatusId).remove(),$("#topicList").is(":visible")&&$("#topicList").data("inEditMode",!1),$("#"+utilContLocation).data("inEditMode",!1);var replyContainer="";if($("#newThreadResponseCont_"+responseId).is(":visible")?replyContainer="#newThreadResponseCont_"+responseId:$("#newResponseCont_"+forumTopicId).is(":visible")?replyContainer="#newResponseCont_"+forumTopicId:$("#eachTopicReplyCont_"+forumTopicId).is(":visible")&&(replyContainer="#eachTopicReplyCont_"+forumTopicId),""!=replyContainer&&$(""+replyContainer).hide(),"privateMsgInboxContainer"==utilContLocation)$("#privateMsgCont_"+forumTopicId).hide();else if("privateMsgSentContainer"==utilContLocation)$("#privateMsgCont_"+forumTopicId).hide(),0<$("#topicContent_"+forumTopicId).parent().find("div.bigMinusIcon").length&&$("#topicContent_"+forumTopicId).show();else if("editorContainer_PM"==utilContLocation)processHash("user/"+$("#UserPM").attr("authorName"));else if(utilContLocation=="eachTopic_"+responseId){$("#paginationContainer").data("inEditMode",!1),$("#singlePostActions_"+responseId).show(),$("#linkedTopic_"+responseId).show(),$("#recent_ResPonse_"+responseId).find("div.navigationCont").show()}else utilContLocation=="topicContainer_"+forumTopicId&&($("#postTypeActions_"+responseId).show(),$("#linkTopicCont_"+forumTopicId).show(),$("#zdstatusContainer").show());($attachmentContainer.is(".Attachments")&&$attachmentContainer.show(),$("#responsePreviewContainer").is(":visible")&&(0<$("#responsePreviewContainer").length||0<$singleThreadPreviewCont.length)&&($("#responsePreviewContainer").remove(),$("#fullThreadResponseContainer").remove()),1==$("#responseContentContainer_"+responseId).is(":visible"))&&($("#fullResponseContainer_"+responseId).find("div.postTypeActions").show(),CancelPreview($("#responsePreviewButton"),$("#fullResponseContainer_"+responseId),$("#responseContentContainer_"+responseId)));1==$("#recentResponseContent_"+responseId).is(":visible")&&($("#postTextContent_"+responseId).find("ul.singlePostActions").show(),$("#resposeVoteLink_"+responseId).show(),$("#chooseBestResponse_"+responseId).show(),CancelPreview($("#responsePreviewButtonInTopicList"),$("#postTextContent_"+responseId),$("#recentResponseContent_"+responseId)))}),"TweetPost"==editorMode){var currForumOptions=$forumoptions.find("#forum_Twitter_SelectForum");$forumoptions.find("#forum_Twitter_SelectSubForum").attr("id","forum_Twitter_SelectSubForum_"+tweetStatusId),"true"!=isForumIdThere&&loadTweetCategories(currForumOptions.val(),"twitter_SubForumList","forum_Twitter_SelectSubForum_"+tweetStatusId),currForumOptions.change(function(){loadTweetCategories($(this).val(),"twitter_SubForumList","forum_Twitter_SelectSubForum_"+tweetStatusId)})}var $responseAttachmentContActual=$("#responseAttachmentContTemplate").clone();$responseAttachmentContActual.attr("id","responseAttachmentContActual");var $whiteAttachmentBox=$responseAttachmentContActual.find("div.whiteAttachmentBox").show();$responseAttachmentContActual.find('div[attachmentPurpose="browseBox"]').attr("id","attachBrowseCont");var $attachmentsList=$whiteAttachmentBox.find('ul[purpose="responseAtatchmentsListCont"]').attr("id","attachmentsListCont");if("Edit"==editorMode){if($attachmentContainer.is(".Attachments")){attachementISThere="true";var $attachmentUtilCont=$attachmentContainer.find('div[purpose="attachmenUtilCont"]'),attachmentIds=$attachmentUtilCont.attr("attachmentIds"),attachmentNames=$attachmentUtilCont.attr("attachmentNames"),attachmentSizes=$attachmentUtilCont.attr("attachmentSizes"),attachIdsColl=attachmentIds.split(","),attachNamesColl=attachmentNames.split(","),attachSizesColl=attachmentSizes.split(",");for(index=0;index<attachIdsColl.length;index++){var authorId=$("#fullResponseContainer_"+responseId).attr("authorId");null==authorId&&(authorId=$("#eachTopic_"+forumTopicId).attr("responseAuthorId"));var thisAttachmentId=attachIdsColl[index],thisAttachmentName=attachNamesColl[index],thisAttachmentSize=attachSizesColl[index],attachmentDetails=thisAttachmentId+","+thisAttachmentName+","+thisAttachmentSize;$currentAttachment=$("#responseEachAttachmentTemplate").clone(),$currentAttachment.attr("id","newAttachment_"+thisAttachmentId).attr("attachmentDetails",attachmentDetails).show(),$currentAttachment.find('[attachmentPurpose="attachmentName"]').text(thisAttachmentName),$currentAttachment.find('[attachmentPurpose="attachmentSize"]').text(thisAttachmentSize),$currentAttachment.find("div.imgAshDelete").attr("thisAttachmentId",thisAttachmentId).attr("thisAttachmentName",thisAttachmentName).attr("authorId",authorId),$currentAttachment.find("div.imgAshDelete").click(function(event){if(confirm(i18n["zohodiscussions.generalmessage.deleteAttachmentConfirmMsg"])){showSmallLoadingImage(event),$this=$(this);var deletingAttachmentId=$this.attr("thisAttachmentId"),options={};options.forumGroupId=forumGroupId,options.forumTopicId=forumTopicId,options.fileName=$this.attr("thisAttachmentName"),options.fileId=deletingAttachmentId,options[csrfParamName]=csrfToken,$this.attr("authorId")==ZUID&&(options.access="author",options.responseId=responseId),doAjaxAction("/deleteAttachment.do",options,function(data){hideLoadingImage(),"SUCCESS"==data&&($("#newAttachment_"+deletingAttachmentId).remove(),$("#eachAttachmentForPreview_"+deletingAttachmentId).remove(),$("#fullResponseContainer_"+responseId).find('li[attachmentId="'+deletingAttachmentId+'" ]').remove(),showTipper(i18n["zohodiscussions.general.Deleted"],"info"),loadUploadAttachmentsCont())})}}),$attachmentsList.append($currentAttachment)}$attachmentContainer.hide()}$("#postTypeActions_"+responseId).hide()}if((0<maxAttachmentsPerPost||"true"==attachementISThere)&&"true"!=IsPrivateResponse){var $editorActionUtilCont=$('<div class="flRight btnContainer" purpose="editorActionUtilCont" style="margin-right:10px;"></div>');$responseAttachmentContActual.insertAfter($("#editorHolder")).css("margin-top",4).show()}else{$editorActionUtilCont=$('<div class="flRight btnContainer" purpose="editorActionUtilCont" style="margin-top:25px;margin-right:10px;"></div>');$responseAttachmentContActual.insertAfter($("#editorHolder")).css("margin-top",4)}$editorActionUtilCont.append($publishButton),"paginationContainer"!=utilContLocation&&"TweetPost"!=editorMode&&$editorActionUtilCont.append($previewButton),$responseAttachmentContActual.find("div.whiteAttachmentBox").css("border-width",1),$editorActionUtilCont.append($cancelButton).insertAfter($responseAttachmentContActual),loadUploadAttachmentsCont(),$previewButton.click(function(){var $this=$(this),location=$this.attr("location"),finalTopicTitle=$("#editorHolder").find("input[name=forumPostTitle]").val().replace(/^<+|<+$/g,"&lt;").replace(/<+/g,"&lt;").replace(/^>+|>+$/g,"&gt;").replace(/>+/g,"&gt;"),forumTopicId=$this.attr("forumTopicId"),responseId=$this.attr("responseId"),contentToPost=editor.getContent();if(contentToPost=contentToPost.replace(/^\s+/g,"").replace(/\s+$/g,""),"plaintext"===editor.mode&&(contentToPost=(contentToPost=encodeHTML(contentToPost)).replace(/\n/g,"<br/>")),"editResponse"==location||"editTopic"==location){responseId=$this.attr("responseId");var $previewMsg=$('<div class=" approveButton flRight"> This is preview! </div>');if("editTopic"==location){var $topicTitle=$("#DocumentTitle");$topicTitle.css("width","74%"),$previewMsg.insertAfter($topicTitle.parent())}else $("#fullResponseContainer_"+responseId).find("div.sppostHeader").append($previewMsg);if(0==$("#responsePreviewButton").length?($responsePreviewButton=$("#previewButtonTemplate").clone(),$responsePreviewButton.attr("id","responsePreviewButton")):$responsePreviewButton=$("#responsePreviewButton"),"editTopic"==location&&($("#fullResponseContainer_"+responseId).find("div.postTypeActions").hide(),$responsePreviewButton.insertAfter($("#fullResponseContainer_"+responseId).find("div.postTypeActions")).show()),newEditorLocationHide(forumTopicId,$editorLocation=$("#fullResponseContainer_"+responseId)),$editorLocation.find("div.replyOutHeader").append('<div class="flRight statusMessage"><span class="boldText moderation">This is preview!</span></div>'),$editorLocation.find("h3.header").html(finalTopicTitle),"editTopic"==location){$("#DocumentTitle").hide();var $postTitlePreviewContainer=$("#DocumentTitle").clone();$postTitlePreviewContainer.attr("id","postTitlePreviewContainer"),$postTitlePreviewContainer.insertAfter($("#DocumentTitle")),$postTitlePreviewContainer.html(finalTopicTitle).show()}else{var $responseTitleContainer=$("#fullResponseContainer_"+responseId).find("div.sppostHeader h4");$responseTitleContainer.hide();var $responseTitlePreviewContainer=$responseTitleContainer.clone();$responseTitlePreviewContainer.attr("id","responseTitlePreviewContainer"),$responseTitlePreviewContainer.insertAfter($responseTitleContainer),$responseTitlePreviewContainer.html(finalTopicTitle).show()}editAndPreviewPost($responsePreviewButton,$("#postTypeActions_"+responseId),$editorLocation,location),$attachmentContInResponse=$("#fullResponseContainer_"+responseId).find("div.attachmentListCont").hide();var $attachmentPreview=$("#fullResponseContainer_"+responseId).find('div[purpose ="attachmentListContForPreview"]');attachmentPreview($contentContainer=$("#responseContentContainer_"+responseId),$attachmentContInResponse,$editorLocation,$this),1==$("#cancelResponse").attr("disabled")&&$("#responsePreviewButton").find('button[purpose="cancelPreviewResponse"]').attr("disabled",!0),$attachmentPreview.show(),previewContentContainer($("#responseContentContainer_"+responseId),contentToPost.trim()),previewActions($("#fullResponseContainer_"+responseId),forumTopicId,responseId,$cancelButton,$publishButton,attachementISThere)}else if("topicListEditResponse"==location){var $editorLocation;0==$("#responsePreviewButtonInTopicList").length?($responsePreviewButton=$("#previewButtonTemplate").clone(),$responsePreviewButton.attr("id","responsePreviewButtonInTopicList")):$responsePreviewButton=$("#responsePreviewButtonInTopicList"),newEditorLocationHide(forumTopicId,$editorLocation=$("#postTextContent_"+responseId));var $contentContainer=$("#recentResponseContent_"+responseId),$attachmentContInResponse=$("#postTextContent_"+responseId).find("div.attachmentListCont").hide();($attachmentPreview=$("#postTextContent_"+responseId).find('div[purpose ="attachmentListContForPreview"]')).show(),1==$("#cancelResponse").attr("disabled")&&$("#responsePreviewButtonInTopicList").find('button[purpose="cancelPreviewResponse"]').attr("disabled",!0),attachmentPreview($contentContainer,$attachmentContInResponse,$editorLocation,$this),previewContentContainer($("#recentResponseContent_"+responseId),contentToPost),editAndPreviewPost($responsePreviewButton,$("#postTextContent_"+responseId),$editorLocation,location),previewActions($("#responsePreviewButtonInTopicList"),forumTopicId,responseId,$cancelButton,$publishButton,attachementISThere)}else{if(0==$("#responsePreviewContainer").length?($responsePreviewContainer=$("#responsePreviewContainerTemplate").clone(),$responsePreviewContainer.attr("id","responsePreviewContainer")):$responsePreviewContainer=$("#responsePreviewContainer"),replyLinkLocation=="newThreadReply_"+responseId)if(0==$("#fullThreadResponseContainer").length)var $singleThreadPreviewCont=$("");else $singleThreadPreviewCont=$("#topicContainer_"+forumTopicId).find('div[purpose="threadResponseContainer"]');$responsePreviewContainer.find('[purpose="previewResponseAttachment"]').attr("id","attachmentForResponsePreview"),replyLinkLocation=="newThreadReply_"+responseId?($responsePreviewContainer.insertAfter("#newThreadResponseCont_"+responseId).show(),$responsePreviewContainer.addClass("thread"),$responsePreviewContainer.find('button[purpose="backToEditorResponse"]').attr("location","threadResponse"),$("#replyToTopicBtn_"+forumTopicId).attr("location","threadResponse")):($responsePreviewContainer.insertAfter("#newResponseCont_"+forumTopicId),$responsePreviewContainer.find('button[purpose="backToEditorResponse"]').attr("location","topicResponse"),$("#replyToTopicBtn_"+forumTopicId).attr("location","topicResponse")),$responsePreviewContainer.find('[purpose="topicTitleOfResponse"]').html(finalTopicTitle),$responsePreviewContainer.find('div[purpose="responseContPreviewContainer"]').html(contentToPost),replyLinkLocation=="newThreadReply_"+responseId?($("#newThreadResponseCont_"+responseId).hide(),$singleThreadPreviewCont.show(),$singleThreadPreviewCont.find("div.singleReplyContainer").show()):($responsePreviewContainer.show(),$("#newResponseCont_"+forumTopicId).hide());var attachmentDetails=$this.find('input[name="attachmentId"]');$.each(attachmentDetails,function(index,item){var eachAttachmentDetails=$(item).attr("attachmentDetails").split(","),$eachResponseAttachment=$('<li id="eachAttachmentForPreview_'+eachAttachmentDetails[0]+'" ><div class="flLeft"><b class="flLeft imgfile"></b><a>'+encodeHTML(eachAttachmentDetails[1])+'</a><div class="spattachmentConent"><span>Size : '+eachAttachmentDetails[2]+" </span>&nbsp;&nbsp;</div></div></li>");$("#attachmentForResponsePreview").append($eachResponseAttachment)}),0<$("#attachmentForResponsePreview > li").length?$responsePreviewContainer.find('[purpose="attachmentResponsePreviewCont"]').show():$responsePreviewContainer.find('[purpose="attachmentResponsePreviewCont"]').hide(),previewActions($responsePreviewContainer,forumTopicId,responseId,$cancelButton,$publishButton,attachementISThere)}})}$("#editorHolder iframe").attr("id","editorframecont")}function toggleSections($context,sectionToShow){$context.find("div[purpose]").hide().end().find('div[purpose="'+sectionToShow+'"]').show().end().find("li[purpose]").removeClass("selectedMenu").end().find('li[purpose="'+sectionToShow+'"]').addClass("selectedMenu")}function uploadError(errmsg){$("#imageDialog").find("#image_error").hide().html(errmsg).css("background","#FFF1A8").fadeIn()}function previewActions($responsePreviewContainer,forumTopicId,responseId,$cancelButton,$publishButton,attachementISThere){$responsePreviewContainer.find('button[purpose="backToEditorResponse"]').unbind("click").click(function(){var location=$(this).attr("location");"topicResponse"==location?($responsePreviewContainer.hide(),$("#newResponseCont_"+forumTopicId).show()):"editEachResponse"==location?($("#resposeVoteLink_"+responseId).show(),$("#chooseBestResponse_"+responseId).show(),backtoEditorWhilePreviewing($("#fullResponseContainer_"+responseId),$("#responseContentContainer_"+responseId),$("#responsePreviewButton"),forumTopicId,attachementISThere)):"topicListEditResponse"==location?backtoEditorWhilePreviewing($("#postTextContent_"+responseId),$("#recentResponseContent_"+responseId),$("#responsePreviewButtonInTopicList"),forumTopicId,attachementISThere):($("#newThreadResponseCont_"+responseId).show(),$("#fullThreadResponseContainer").hide(),$responsePreviewContainer.remove()),$("#attachmentForResponsePreview").html(" ")}),$responsePreviewContainer.find('button[purpose="publishPreviewResponse"]').unbind("click").click(function(){$publishButton.trigger("click")}),$responsePreviewContainer.find('button[purpose="cancelPreviewResponse"]').unbind("click").click(function(){var location=$(this).attr("location");if("topicResponse"==location);else if("editEachResponse"==location){$("#fullResponseContainer_"+responseId).find('div[purpose ="attachmentListContForPreview"] > ul').html(" "),$("#fullResponseContainer_"+responseId).find("div.replyOutHeader > div.statusMessage").remove()}else if("topicListEditResponse"==location){$("#postTextContent_"+responseId).find('div[purpose ="attachmentListContForPreview"] > ul').html(" "),$("#postTextContent_"+responseId).find("div.statusMessage").remove()}$("#fullResponseContainer_"+responseId).find("div.approveButton").remove(),$cancelButton.trigger("click")})}function editAndPreviewPost($responsePreviewButton,$insertAfterThisContainer,$editorLocation,location){location="editResponse"==location||"editTopic"==location?"editEachResponse":"topicListEditResponse";$responsePreviewButton.insertAfter($insertAfterThisContainer).show(),$editorLocation.find('div[purpose="editorMainParentCont"]').hide(),$editorLocation.find('div[purpose="editorActionUtilCont"]').hide(),$responsePreviewButton.find('button[purpose="publishPreviewResponse"]').html(i18n["zohodiscussions.general.update"]),$responsePreviewButton.find('button[purpose="backToEditorResponse"]').attr("location",location),$responsePreviewButton.find('button[purpose="publishPreviewResponse"]').attr("location",location),$responsePreviewButton.find('button[purpose="cancelPreviewResponse"]').attr("location",location)}function CancelPreview($previewButtonContainer,$editorLocation,$responseContentContainer){$previewButtonContainer.remove(),$editorLocation.find("div.Attachments").show(),$editorLocation.find("div.attachmentListCont").show(),$editorLocation.find('div[purpose ="attachmentListContForPreview"]').hide(),$responseContentContainer.show(),$("#previewContentContainer").remove(),$("#newAttachmentForPreview").remove(),$("#DocumentTitle").show(),$("#postTitlePreviewContainer").remove(),$editorLocation.find("div.sppostHeader h4").show(),$("#responseTitlePreviewContainer").remove()}function previewContentContainer($responseContentContainer,previewContent){if($responseContentContainer.hide(),0==$("#previewContentContainer").length)var $previewContentContainer=$('<div id="previewContentContainer" class="postContent"> </div>');else $previewContentContainer=$("#previewContentContainer");$previewContentContainer.insertAfter($responseContentContainer),$previewContentContainer.html(previewContent).show()}function backtoEditorWhilePreviewing($editorLocation,$contentContainer,$previewButtonContainer,forumTopicId,attachementISThere){newEditorLocationShow(forumTopicId,$editorLocation,attachementISThere),$contentContainer.hide(),$editorLocation.find("div.Attachments").hide(),$("#previewContentContainer").hide(),$editorLocation.find('div[purpose ="attachmentListContForPreview"] > ul').html(" "),$("#newAttachmentForPreview").find('ul[purpose="previewResponseAttachment"]').html(" "),$editorLocation.find("div.replyOutHeader > div.statusMessage").remove(),$previewButtonContainer.hide(),$("#responsePreviewContainer").remove(),$("#SinglePostContainer_"+forumTopicId).find("div.approveButton").remove(),$("#DocumentTitle").show(),$("#postTitlePreviewContainer").remove(),$editorLocation.find("div.sppostHeader h4").show(),$("#responseTitlePreviewContainer").remove()}function attachmentListPreview($appendingAttachmentCont,attachmentListCont){$.each(attachmentListCont,function(index,item){var eachAttachmentDetails=$(item).attr("attachmentDetails").split(","),$eachResponseAttachment=$('<li id="eachAttachmentForPreview_'+eachAttachmentDetails[0]+'" ><div class="flLeft"><b class="flLeft imgfile"></b><a>'+encodeHTML(eachAttachmentDetails[1])+'</a><div class="spattachmentConent"><span>Size : '+eachAttachmentDetails[2]+" </span>&nbsp;&nbsp;</div></div></li>");$appendingAttachmentCont.append($eachResponseAttachment).show()})}function attachmentPreview($contentContainer,$attachmentContInResponse,$editorLocation,$this){0==$editorLocation.find('div[purpose ="attachmentListContForPreview"]').length&&0==$("#newAttachmentForPreview").length&&$('<div class="Attachments attachments"><div class="attachmentListCont spattachmentList" purpose ="attachmentListContForPreview"><h3><span class="imgAttach flLeft"></span> Attachments </h3> <ul class="ulNoStyle"> </ul></div>').insertAfter($attachmentContInResponse);if(0==$("#newAttachmentForPreview").length&&0<$("#attachmentsListCont").find('li[purpose="attachmentDetails"]').length&&0==$attachmentContInResponse.length&&($newAttachmentForPreview=$("#responsePreviewContainerTemplate").find('div[purpose ="attachmentResponsePreviewCont"]').clone(),$newAttachmentForPreview.attr("id","newAttachmentForPreview"),$newAttachmentForPreview.insertAfter($contentContainer),$newAttachmentForPreview.find("div.attachmentListCont").show()),0<$("#newAttachmentForPreview").length){$("#newAttachmentForPreview").show();var attachmentDetails=$this.find('input[name="attachmentId"]');attachmentListPreview($("#newAttachmentForPreview").find('ul[purpose="previewResponseAttachment"]'),attachmentDetails),$newAttachmentForPreview.find("div.attachmentListCont").show()}else{attachmentDetails=$("#attachmentsListCont").find('li[purpose="attachmentDetails"]');attachmentListPreview($editorLocation.find('div[purpose ="attachmentListContForPreview"] > ul'),attachmentDetails)}0<$editorLocation.find('div[purpose ="attachmentListContForPreview"] > ul > li').length||0<$("#newAttachmentForPreview").find('ul[purpose ="previewResponseAttachment"] > li').length?$editorLocation.find("div.Attachments").show():$editorLocation.find("div.Attachments").hide()}function imageUploaded(imageURL,attachmentId,context,actualImageURL){$("#imagePreview").attr({src:imageURL,width:"100",height:"100"});var $myImageDialog=$("#imageDialog");$myImageDialog.find("#image_error").html(""),$myImageDialog.find(':input[name="linkTo"]').val(actualImageURL),$myImageDialog.find(':button[action="insertImage"]').attr("disabled","").end().find(':input[name="uploadedImageUrl"]').val(imageURL)}function imageAdded(imageURL,textAreaID){var $imgDialog=$("#imageDialog"),props={};props.title=$imgDialog.find('[name="title"]').val(),props.altText=$imgDialog.find('[name="altText"]').val(),props.linkTo=$imgDialog.find('[name="linkTo"]').val(),props.imgSize=$imgDialog.find('[name="imgSize"]').filter(":checked").val(),$("#"+textAreaID).data("editor").addImage(imageURL,props),$("#imageDialog").hide()}function toggleSections($context,sectionToShow){$context.find("div[purpose]").hide().end().find('div[purpose="'+sectionToShow+'"]').show().end().find("span[purpose]").removeClass("select").addClass("default").end().find('span[purpose="'+sectionToShow+'"]').removeClass("default").addClass("select")}function fillImageUrl(){var $myImageDialog=$("#imageDialog");if($myImageDialog.find("#urldiv").is(":visible")){(urlToAdd=$myImageDialog.find(':input[name="url"]').val())&&""!=$.trim(urlToAdd)&&(""!=$.trim(urlToAdd)&&isValidUrl(urlToAdd)?$myImageDialog.find(':input[name="linkTo"]').val(urlToAdd).end().find("#imagePreview").attr({src:urlToAdd,width:"100",height:"100"}).end().find(':button[action="insertImage"]').attr("disabled",""):(alert(i18n["zohodiscussions.settings.PleaseEnteraValidurl"]),$myImageDialog.find(':input[name="url"]').focus()))}else{var urlToAdd=$myImageDialog.find(':input[name="uploadedImageUrl"]').val();$myImageDialog.find(':input[name="linkTo"]').val(urlToAdd)}}function isValidUrl(url){return!(!url||""==$.trim(url))&&(url_pattern="^https?://[A-Za-z0-9-_]+(?:\\.[A-Za-z0-9-_%&?/.=]+)*$",null!=url.match(url_pattern))}function uploadImage(){var $myImageDialog=$("#imageDialog");if(""!=$.trim($myImageDialog.find("[name='imageFileName']").val())){var $formToSubmit=$myImageDialog.find("form");$myImageDialog.find("#image_error").html("<em>Uploading .. <img src = '/images/progressbarsmall.gif' /></em>").end().find(':button[action="insertImage"]').attr("disabled","true"),$formToSubmit.find(':hidden[name="responseId"]').val($('#editorHolder :hidden[name="responseId"]').val()),$formToSubmit.attr("action","/uploadImage.do"),$formToSubmit.attr("enctype","multipart/form-data").attr("encoding","multipart/form-data"),$formToSubmit.get(0).submit()}}function toggleImageSelection(curr){if("uploadSection"==$(curr).attr("id"))$(curr).addClass("select"),$("#urlSection").removeClass("select"),$("#uploaddiv").show(),$("#urldiv").hide();else{$(curr).addClass("select"),$("#uploadSection").removeClass("select"),$("#uploaddiv").hide();var $urlDiv=$("#urldiv");$urlDiv.show(),$urlDiv.find(':inpur[name="url"]').focus()}}function newEditorLocationHide(forumTopicId,$location){$("#editorHolder").hide(),$location.find('div[purpose="editorActionUtilCont"]').hide(),$("#responseAttachmentContActual").hide()}function newEditorLocationShow(forumTopicId,$location,attachementISThere){$("#editorHolder").show(),(0<maxAttachmentsPerPost||"true"==attachementISThere)&&$("#responseAttachmentContActual").show(),$location.find('div[purpose="editorActionUtilCont"]').show()}function initTabContClick(){$("#homeTab,#allforumsTab,#myareaTab,#SettingsTab,#NewTopicTab,#Search,#twitterMainTab,#Users").click(function(){var $this=$(this);return processHash($this.attr("hashPurpose"),"",$this),!1}),$("#searchComboDownArrow").parent().click(function(){displaySearchOption()}),$("#searchTab input").focus(function(){$("#searchTab").addClass("searchBoxFocus")}).focusout(function(){$("#searchTab").removeClass("searchBoxFocus")})}function updateAwaitingApprovalCount(){if(!isEmbedService()){var awaitingApproval={};awaitingApproval.forumGroupId=forumGroupId,doAjaxAction("/getAwaitingApprovalCount.do",awaitingApproval,function(data){var countHTML="0"!=data?" ("+data+")":"";$("#awaitingCountCont").html(countHTML).attr("totalCount",data)})}}function processHash(hash,isWithHash,$target){if(isEmbedService())return!1;if("false"==isTopicQuickView&&"withHash"!=isWithHash){if("home"==hash.toLowerCase())hash="recent";else{if("search"===hash.toLowerCase()||"normalsearch"===hash.toLowerCase()){var searchingPurpose=$("#searchSelectedImage").attr("purpose"),hashPurposeForSearch="",searchFor=$("#searchInputBox").val(),$forumComboCont=$("#forumComboCont"),$categoryComboCont=$("#categoryComboCont"),forForumNiceUrl=$forumComboCont.attr("forNiceUrl"),forCategoryNiceUrl=$categoryComboCont.attr("forNiceUrl");if(void 0!==(hashPurposeForSearch=void 0!==forCategoryNiceUrl&&""!=forCategoryNiceUrl?forCategoryNiceUrl:forForumNiceUrl)&&""!=hashPurposeForSearch||(hashPurposeForSearch=""),"normalsearch"==hash.toLowerCase()&&(searchFor=$("#normalSearchInputBox").val()),searchFor=$.trim(searchFor),""==(searchFor=(searchFor=encodeURIComponent(searchFor)).replace(/\*/g,"%2A").replace(/\~/g,"%7E").replace(/\!/g,"%21").replace(/\'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29")))return void showMessage(i18n["zohodiscussions.searchList.noSearchString"],"failure");var searchType="";return void 0===searchingPurpose?searchType="":"all"!=searchingPurpose&&(searchType=searchingPurpose+"/"),location.href=serverURL+hashPurposeForSearch+"/search/"+searchType+searchFor,!1}if(void 0!==$target&&"NewTopicTab"==$target.attr("id")){if(""==hash)return!1;var hashKey=(givenKey=(hashList=hash.split("/"))[0]).toLowerCase(),forumId=hashList[1],categoryId=hashList[2];return discussionsFunctions.newtopic(hashKey,forumId,categoryId),!1}}return location.href=serverURL+"/"+hash.toLowerCase(),!1}if(1==shouldReload&&"Search"!=hash&&"resourceSearch"!==hash)return window.location.href=serverURL+"#"+hash,!1;if(showLoadingImage(),""==hash)return"false"==isTopicQuickView?window.location.href=serverURL+"/recent":discussionsFunctions.home("home",1),!1;var hashList,givenKey;switch(selectTab(hashKey=(givenKey=(hashList=hash.split("/"))[0]).toLowerCase()),hashKey){case"home":case"chome":var fetchPage=1;1<parseInt(hashList[1])&&(fetchPage=hashList[1]),discussionsFunctions[hashKey](givenKey,fetchPage);break;case"alltags":case"allforums":discussionsFunctions[hashKey](givenKey);break;case"stats":window.location.href=serverURL+"/stats";break;case"search":searchFor=hashList[1],discussionsFunctions[hashKey](givenKey,searchFor,!1);break;case"resourcesearch":void 0!==$target&&"normalSearchInputBox"===$target.attr("id")&&(searchFor=$target.val()),discussionsFunctions.search(givenKey,searchFor,!0);break;case"normalsearch":(searchFor=$("#normalSearchInputBox").val())||(searchFor=hashList[1]),discussionsFunctions.search(givenKey,searchFor,!1);break;case"myarea":var myAreaKey=hashList[1],subAction="";myAreaKey&&(myAreaKey=myAreaKey.toLowerCase()),"watchlist"==myAreaKey?(subAction=hashList[2])&&(subAction=subAction.toLowerCase()):"friends"==myAreaKey&&(subAction=hashList[2])&&(subAction=subAction.toLowerCase()),discussionsFunctions[hashKey](givenKey,myAreaKey,subAction);break;case"moderation":window.location.href=serverURL+"/moderation";break;case"settings":discussionsFunctions[hashKey](givenKey);break;case"topic":var forumTopicId=hashList[1],recentResponseId=hashList[2];discussionsFunctions[hashKey](givenKey,forumTopicId,recentResponseId);break;case"forum":var forumURL=hashList[1];fetchPage=1;if(hashList[2]){var categoryURL="",count=parseInt(2);if("filter"!=hashList[count]&&"all"!=hashList[count].toLowerCase()){var temp=parseInt(hashList[count]);0<temp?fetchPage=temp:categoryURL=hashList[count],count+=1}if(hashList[count])if("filter"==hashList[count]){var filterStatus="";if("twitter"==(filterType=(filterType=hashList[count+=1]).toLowerCase()))return void getTwitterSearchList(forumId=$("#searchTwitterTab").attr("forumId"),1,forumURL);"discussions"!=filterType&&"questions"!=filterType&&"ideas"!=filterType&&"problems"!=filterType&&"announcement"!=filterType&&"sticky"!=filterType&&"unrepliedposts"!=filterType&&"postssincelastvisit"!=filterType?(filterType="all","true"!=isOneTopicType&&(count+=1)):hashList[count+=1]&&(filterStatus=hashList[count]),"true"==isOneTopicType&&"all"==filterType&&(filterStatus=hashList[count]),hashList[count]&&0<parseInt(hashList[count])&&(fetchPage=hashList[count]),getMoreTopics(forumURL,categoryURL,fetchPage,filterType,"",filterStatus,"reload")}else hashList[count]&&0<parseInt(hashList[count])&&(fetchPage=hashList[count]),discussionsFunctions[hashKey](givenKey,forumURL,categoryURL,fetchPage);else discussionsFunctions[hashKey](givenKey,forumURL,categoryURL,fetchPage)}else discussionsFunctions[hashKey](givenKey,forumURL,"",fetchPage);break;case"filter":var filterType;filterStatus="",fetchPage=1;if("twitter"==(filterType=(filterType=hashList[1]).toLowerCase()))return void getTwitterSearchList(-1,1);"discussions"!=filterType&&"questions"!=filterType&&"ideas"!=filterType&&"problems"!=filterType&&"announcement"!=filterType&&"sticky"!=filterType&&"unrepliedposts"!=filterType&&"postssincelastvisit"!=filterType?(filterType="all",0<parseInt(hashList[2])&&(fetchPage=hashList[2])):hashList[3]?(filterStatus=hashList[2],0<parseInt(hashList[3])&&(fetchPage=hashList[3])):0<parseInt(hashList[2])?fetchPage=hashList[2]:filterStatus=hashList[2],"true"==isOneTopicType&&"all"==filterType&&(filterStatus=hashList[1]),getMoreTopics("","",fetchPage,filterType,"",filterStatus,"reload");break;case"user":var authorName=hashList[1];discussionsFunctions[hashKey](givenKey,authorName);break;case"tag":var tagName=hashList[1];discussionsFunctions[hashKey](givenKey,tagName);break;case"newtopic":forumId=hashList[1],categoryId=hashList[2];discussionsFunctions[hashKey](givenKey,forumId,categoryId);break;case"newdiscussion":forumId=hashList[1],categoryId=hashList[2];discussionsFunctions.newtopic(givenKey,forumId,categoryId);break;case"tpw":forumId=hashList[1],categoryId=hashList[2];var limit=hashList[3],style=hashList[4],ph=hashList[5],tps=hashList[6],widget=hashList[7],aj=hashList[8],stat=hashList[9],qstr=hashList[10],tgt=hashList[11];discussionsFunctions.tphome(givenKey,forumId,categoryId,limit,style,ph,tps,widget,aj,stat,qstr,tgt);break;case"users":fetchPage=1;var nameStartsWith=hashList[2];1<parseInt(hashList[1])&&(fetchPage=hashList[1]),discussionsFunctions[hashKey](givenKey,fetchPage,nameStartsWith);break;case"gettingstarted":if("manageengine"===currentForumGroupURL){var serviceurl=hashList[1];gettingstarted(1,!0,!1,forumGroupId,serviceurl)}else location.hash="home";break;default:hideLoadingImage()}return!1}var discussionsFunctions={};function loadTagRelatedPost(tagName){var options={};options.forumGroupId=forumGroupId,options.tagName=tagName,options.fetchPage=1,doAjaxAction("/getTagRelatedPosts.do",options,function(data){return hideLoadingImage(),$("#mainContent").html(data),goToTop(),bindTopicClicks($("#topicList")),bindTopicClicks($("#topicsList")),bindTopicListHeaderClicks($("#topicListHeader")),bindWidgetsContClick($("#topicListWidgetsCont")),!1},function(errordata){hideLoadingImage();var responseData=errordata.responseText;$("#mainContent").html(responseData)})}function allForumsBindActions(){lightBox("#chartWidget"),bindAllForumsClick($("#allForums_MainContentCont")),bindWidgetsContClick($("#topicListWidgetsCont")),goToTop();var $listof_FC_Counts=$("#listof_FC_Counts");($("#countOfForum").html($listof_FC_Counts.attr("forumCount")),$("#countOfCategory").html($listof_FC_Counts.attr("categoryCount")),$("#countOfPosts").html($listof_FC_Counts.attr("postCount")),$("#countOfResponses").html($listof_FC_Counts.attr("responseCount")),"undefined"!=typeof WmsContacts&&"true"==ch)&&setPresenceInTopicList(WmsContacts.getZohoContacts())}function ModerationLoadingPage(options){doAjaxAction(0<portalPlanIndex?"/getModerationPanel.do":"/getReportedSpam.do",options,function(data){return hideLoadingImage(),$("#mainContent").get(0).innerHTML=data,$.history.add("Moderation"),getModerationPanelBindAction(),!1},function(errordata){hideLoadingImage();var responseData=errordata.responseText;$("#mainContent").get(0).innerHTML=responseData})}function getModerationPanelBindAction(){goToTop(),bindModerationTabClick(),0<portalPlanIndex?bindModerationActionClick("AllAwaiting"):bindModerationActionClick("AllReportedSpam"),ModerationAction($("#moderationRightCont")),initModerationPanel($("#moderationPanel"))}function getMyAreaBindActions(myAreaAction,givenKey,niceUrl,subAction){if(bindMyAreaClicks($("#myAreaContent")),$("#authorPopout_"+ZUID).hide(),showAuthorPopout($("#myAreaInnerMainContent")),"dashboard"!=myAreaAction){if("myposts"==myAreaAction&&(myAreaAction="myjournals"),null!=subAction&&"topic"!=subAction&&"user"!=subAction&&"forum"!=subAction&&"subforum"!=subAction&&"following"!=subAction&&"follower"!=subAction&&(subAction="topic"),"niceurl"!=niceUrl)0<$("#"+myAreaAction+"View").length?getMyAreaAction($("#"+myAreaAction+"View"),subAction):getMyAreaAction($("#dashboardView"));else bindMyareaTabsActions($("#"+myAreaAction+"View").attr("purpose"),subAction)}else{if("niceurl"!=niceUrl&&$.history.add(givenKey+"/"+myAreaAction),"undefined"!=typeof WmsContacts&&"true"==ch){var dataOb=WmsContacts.getZohoContacts();setPresence(dataOb,"followingUserDetails"),setPresence(dataOb,"followersUserDetails"),setPresenceInMyArea(dataOb,"current_recentActivity_List")}"dashboard"!=myAreaAction&&"undefined"!=myAreaAction||initialiseUserActivityChart()}}function ModerationAction($context){$context.unbind("click",bindModerationAction).click(bindModerationAction),showAuthorPopout($context)}function getTopicsReport(forumId,categoryId,fetchPage,givenkey){document.title=forumGroupNameDecode(forumGroupName);var options={};options.forumGroupId=forumGroupId,options.forumId=forumId,options.categoryId=categoryId,options.fetchPage=fetchPage,options[csrfParamName]=csrfToken,doAjaxAction("/Reports.do",options,function(data){hideLoadingImage(),givenkey&&$.history.add(givenkey),$("#mainContent").get(0).innerHTML=data,lightBox("#chartWidget"),bindReportsClicks($("#reportsLeftPanel"))})}function getForumTopics(forumId,categoryId,fetchPage,givenkey,limit,style,ph,tps,widget,aj,stat,qstr,tgt){document.title=forumGroupNameDecode(forumGroupName);var $topicListMainContainer=$("#topicListMainContainer");if(0<$topicListMainContainer.length&&$topicListMainContainer.is('[shouldReload="false"]')&&fetchPage<2)$.history.add(givenkey),setTimeout(function(){$topicListMainContainer.show().attr("shouldReload","true").siblings().remove()},200),hideLoadingImage(),setToHotkeys();else{var options={};options.forumGroupId=forumGroupId,options.forumId=forumId,options.categoryId=categoryId,options.fetchPage=fetchPage,"tpw"==(options.givenkey=givenkey)&&(options.limit=limit,options.style=style,options.ph=ph,options.tps=tps,options.widget=widget,options.aj=aj,options.stat=stat,options.querystring=qstr,options.tgt=tgt),doAjaxAction("/getSingleForumTopics.do",options,function(data){hideLoadingImage(),isHistoryNotAllowedService(givenkey,fetchPage),$("#mainContent").get(0).innerHTML=data;var $iframeLogin=$("#iamLoginBox").find("iframe"),currSRC=$iframeLogin.attr("src");$iframeLogin.attr("src",currSRC),lightBox("#chartWidget"),lightBox("#topicList"),bindTopicClicks($("#topicList")),bindTopicClicks($("#topicsList")),bindTopicListHeaderClicks($("#topicListHeader")),bindWidgetsContClick($("#topicListWidgetsCont"));var hashPurpose="NewTopic/"+forumId+"/"+categoryId;($("#NewTopicTab").attr("hashPurpose",hashPurpose),0<$("#allForumWidget").length&&$("#allForumWidget").find('li[purpose="forumList"]').length<9&&$("#moreForumView").hide(),"undefined"!=typeof WmsContacts&&"true"==ch)&&setPresenceInTopicList(WmsContacts.getZohoContacts());return setToHotkeys(),!1},function(errordata){hideLoadingImage();var responseData=errordata.responseText;$("#mainContent").get(0).innerHTML=responseData})}}function getWritePostCallBack(givenKey,isNewWritePost){var titleArr={};"true"!=isNewWritePost&&$.history.add(givenKey),$("#tabListCont li.selected").removeClass("selected"),goToTop();var $selectForumContainer=$("#SelectForum > option");1==$selectForumContainer.length&&$selectForumContainer.attr("selected",!0);var $selectCategoryContainer=$("#SelectCategory > option");if(1==$selectCategoryContainer.length&&$selectCategoryContainer.attr("selected",!0),initWritePost(),"newtopic"!=(givenKey=givenKey.toLowerCase())){"newproblem"==givenKey?givenKey="error":"newquestion"==givenKey?givenKey="question":"newidea"==givenKey?givenKey="idea":"newdiscussion"==givenKey&&(givenKey="discuss");var $this=$("#writepostTabsCont").find('li[topiciconclass="'+givenKey+'"]');0<$this.length?selectTopicType($this):selectTopicType($this,givenKey)}hideLoadingImage();var findLastTitle="";$("#topicTitle").keydown(function(e){var $listOfTitleAutoSugg=$("#listOfTitleAutoSugg"),currSearchName=$(this).val();if(""!=(currSearchName=currSearchName.replace(/^\s+|\s+$/g,"").replace(/\s+/g," "))&&27!=e.keyCode){if(storedTitle=titleArr[currSearchName],null!=storedTitle)return""==storedTitle?void $listOfTitleAutoSugg.hide():void $listOfTitleAutoSugg.html(storedTitle).show();if(32==e.keyCode&&(""==findLastTitle||0!=currSearchName.indexOf(findLastTitle))){findLastTitle="";var options={};options.searchFor=currSearchName,options.forumGroupId=forumGroupId,options[csrfParamName]=csrfToken,doAjaxAction("/getTopicTitleSearch.do",options,function(data){$listOfTitleAutoSugg.get(0).innerHTML=data;var $data=$("<div></div>");if($data.get(0).innerHTML=data,$data.find("li").length<1)return titleArr[currSearchName]="",findLastTitle=currSearchName,void $listOfTitleAutoSugg.hide();var currTitleWidth=$("#topicTitle").width();$listOfTitleAutoSugg.width(currTitleWidth-5),$listOfTitleAutoSugg.show(),titleArr[currSearchName]=$listOfTitleAutoSugg.html()},function(errordata){})}}else $listOfTitleAutoSugg.hide()}),$("#writepostCont").unbind("click",manageTopicTitle).click(manageTopicTitle)}function manageTopicTitle(event){var $target=$(event.target);$target.parent();if($("#listOfTitleAutoSugg").is(":visible")){if("autosugg"==$target.parents("li").attr("eachTopic")){if(!$target.is("a")){var topicUrl=$target.parents("li").find("a").attr("href");isEmbedAllowedService()&&window.open(topicUrl)}return}if(!$target.is("#moreSearchTopicList"))return void $("#listOfTitleAutoSugg").hide();$("#listOfTitleAutoSugg").find("ul li").show(),$target.hide()}}function getWritePost(forumId,categoryId,givenKey,isNewWritePost){var options={};options.forumGroupId=forumGroupId,options.forumId=forumId,options.categoryId=categoryId,"false"!=isTopicQuickView&&showLoadingImage(),doAjaxAction("/writePost.do",options,function(data){return document.title=i18n["zohodiscussions.writePost.documentTitle"]+" - "+forumGroupNameDecode(forumGroupName),2===$(".ui-autocomplete").length&&$(".ui-autocomplete").remove(),$("#mainContent").get(0).innerHTML=data,getWritePostCallBack(givenKey,isNewWritePost),!1},function(errordata){hideLoadingImage();var responseData=errordata.responseText;$("#mainContent").get(0).innerHTML=responseData})}function selectTab(tabId){if("user"!=tabId)if("newtopic"!=tabId&&"search"!=tabId)"forum"!=tabId&&"topic"!=tabId&&"chome"!=tabId||(tabId="home"),$("#"+tabId+"Tab").addClass("selected").siblings("li.selected").removeClass("selected");else{if(searchFor=$("#searchInputBox").val(),searchFor=$.trim(searchFor),"search"==tabId&&""==searchFor)return;$("#"+tabId+"Tab").siblings("li.selected").removeClass("selected")}else $("#newtopicCont").siblings("li.selected").removeClass("selected")}function bindTopicListHeaderClicks($context){$context.unbind("click",processTopicListHeaderClick).click(processTopicListHeaderClick)}function bindTopicListHeaderForumsMenu($context){$context.unbind("click",processTopicListHeaderForums).click(processTopicListHeaderForums)}function bindTopicClicks($context){$context.unbind("click",processTopicListClick).click(processTopicListClick)}function showAuthorPopout($context){var isSinglePostAuthor=$context.attr("authorPopout");return!IS_EMBEDDED&&(("undefined"!=typeof isTopicQuickView&&"false"!=isTopicQuickView||void 0!==isSinglePostAuthor&&"true"==isSinglePostAuthor)&&void $context.find('a[purpose="authorProfile"],img[purpose="authorProfile"]').hover(function(){var $this=$(this);if("undefined"!=typeof isTopicQuickView&&"false"!=isTopicQuickView||!$this.is('img[purpose="authorProfile"]')||"true"!=isSinglePostAuthor||"true"==$this.attr("authorPopout")){var authorId=$this.attr("authorId");if(-1!=authorId){var authorName=$this.attr("authorName"),forumId=$this.attr("forumId"),handleAuthPopout=setTimeout(function(){var currPos=$this.position(),maincont=$("#mainContent").position(),maincontLeft=maincont.left;if(currPos.left=currPos.left+parseInt(maincontLeft),0<$("#SinglePostContainer").length){var maincontTop=maincont.top;currPos.top=currPos.top+parseInt(maincontTop)+20}if(800<currPos.left&&(currPos.left=currPos.left-300),$authorPopup=$("#authorPopout_"+authorId),0<$authorPopup.length)$authorPopup.css(currPos).show(),authorPopupHover($authorPopup);else{$authorPopup=$("#authorPopoutTemplate").clone(),$authorPopup.attr("popoutPurpose","authorDetailsPopout"),$authorPopup.attr("id","authorPopout_"+authorId);var options={};options.forumGroupId=forumGroupId,options.authorId=authorId,options.forumId=forumId,options.ch=ch,options[csrfParamName]=csrfToken,doAjaxAction("/getAuthorPopup.do",options,function(data){$thisAuthPopup=$("<div>"+data+"</div>"),authorPopUpAction($thisAuthPopup,authorId,authorName,$authorPopup)}),$authorPopup.css(currPos).show(),$authorPopup.appendTo("body"),authorPopupHover($authorPopup)}},700);$this.data("destroyHandleAuthPopout",handleAuthPopout)}}},function(){var $this=$(this),authorId=$this.attr("authorId"),handleAuthPopout=$this.data("destroyHandleAuthPopout");handleAuthPopout&&clearTimeout(handleAuthPopout);var $authCont=$("#authorPopout_"+authorId);$authCont.attr("hideAuhPopout","true"),setTimeout(function(){"true"==$authCont.attr("hideAuhPopout")&&$authCont.hide()},500)}))}function mouseOutAuthor($target){var $this=$target,authorId=$this.attr("authorId"),handleAuthPopout=$this.data("destroyHandleAuthPopout");handleAuthPopout&&clearTimeout(handleAuthPopout);var $authCont=$("#authorPopout_"+authorId);$authCont.attr("hideAuhPopout","true"),setTimeout(function(){"true"==$authCont.attr("hideAuhPopout")&&$authCont.hide()},500)}function mouseOverAuthor($target){if("false"==isTopicQuickView||isZIntranet)return!1;var $authorPopup,$this=$target,authorId=$this.attr("authorId");if(-1!=authorId){var authorName=$this.attr("authorName"),forumId=$this.parents('li[parentCont="actualParent"]').attr("forumId");void 0===forumId&&(forumId=$this.attr("forumId"));var handleAuthPopout=setTimeout(function(){var currPos=$this.position();if(0<($authorPopup=$("#authorPopout_"+authorId)).length)$authorPopup.css(currPos).show(),authorPopupHover($authorPopup);else{($authorPopup=$("#authorPopoutTemplate").clone()).attr("popoutPurpose","authorDetailsPopout"),$authorPopup.attr("id","authorPopout_"+authorId);var options={};options.forumGroupId=forumGroupId,options.authorId=authorId,options.forumId=forumId,options.ch=ch,options[csrfParamName]=csrfToken,doAjaxAction("/getAuthorPopup.do",options,function(data){$thisAuthPopup=$("<div>"+data+"</div>"),authorPopUpAction($thisAuthPopup,authorId,authorName,$authorPopup)}),$authorPopup.css(currPos).show(),$authorPopup.appendTo("body"),authorPopupHover($authorPopup)}},700);$this.data("destroyHandleAuthPopout",handleAuthPopout)}}function authorPopUpAction($thisAuthPopup,authorId,authorName,$authorPopup){if($thisAuthPopup.find('li[purpose="watchUser"]').click(function(){$thisWatchCont=$(this);var watchOptions={};watchOptions.forumGroupId=forumGroupId,watchOptions.watchItemId=authorId,watchOptions.watchItemType=3,watchOptions[csrfParamName]=csrfToken;var watchAction=$thisWatchCont.attr("watchAction");doAjaxAction("watch"==watchAction?"/watchUser.do":"/unwatchUser.do",watchOptions,function(data){if("SUCCESS"==data){$thisWatchCont.attr("watchAction","watch"==watchAction?"unwatch":"watch");var displayText=("watch"==watchAction?i18n["zohodiscussions.general.Unwatch"]:i18n["zohodiscussions.general.watch"])+" "+authorName;$thisWatchCont.find('a[purpose="watchuserNameCont"]').html(displayText),"watch"==watchAction?showTipper(i18n["zohodiscussions.generalmessage.userAddedToWatchlist"],"success"):showTipper(i18n["zohodiscussions.generalmessage.userRemovedFromWatchlist"])}})}),$thisAuthPopup.find('li[purpose="addAsFriend"]').click(function(){$addFriendCont=$(this);var successMsg=$addFriendCont.attr("successMsg"),options={};options.forumGroupId=forumGroupId,options.userId=authorId,options[csrfParamName]=csrfToken,doAjaxAction("/addAsFriend.do",options,function(data){hideLoadingImage(),"SUCCESS"==data&&($addFriendCont.attr("purpose","friendWaitingApproval"),$addFriendCont.find('a[linkpurpose="addAsFriend"]').attr("style","cursor:default;text-decoration:none;").html(i18n["zohodiscussions.friends.awaitingApproval"]),$addFriendCont.find("div.imgAddFriend").removeClass("imgAddFriend").addClass("imgWaitingFriend"),showTipper(successMsg,"success"))})}),$thisAuthPopup.find('li[purpose="authorProfile"]').click(function(){authorName==screenName||authorName==encodedScreenName?processHash("MyArea"):processHash("User/"+authorName)}),$authorPopup.html("").append($thisAuthPopup),"undefined"!=typeof WmsContacts&&"true"==ch){var authStatus=WmsContacts.status(authorId);!1===authStatus&&(authStatus=9),manageUserChatStatus("authorPopup_"+authorId,authStatus)}}function authorPopupHover($authorPopup){$authorPopup.hover(function(){$authorPopup.attr("hideAuhPopout","false");var handle=$authorPopup.data("destroyHandle");handle&&clearTimeout(handle)},function(){var handle=setTimeout(function(){$authorPopup.hide(),$authorPopup.unbind("mouseenter").unbind("mouseleave")},700);$authorPopup.data("destroyHandle",handle)})}function displaySearchOption(){var $listOfSearchOptions=$("#listOfSearchOptions");$listOfSearchOptions.show(),$listOfSearchOptions.find("li").unbind("click").click(function(){var $currselectImg=$(this).find("div"),selectImg=$currselectImg.attr("class"),currpurpose=$currselectImg.attr("purpose");if($currselectImg.is(".imgAdvanceSearch")){if($("#advanceSearchContainerForm").is(":visible"))return void $("#listOfSearchOptions").hide();if($("#searchMainContainer").is(":visible"))return $("#normalSearchInSearchList").hide(),$("#advanceSearchContainerForm").show(),void $("#advanceSearchInpurBox").focus();showLoadingImage();var isResourceSearch=!!$listOfSearchOptions.attr("isResourceSearch")&&$listOfSearchOptions.attr("isResourceSearch"),options={};options.forumGroupId=forumGroupId,options.isResourceSearch=isResourceSearch,options[csrfParamName]=csrfToken,doAjaxAction("/AdvanceSearchContainer.do",options,function(data){hideLoadingImage();var $firstMainContainer=$("#mainContent > div:first"),$data=$("<div></div>");$data.get(0).innerHTML=data,$data.insertBefore($firstMainContainer),$data.find("#advanceSearchContainerForm").show(),$data.find("#advanceSearchInpurBox").focus(),$("#normalSearchInSearchList").is(":visible")&&$("#normalSearchContainer").hide(),bindSearchContentClick($data)},function(errordata){hideLoadingImage();var responseData=errordata.responseText;$("#mainContent").get(0).innerHTML=responseData})}else $currselectImg.is(".imgSearchBlack")&&(selectImg="imgSearchWhite flLeft"),$("#searchSelectedImage").attr("class",selectImg).attr("purpose",currpurpose),$("#searchInputBox").focus();$listOfSearchOptions.hide()});var $searchOptionParent=$listOfSearchOptions.parent("div");$searchOptionParent.hover(function(){var handle=$searchOptionParent.data("destroyHandle");handle&&clearTimeout(handle)},function(){var handle=setTimeout(function(){$listOfSearchOptions.hide(),$searchOptionParent.unbind("mouseenter").unbind("mouseleave")},500);$searchOptionParent.data("destroyHandle",handle)})}function bindSearchContentClick($context){$context.unbind("click",processSearchContClick).click(processSearchContClick),$("#SearchforumCategoryVice").change(function(){searchForumCatSelect($(this))})}function searchForumCatSelect($target){var forumId=$target.val(),categoriesForForum=$("#searchCategoryList").val().split("$$");$.each(categoriesForForum,function(index,item){if(-1<item.indexOf(forumId+":"))return $("#SearchCategoryVice").html('<option selected value="-1">'+i18n["zohodiscussions.myArea.all"]+"</option>"+item.split(":")[1]).show(),$("#SelectCategory option:first").attr("selected","true"),!1;-1==forumId?$("#SearchCategoryVice").html('<option selected value="-1">'+i18n["zohodiscussions.myArea.all"]+"</option>").show():$("#SearchCategoryVice").html('<option selected value="-1">Uncategorised</option>').show()}),$("#SearchCategoryVice option:first").attr("selected","true")}function bindWidgetsContClick($context){$context.unbind("click",processWidgetsContClick).click(processWidgetsContClick),lightBox("#chartWidget"),showAuthorPopout($context),bindSubscribeAction();var $target=$('#followAnnouncement a[purpose="watchAnnouncement"]');$target.click(function(event){watchThisItem($target,"announcement",event)})}function bindAllForumsClick($context){$context.unbind("click",processAllForumsClick).click(processAllForumsClick),showAuthorPopout($context)}function processTopicListHeaderForums(event){var $target=$(event.target),$targetParent=$target.parent();if($target.is("#forumsFilter span, #categoriesFilter span, #forumsFilter li, #categoriesFilter li,#currentCategoryContext,#currentForumContext"))return $target.is("#forumsFilter span,#categoriesFilter span")&&($target=$targetParent),hashPurpose=$target.attr("hashPurpose"),processHash(hashPurpose),!1}function processTopicListHeaderClick(event){var $target=$(event.target),$targetParent=$target.parent();if($target.is("#forumsFilter span, #categoriesFilter span, #forumsFilter li, #categoriesFilter li,#currentCategoryContext,#currentForumContext"))return $target.is("#forumsFilter span,#categoriesFilter span")&&($target=$targetParent),hashPurpose=$target.attr("hashPurpose"),processHash(hashPurpose),!1;if($target.is('div[purpose="linkForDropDown"]')){var $switchPortalLink=$target,portalsDropDownLocation=$switchPortalLink.attr("dropDownContLocation"),$parentCont=$($switchPortalLink.attr("parentCont"));$parentCont.is(".newCombo")?$parentCont.addClass("newComboSelected").removeClass("newCombo"):$parentCont.addClass("newCombo").removeClass("newComboSelected"),$("#"+portalsDropDownLocation).toggle()}if($target.is('#topicListFilter li[purpose="filterLink"]')){var topicFilter=$target.attr("topicFilter");$topicFilterParent=$("#topicListFilter");var forumURL=$topicFilterParent.attr("forumURL"),categoryURL=$topicFilterParent.attr("subForumURL");return"yes"==$topicFilterParent.attr("isTypeURL")?(getMoreTopics(forumURL,categoryURL,fetchPage,topicFilter,"",""),$("#currentFilterContext").html($target.text())):manageFilterHash(forumURL,categoryURL,topicFilter,""),!1}$target.is("#showAllTags")&&"Yes"!=$target.attr("isNiceURL")?processHash("AllTags"):"filterTab"==$target.attr("purpose")||$target.is("#innerTabFilter span")&&"filterTab"==$targetParent.parent().attr("purpose")?("filterTab"!=$target.attr("purpose")&&($target=$targetParent),manageFilterTabList($target)):$target.is('#innerTabFilter li[purpose="filterTabMenu"]')||"filterTabMenu"==$targetParent.attr("purpose")?("filterTabMenu"==$targetParent.attr("purpose")&&($target=$targetParent),manageFilterMenuList($target.attr("filterParent"),$target)):"searchTwitterTab"==$targetParent.attr("id")&&manageFilterTabList($targetParent);$("#typeFilterOptions")}function getTwitterSearchList(forumId,fetchPage,forumUrl,sinceId){if("true"==isTwitterPortal){var $tweetContainer=$("#tweetContainer"),currStatusId=$tweetContainer.attr("status_Id"),options={};options.forumGroupId=forumGroupId,void 0!==forumId&&(options.forumId=forumId),void 0!==forumUrl&&(options.forumURL=forumUrl),options[csrfParamName]=csrfToken,options.fetchPage=fetchPage;var nextPage=parseInt(fetchPage)+1;void 0!==sinceId?options.sinceId=sinceId:1<fetchPage?options.maxId=currStatusId:showLoadingImage();var action="/getMoreTwitterSearchList.do";"true"==isCommentBoxDomain&&(-1!=forumId&&void 0!==forumId||1!=fetchPage&&void 0!==fetchPage||-1!=sinceId&&void 0!==sinceId||(action="/getTwitterSearchList.do")),$("#currentFilterContext").is(":visible")&&(action="/getTwitterSearchList.do"),"/getMoreTwitterSearchList.do"!=action&&selectTab("twitterMain"),doAjaxAction(action,options,function(data){var $topicList=$("#topicList");if(1<fetchPage){$("#searchMoreTweetsLoading").remove();var $showMoreTweets=$('<div class="tFootCount" id="searchMoreTweets" forumId="'+forumId+'" fetchPage="'+nextPage+'" loadCompleted="false">Older Tweets</div>');$("#searchMoreTweetsParents").html($showMoreTweets),($data=$("<div></div>")).html(data),$data.find("#tweetContainer li").each(function(){$(this).hide(),$tweetContainer.append($(this))}),$data.unbind("click",bindTwittReplyContent).click(bindTwittReplyContent)}else{if(void 0!==sinceId){var $data,preTotal=$tweetContainer.find('li[isrecenttweets = "true"]').length;1<preTotal&&(preTotal=parseInt(preTotal)-1),($data=$("<div></div>")).html(data);var $latestTweets=$data.find("li");$latestTweets.hide();var recentTweetCount=$latestTweets.length;if(0<recentTweetCount){var recentStatusId=$data.find("#tweetContainer").attr("status_Id");$tweetContainer.attr("status_Id",recentStatusId),$("#searchRecentTweet").remove(),$latestTweets.insertBefore($tweetContainer.find("li:first")),recentTweetCount=parseInt(recentTweetCount)+preTotal,$('<li isrecenttweets="true" id="searchRecentTweet"><div id="searchRecentTweetsLink" class="tCount">You have '+recentTweetCount+" new tweets</div></li>").insertBefore($tweetContainer.find("li:first")),$("#searchRecentTweetsLink").unbind("click").click(function(){$tweetContainer.find('li[isrecenttweets = "true"]').attr("isrecenttweets","false").show(),$(this).parents("li").remove()})}manageRecentTweets()}else{var $topicListMainContainer=$("#topicListMainContainer");if(0<$topicListMainContainer.length&&$topicListMainContainer.is('[shouldReload="false"]')&&$topicListMainContainer.show().attr("shouldReload","true"),"/getTwitterSearchList.do"==action?($("#mainContent").get(0).innerHTML=data,bindTopicListHeaderForumsMenu($("#mainContent")),$topicList=$("#mainContent")):$("#topicList").get(0).innerHTML=data,hideLoadingImage(),-1==forumId){loadTweetCategories(0<$("#forum_Twitter_Default").length?$("#forum_Twitter_Default").attr("forumId"):$("#forum_Twitter_SelectForum").val(),"twitter_SubForumList","forum_Twitter_SelectSubForum")}}$topicList.unbind("click",bindTwittReplyContent).click(bindTwittReplyContent)}if(1==fetchPage&&void 0===sinceId){manageRecentTweets();var twitterHash="filter/twitter";void 0!==forumUrl&&(twitterHash="forum/"+forumUrl+"/"+twitterHash),$.history.add(twitterHash),getTwitterSearchList(forumId,2)}},function(err){var responseData=toEvaluateData(err.responseText);responseData.reason;"REMOTE_IP_LOCKED"==responseData.errorcode&&showMessage(i18n["zohodiscussions.generalmessage.tryagainaftersometime"],"failure")})}}function initTwitterPageActions(forumId){$("#topicList").unbind("click",bindTwittReplyContent).click(bindTwittReplyContent),bindTopicListHeaderClicks($("#topicListHeader")),bindWidgetsContClick($("#topicListWidgetsCont")),void 0!==forumId&&"null"!=forumId||(forumId=-1),getTwitterSearchList(forumId,2),manageRecentTweets()}function manageRecentTweets(){var $tweetCont=$("#tweetContainer");$tweetCont.is(":visible")&&setTimeout(function(){$tweetCont.is(":visible")&&getTwitterSearchList($tweetCont.attr("forumId"),1,$tweetCont.attr("forumUrl"),$tweetCont.attr("status_Id"))},6e4)}function bindTwittReplyContent(event){var $target=$(event.target),$targetParent=$target.parent();$targetParent.is(".ndTwitterBtnCont")&&"replyTweet"==$targetParent.attr("purpose")?addNewTweetPost($target):$target.is("#searchMoreTweets")&&manageMoreTweets($target)}function manageMoreTweets($this){var forumId=$this.attr("forumId"),fetchPage=$this.attr("fetchPage");$this.parents("li").remove(),$("#tweetContainer").find('li[isrecenttweets = "false"]').show(),getTwitterSearchList(forumId,fetchPage=parseInt(fetchPage)+1)}function addNewTweetPost($target){var $tweetContainer=$("#tweetContainer");if(1==$tweetContainer.data("inEditMode")){var currStatusId=$tweetContainer.data("currStatusId");return $("#tweetReply_"+currStatusId).focus(),void showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"info")}var statusId=$target.attr("statusId"),$eachTwitter=$("#eachTwittId_"+statusId),$eachTwitterCont=$("#twitterCont_"+statusId),$eachTwitterAuthImg=$("#twitterImg_"+statusId),options={};options.forumGroupId=forumGroupId,options.statusId=statusId,options.tweetBy=$eachTwitter.attr("tweetBy"),options.tweetDate=$eachTwitter.attr("tweetDate"),options.tweetAuthImg=$eachTwitterAuthImg.attr("src"),options.tweetCont=$eachTwitterCont.html(),options[csrfParamName]=csrfToken,newOpenEditor($("#tweetReplyContainer_"+statusId),"responseContent","postContentTA","tweetReply_"+statusId,"TweetPost","tweetContainer"),$tweetContainer.data("inEditMode",!0),$tweetContainer.data("currStatusId",statusId)}function loadTweetCategories(forumId,subFormCont,subForumLocation){var categoriesForForum=$("#"+subFormCont).val().split("$$"),$selectCategory=$("#"+subForumLocation);$selectCategory.hide(),$selectCategory.html(""),$.each(categoriesForForum,function(index,item){if(-1<item.indexOf(forumId+":"))return $selectCategory.html(item.split(":")[1]).show(),!1;-1!=forumId?$selectCategory.html('<option selected value="-1">Uncategorised</option>').show():$selectCategory.html('<option selected value="-1">choose Subforum</option>').show()})}function manageFilterTabList($target){var $innerTabFilter=$("#innerTabFilter");$innerTabFilter.find("li.selectedTab").removeClass("selectedTab"),"filterTab"==$target.attr("purpose")?$target.addClass("selectedTab"):$target.parents("li").addClass("selectedTab");var forumURL=$innerTabFilter.attr("forumURL"),categoryURL=$innerTabFilter.attr("subForumURL"),topicFilter=$target.attr("filterBy")||$target.find("a").attr("filterBy"),labelStatus="",topicFilterType=$innerTabFilter.attr("topicFilterType"),postsincelastvisit=$innerTabFilter.attr("postSinceLastVisitTime");"All"!=topicFilterType&&(labelStatus=$target.attr("filterLabelId")||$target.find("a").attr("filterLabelId"))&&(labelStatus=topicFilter,topicFilter=topicFilterType),"yes"==$innerTabFilter.attr("isTypeURL")?getMoreTopics(forumURL,categoryURL,1,topicFilter,postsincelastvisit,labelStatus):manageFilterHash(forumURL,categoryURL,topicFilter,labelStatus)}function manageFilterHash(forumURL,categoryURL,topicFilter,labelStatus){var filterURL="forum/";"false"!=isTopicQuickView&&""!=forumURL||(filterURL=""),""!=forumURL&&void 0!==forumURL&&(filterURL=filterURL+forumURL+"/"),""!=categoryURL&&void 0!==categoryURL&&(filterURL=filterURL+categoryURL+"/"),""!=labelStatus&&(labelStatus="/"+labelStatus);var filterType="filter/"+topicFilter+labelStatus+"/1";void 0!==topicFilter&&"all"==topicFilter.toLowerCase()&&(filterType=""!=forumURL?"1":"false"==isTopicQuickView?"recent":""),processHash(filterURL+filterType)}function manageFilterMenuList(context,$target){$("#"+context);if($("#innerTabFilter div.forumOptions").is(":visible")&&$(this).hide(),"filterTabMenu"==$target.attr("purpose")){var $innerTabFilter=$("#innerTabFilter"),forumURL=$innerTabFilter.attr("forumURL"),categoryURL=$innerTabFilter.attr("subForumURL"),labelStatus=$target.attr("labelName"),topicFilter=$target.parent().attr("filterType");$innerTabFilter.find("li.selectedTab").removeClass("selectedTab"),$("#"+topicFilter+"FilterMenuList").addClass("selectedTab");var filterBy=$target.attr("filterBy");filterBy&&(topicFilter=filterBy),"yes"==$innerTabFilter.attr("isTypeURL")?getMoreTopics(forumURL,categoryURL,1,topicFilter,"",labelStatus):manageFilterHash(forumURL,categoryURL,topicFilter,labelStatus)}}function bindTagsContClick($tagContext){$tagContext.find('li[purpose ="getTagPosts"]').click(function(){$this=$(this),processHash($this.attr("hashPurpose"))})}function processTopicListClick(event){var $target=$(event.target),$targetParent=$target.parent(),$topicUtilContainer=$("#topicList"),$location="topicList",forumTopicId=$target.parents('li[parentCont="actualParent"]').attr("forumTopicId");if($target.is('span[defaultTopicView="true"]')||$target.is('a[purpose="postTitleQuickView"]')){if(forumTopicId=forumTopicId||$targetParent.parents('li[parentCont="actualParent"]').attr("forumTopicId"),$target.is("span.nddownArrow")){var $lastUpArrow=$topicUtilContainer.data("currentUpArrow");void 0!==$lastUpArrow&&$lastUpArrow.removeClass("ndupArrow").addClass("nddownArrow"),$target.removeClass("nddownArrow").addClass("ndupArrow"),$topicUtilContainer.data("currentUpArrow",$target)}else $target.is("span.ndupArrow")&&$target.removeClass("ndupArrow").addClass("nddownArrow");return handleTopicClick(event,forumTopicId,$location),!1}if($target.is('a[purpose="postTitle"]')||$target.is("a.orangeLink")||$target.is('span[defaultTopicView="false"]')){if(showLoadingImage(),"false"!=isTopicQuickView){var recentResponseId=$target.parents('li[parentCont="actualParent"]').attr("recentResponseId"),isResponse=$target.attr("isResponse");return processHash(null!=recentResponseId&&"true"==isResponse?"Topic/"+forumTopicId+"/"+recentResponseId:"Topic/"+forumTopicId),!1}if(isEmbedService())return!1}else if($targetParent.is('li[purpose="moreAction"]'))manageMoreAction($targetParent);else if($target.is('a[purpose="moreAction"]')){manageMoreAction($target.parents("li"))}else if($target.is('a[purpose="linkedTopicTitle"]')){if(showLoadingImage(),"false"!=isTopicQuickView)return processHash("Topic/"+$target.attr("linkToTopicId")),!1}else{if($target.is('li[linkPurpose="replyToTopic"]')||$targetParent.is('li[linkPurpose="replyToTopic"]')){if(forumTopicId=forumTopicId||$targetParent.parents('li[parentCont="actualParent"]').attr("forumTopicId"),1==$topicUtilContainer.data("inEditMode")){showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"info");var openedEditorLcation=$topicUtilContainer.data("editorContLocation");$topicUtilContainer.data("eachTopicContainerId");return(openForumTopic=$topicUtilContainer.data("forumTopicId"))!=forumTopicId&&handleTopicClick(event,openForumTopic,"editTopicList"),setFocusToContainer($(openedEditorLcation)),!1}return $("#eachTopicReplyCont_"+forumTopicId).show(),newOpenEditor($("#eachTopicReply_"+forumTopicId),"responseContent","postContentTA","replyToTopic_"+forumTopicId,"Write","paginationContainer"),setFocusToContainer($("#eachTopicReplyCont_"+forumTopicId)),$topicUtilContainer.data("inEditMode",!0),$topicUtilContainer.data("editorContLocation","#eachTopicReplyCont_"+forumTopicId),$topicUtilContainer.data("eachTopicContainerId","#eachTopic_"+forumTopicId),$topicUtilContainer.data("forumTopicId",forumTopicId),!1}if(($target.is("#olderPostsLink")||$target.is("#newerPostsLink"))&&$target.is(".navBtnEnabled")){var forumURL=$target.attr("forumURL"),categoryURL=$target.attr("categoryURL"),fetchPage=$target.attr("fetchPage"),topicFilter=$target.attr("topicFilter"),getPostFor=$target.attr("getPostFor"),topicStatus=$target.attr("topicStatus"),postSinceLastVisitTime=$target.attr("postSinceLastVisitTime");if(void 0===getPostFor)getMoreTopics(forumURL,categoryURL,fetchPage,topicFilter,postSinceLastVisitTime,topicStatus,"true");else getMoreTagRelatedPost(fetchPage,$target.attr("tag_Name"),getPostFor)}else{if($target.is('a[purpose="forumPostsFilter"]'))return hashPurpose=$target.attr("hashPurpose"),processHash(hashPurpose),!1;if($target.is('a[purpose="authorProfile"]')||$target.is('img[purpose="authorProfile"]')){var authorName=$target.attr("authorName");return void(authorName==screenName||authorName==encodedScreenName?processHash("MyArea"):processHash("User/"+authorName))}if($target.is("div.imgSmallWatchSel")||$target.is("div.imgSmallWatch"))return void watchThisItem($target,"singleTopicWatch",event);if(($target.is("li.ndtopicNavPrev")||$target.is("li.ndtopicNavNext"))&&!$targetParent.is(".navLoading"))return void checkPrevNextResponse($target);if(($target.is("li.ndtopicNavFirst")||$target.is("li.ndtopicNavLast"))&&!$targetParent.is(".navLoading"))return void firstOrLastResponse($target);if($targetParent.is('li[purpose="watchAction"]'))return void watchThisItem($targetParent,$location=$targetParent.is('li[purpose="watchAction"]')?$location:"",event);if($target.is('input[purpose="watchAction"]')){forumTopicId=$target.attr("forumTopicId");var $isFollowTopicCont=$("#eachTopicReplyCont_"+forumTopicId).find('input[name="isFollowTopic"]');return void(1==$target.attr("checked")?$isFollowTopicCont.attr("value","true"):$isFollowTopicCont.attr("value","false"))}if($targetParent.is('li[purpose="emailThisTopic"]'))return openEmailTopicDialog($targetParent),void manageMoreAction($targetParent.parents('li[purpose="moreAction"]'));if($targetParent.is('li[purpose="moderateThisTopic"]'))return void moderateAction($targetParent,$location,event);if($targetParent.is('li[actionPurpose="delete"]'))return void singlePostDeleteAction($targetParent,$location);if($targetParent.is("#removeTopicLink")||$targetParent.is('li[purpose="removeTopicLink"]'))deletelinkedTopic($targetParent);else{if($targetParent.is('li[actionPurpose="edit"]')){var openForumTopic,thisResponseId=$targetParent.attr("responseId"),editingForumTopic=$targetParent.parents('li[parentCont="actualParent"]').attr("forumTopicId"),editResponseLocation="#eachTopic_"+editingForumTopic;return $topicUtilContainer.data("inEditMode")?(showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"info"),openedEditorLcation=$topicUtilContainer.data("editorContLocation"),editingForumTopic!=(openForumTopic=$topicUtilContainer.data("forumTopicId"))&&handleTopicClick(event,openForumTopic,$location),setFocusToContainer($(openedEditorLcation))):(newOpenEditor($("#recentResponseContent_"+thisResponseId),"responseContent","postContentTA","editPostContent_"+thisResponseId,"Edit","eachTopic_"+thisResponseId),setFocusToContainer($(editResponseLocation)),$topicUtilContainer.data("inEditMode",!0),$topicUtilContainer.data("editorContLocation",editResponseLocation),$topicUtilContainer.data("forumTopicId",editingForumTopic),$("#postTextContent_"+thisResponseId).find("ul.singlePostActions").hide(),$("#linkedTopic_"+thisResponseId).hide(),$("#singlePostActions_"+thisResponseId).hide(),$("#recent_ResPonse_"+thisResponseId).find("div.listOfResponseLink").hide(),$("#previewResponse").attr("location","topicListEditResponse"),$("#previewResponse").attr("responseId",thisResponseId),$("#previewResponse").attr("forumTopicId",editingForumTopic)),!1}if($target.is('li[deletepurpose="deleteAttachment"]'))return void deletePublishedAttachment($target,event);if($targetParent.is('span[deletepurpose="deleteAttachment"]'))return void deletePublishedAttachment($targetParent,event);if($targetParent.is("li[bestResponse]")){var $this=$targetParent,topicAuthorId=(thisResponseId=$this.attr("responseId"),forumTopicId=$this.parents('li[parentCont="actualParent"]').attr("forumTopicId"),$this.attr("topicAuthorId")),bestResponseAction=$this.attr("bestResponse"),options={};options.forumGroupId=forumGroupId,"choose"==bestResponseAction&&(options.responseId=thisResponseId),options.forumTopicId=forumTopicId,topicAuthorId==ZUID&&(options.topicowner="true"),options[csrfParamName]=csrfToken;var bestResponseURL="choose"==bestResponseAction?"/bestResponse.do":"/removeBestResponse.do";showSmallLoadingImage(event),doAjaxAction(bestResponseURL,options,function(data){"SUCCESS"==data?(showTipper("choose"==bestResponseAction?i18n["zohodiscussions.singlepost.bestResponseSuccessMsg"]:i18n["zohodiscussions.singlePost.removeBestResponseMsg"],"choose"==bestResponseAction?"success":"info"),refreshSingleTopic(forumTopicId)):(hideLoadingImage(),showMessage(i18n["zohodiscussions.generalmessage.noPermission"]))})}else if($target.is("input[followItem]")){var followItem=$target.attr("followItem"),responseId=$target.attr("responseId");"true"==followItem&&watchItem($target),$("#followTopicList_"+responseId).hide()}}}}}function manageMoreAction($target){if($target.is(".newComboSelectedNm"))return $target.removeClass("newComboSelectedNm").addClass("newCombo"),void $target.find("div.forumOptins").hide();$target.removeClass("newCombo").addClass("newComboSelectedNm");var $moreOptions=$target.find("div.forumOptins");$moreOptions.show(),$target.hover(function(){$target.attr("hideAuhPopout","false");var handle=$target.data("destroyHandle");handle&&clearTimeout(handle)},function(){var handle=setTimeout(function(){$target.removeClass("newComboSelectedNm").addClass("newCombo"),$moreOptions.hide(),$target.unbind("mouseenter").unbind("mouseleave")},500);$target.data("destroyHandle",handle)})}function refreshResponseVoteContainer(responseId){var options={};options.forumGroupId=forumGroupId,options.responseId=responseId,doAjaxAction("/refreshSingleResponse.do",options,function(data){var $voteCont=$(data).find('div[contPurpose="voteContainer"]');$("#postTextContent_"+responseId+' div[contPurpose="voteContainer"]').html($voteCont.html()),hideLoadingImage()})}function backtoEditor(){$("#addForumPostForm").show(),$("#writeNewTopic").show(),$("#publishPreviewedTopic").hide(),$("#backToEditor").hide(),$("#preview_Posts").hide(),$("#writePostButtons").show(),$("#writepostCont").show(),$("#forumTagsPreview").html(" ")}function publishPreviewedTopic(){$("#publishTopic").trigger("click")}function writePostPreview(userName,location,flag,isDraft){var finalTopicTitle=$("#topicTitle").val().replace(/^<+|<+$/g,"&lt;").replace(/<+/g,"&lt;").replace(/^>+|>+$/g,"&gt;").replace(/>+/g,"&gt;");if(""==(finalTopicTitle=finalTopicTitle.replace(/^\s+|\s+$/g,"").replace(/\s+/g," ")))return hideLoadingImage(),setFocusToContainer($("#topicTitle").focus()),enablePostButtons(),void showDiscussionMessage(i18n["zohodiscussions.writePost.TopicTitleCannotbeEmptymessage"],"failure");if(200<finalTopicTitle.length)return hideLoadingImage(),showDiscussionMessage(i18n["zohodiscussions.writePost.TopicTitleLengthMsg"],"failure"),void enablePostButtons();var contentToPost=editor.doc.body.textContent.trim();if("plaintext"===editor.mode&&(contentToPost=editor.getContent().trim()),""==contentToPost)return hideLoadingImage(),showDiscussionMessage(i18n["zohodiscussions.writePost.noContentInPost"],"failure"),void enablePostButtons();var selectedForumOption=$("#SelectForum").val(),selectedCategoryOption=$("#SelectCategory").val();if(null==selectedForumOption)return hideLoadingImage(),$("#selectForumMessage").show(),setFocusToContainer($("#SelectForum")),enablePostButtons(),void(isZSupport?showDiscussionMessage(i18n["zohodiscussions.writePost.selectAnyCategoryForZSupport"],"failure"):showDiscussionMessage(i18n["zohodiscussions.writePost.selectAnyForum"],"failure"));if("0"==selectedCategoryOption)return hideLoadingImage(),$("#selectForumMessage").show(),setFocusToContainer($("#SelectCategory")),enablePostButtons(),void(isZSupport?showDiscussionMessage(i18n["zohodiscussions.writePost.selectAnyForumForZSupport"],"failure"):showDiscussionMessage(i18n["zohodiscussions.writePost.selectAnyCategory"],"failure"));$("#selectForumMessage").hide();var writepostTags=$("#forumTags").val();if(""!=writepostTags&&null==(writepostTags=writepostTags.replace(/^\s+|\s+$/g," ").replace(/\s+/g," ")).match(/^[^\^\"'()~`!@#$%&:;\/\\?|<>{}[\]*-+=]+$/))return hideLoadingImage(),showDiscussionMessage(i18n["zohodiscussions.singlepost.specialCharacterNotAllowedMsg"],"failure"),void enablePostButtons();if(isDraft){$("#previewAttachment >li").html("");var attachmentDetails=$("#attachmentsListCont").find("div[attachmentDetails]");if(0<$("#attachmentsListCont").find("div[attachmentDetails]").length)attachmentListPreview($("#previewAttachment"),attachmentDetails),$("#AttachmentPreviewCont").show();else $("#AttachmentPreviewCont").hide()}$("#addForumPostForm").hide(),$("#writeNewTopic").hide(),$("#publishPreviewedTopic").show(),$("#backToEditor").show(),$("#writepostCont").show();var $previewSection=$("#preview_Posts").show();$("#writePostButtons").hide();var topicClass=$("#TopicContentHolder").attr("imgAttrClass"),topicType=$("#previewTopicTypeImg").attr("class").split(" ");if($("#previewTopicTypeImg").removeClass(topicType[1]).addClass(topicClass),$previewSection.is(":visible")){var $previewCont=$("#preview_breadCrumb,#preview_postHeader");$previewCont.find('a[purpose="authorProfile"]').html(userName),$("#previewDocumentTitle").html(finalTopicTitle),$previewCont.find('a[purpose="forum_Topic"]').html($("#SelectForum option:selected").text());var categoryCont=$("#SelectCategory option:selected").text();0<$("#SelectCategory option:selected").val()?($previewCont.find('span[purpose="cateArrow"]').show(),$previewCont.find('a[purpose="category_Topic"]').html(categoryCont)):($previewCont.find('span[purpose="cateArrow"]').hide(),$previewCont.find('a[purpose="category_Topic"]').html("")),""==(writepostTags=writepostTags.replace(/^\s+|\s+$/g," ").replace(/\s+/g," "))&&$("#forumTagsPreview").html(i18n["zohodiscussions.singlepost.noTagsMsg"]);for(var tagList=writepostTags.split(","),index=0;index<tagList.length;index++)""!=jQuery.trim(tagList[index])&&$("#forumTagsPreview").append("<li><a>"+tagList[index]+"</a></li>");contentToPost=(contentToPost=editor.getContent()).replace(/^\s+/g,"").replace(/\s+$/g,"");var textContentToPost=editor.doc.body.textContent.trim();if("plaintext"===editor.mode&&(textContentToPost=contentToPost.trim(),contentToPost=(contentToPost=encodeHTML(contentToPost)).replace(/\n/g,"<br/>")),""==textContentToPost)return hideLoadingImage(),void showDiscussionMessage(i18n["zohodiscussions.writePost.noContentInPost"],"failure");$previewSection.find("#responsePreviewContentContainer").html(contentToPost.trim())}}function forHidingSmallLoadingImg(){var $browserCont="";0<$("#newPostRightCont").length?$browserCont=$("#newPostRightCont"):0<$("#attachBrowseCont").length&&($browserCont=$("#attachBrowseCont")),$browserCont.find("[purpose='attachLoadingCont']").hide()}function processSearchContClick(event){var $target=$(event.target),$targetParent=$target.parent();if(!$("#loadingImg").is(":visible"))if($targetParent.is('div[purpose="advanceSearch"]'))$("#advanceSearchContainerForm").show(),$("#normalSearchInSearchList").hide();else if($target.is('button[purpose="advanceSearchCancel"]')||$target.is('div[purpose="advanceSearchCancel"]'))$("#advancedSearchForm").is(":visible")?$("#advancedSearchForm").remove():($("#advanceSearchContainerForm").hide(),$("#normalSearchContainer").show(),$("#normalSearchInSearchList").show());else if($target.is('button[purpose="normalSearch"]')){$("#normalSearchInputBox").val();processHash("normalsearch")}else if($target.is('button[purpose="getAdvanceSearch"]'))getDiscussionsAdvanceSearchResult();else{if($target.is('a[purpose="postTitle"]'))return void openSinglePost($target.attr("forumTopicId"),"topic",$target.attr("searchFor"));if($targetParent.is('a[purpose="postTitle"]'))return void openSinglePost($targetParent.attr("forumTopicId"),"topic",$targetParent.attr("searchFor"));if($target.is('a[purpose="forumAction"]')||$target.is('a[purpose="categoryAction"]')){processHash($target.attr("hashPurpose"))}else{if($target.is('a[purpose="authorProfile"]')||$targetParent.is('a[purpose="authorProfile"]')){var authorName=$target.attr("authorName");authorName||(authorName=$targetParent.attr("authorName"));var singleClickflag=$target.attr("singleClickflag");return singleClickflag||(singleClickflag=$targetParent.attr("singleClickflag")),void("0"==singleClickflag&&(authorName==screenName||authorName==encodedScreenName?processHash("MyArea"):processHash("User/"+authorName),$target.attr("singleClickflag","1")))}if($target.is("li.navBtnEnabled")&&$target.is('[navType="searchNav"]'))return void searchNavigation($targetParent,$target.attr("purpose"));if($target.is('a[purpose="relativeLinkSearch"]'))searchNavigation($target,"relativeLinkSearch");else if($target.is('a[purpose="sortbyrelevance"]')&&!$target.is(".boldText"))searchNavigation($("#breadCrumbForSearch span:last a"),"breadCrumbForSearch","relevance");else if($target.is('a[purpose="sortbydate"]')&&!$target.is(".boldText"))searchNavigation($("#breadCrumbForSearch span:last a"),"breadCrumbForSearch","date");else if($target.is('a[purpose="breadCrumbForSearch"]'))searchNavigation($target,"breadCrumbForSearch");else if($target.is('a[purpose="expandForumList"]')){if("off"==$target.attr("status"))$target.attr("status","on").html("&laquo; less"),$target.parents("ul").find("li").show();else{$target.attr("status","off").html("more &raquo;");var count=0;$target.parents("ul").children("li").each(function(){4<count&&$(this).hide(),count++})}}}}}function searchNavigation($target,navTab,sortby){showLoadingImage();var currFetchPage=parseInt($target.attr("fetchPage")),fieldType=$target.attr("fieldType"),categ_Id=$target.attr("categId"),path_Traverse=$target.attr("pathTraverse"),$breadCrumbForSearch=$("#breadCrumbForSearch"),forumId=$target.attr("forumId"),searchLevel=$target.attr("searchLevel"),isResourceSearch=$target.attr("isResourceSearch");if(void 0!==isResourceSearch&&"undefined"!==isResourceSearch||(isResourceSearch=!1),"next"==navTab?currFetchPage+=1:"prev"==navTab?currFetchPage-=1:currFetchPage=1,"undefined"==forumId&&(forumId=-1),"forums"==searchLevel||"all"==searchLevel){path_Traverse=categ_Id="";var $forumList=$("#SearchforumCategoryVice");$("#SearchCategoryVice").find('option[value="-1"]').attr("selected","true"),"all"==searchLevel&&$forumList.find('option[value="-1"]').attr("selected","true")}var searchSortBy=sortby;if("relevance"!=searchSortBy&&"date"!=searchSortBy&&(searchSortBy=$("#currSearchSortBy").attr("currSortBy")),$("#searchListContainer").is(":visible"))doAjaxAction("/getMoreSearchResult.do?fetchPage="+currFetchPage+"&searchSortBy="+searchSortBy+"&category_id="+categ_Id+"&category_pathTraverse="+path_Traverse,$("#advanceSearchForm").serialize(),function(data){hideLoadingImage(),reloadeSearchContainer(data,navTab,fieldType,forumId,categ_Id,path_Traverse,searchSortBy)});else{var options={};options.fetchPage=currFetchPage,options.searchSortBy=searchSortBy,options.searchFor="breadCrumbForSearch"==navTab?$breadCrumbForSearch.attr("searchFor"):$target.attr("searchFor"),options.category_pathTraverse=path_Traverse,options.category_id=categ_Id,options.forumGroupId=forumGroupId,options.forumId=forumId,options.isResourceSearch=isResourceSearch,options.normalSearchType=$("#searchSelectedImage").attr("purpose"),doAjaxAction("/getMoreSearchResult.do",options,function(data){hideLoadingImage(),reloadeSearchContainer(data,navTab,fieldType,forumId,categ_Id,path_Traverse,searchSortBy)})}}function reloadeSearchContainer(data,navTab,fieldType,forumId,categ_Id,path_Traverse,sortby){var $breadCrumbForSearch=$("#breadCrumbForSearch"),$data=$("<div></div>");$data.get(0).innerHTML=data;var $container=$data.find("#searchListContainer").html();$("#searchListContainer").html($container);var $searchResultViewRange=$data.find("#searchResultViewRange").html();$("#searchResultViewRange").html($searchResultViewRange);var $filterContainer=$data.find("#searchFilterArea").html();$("#searchFilterArea").html($filterContainer);var $currSearchSortBy=$data.find("#currSearchSortBy").html();if($("#currSearchSortBy").html($currSearchSortBy).attr("currSortBy",sortby),"relativeLinkSearch"==navTab)$("<span> &raquo; <a class=underline href=javaScript:; purpose=breadCrumbForSearch fieldType="+fieldType+" forumId="+forumId+" categId="+categ_Id+" pathTraverse="+path_Traverse+">"+fieldType+"</a></span>").insertAfter($("#breadCrumbForSearch").find("span:last"));else if("breadCrumbForSearch"==navTab){var afterRemove=0;$breadCrumbForSearch.children().each(function(){var $this=$(this),currType=$this.find("a").attr("fieldType");1==afterRemove&&$this.remove(),currType==fieldType&&(afterRemove=1)})}}function getDiscussionsAdvanceSearchResult(){showLoadingImage();var searchString=$("#advanceSearchInpurBox").val();if(""==(searchString=$.trim(searchString)))return showMessage(i18n["zohodiscussions.searchList.noSearchString"],"failure"),void hideLoadingImage();$("#SearchforumCategoryVice");doAjaxAction("/getAdvanceSearchResult.do",$("#advanceSearchForm").serialize(),function(data){hideLoadingImage();var $data=$("<div></div>");$data.get(0).innerHTML=data;$("#searchContainer");if($("#searchListContainer").is(":visible")){var $container=$data.find("#searchResultFullContainer").html();$("#searchResultFullContainer").html($container)}else $("#mainContent").get(0).innerHTML=data,bindSearchContentClick($("#mainContent")),$("#advanceSearchContainerForm").show(),$("#normalSearchInSearchList").hide()},function(err){hideLoadingImage(),"REMOTE_IP_LOCKED"==toEvaluateData(err.responseText).errorcode&&showMessage(i18n["zohodiscussions.generalmessage.tryagainaftersometime"],"failure")})}function processWidgetsContClick(event){var $target=$(event.target),$targetParent=$target.parent();if($target.is("a[hashPurpose]")&&$target.is('a[currpurpose="usingHash"]')){var hash=$target.attr("hashPurpose");if("false"!=isTopicQuickView||0!=hash.indexOf("Topic/"))return processHash(hash),!1}else if($target.is("div.teeplus")){var forumId=$target.attr("forumId");$("#allForumControl").find('div[purpose="subForumView_'+forumId+'"]').removeClass("teeplus").addClass("teeminus"),$("ul.eachCategoryContainer_"+forumId).show()}else if($target.is("div.teeminus")){forumId=$target.attr("forumId");$("#allForumControl").find('div[purpose="subForumView_'+forumId+'"]').removeClass("teeminus").addClass("teeplus"),$("ul.eachCategoryContainer_"+forumId).hide()}else{if($targetParent.is("#forumPermalink")){var thisForumPermalink=$targetParent.attr("thisForumPermalink");return $("#PermalinkCont textarea").val(thisForumPermalink),$("#permalink_Text").select(),void $("#PermalinkCont").show().parent().show()}if($targetParent.is("li.watchingForum"))watchThisItem($targetParent,"singleForumActions",event);else if($targetParent.is("li.watchingCategory"))watchThisItem($targetParent,"singleCategoryActions",event);else{if($target.is('a[purpose="newWatchedUser"]'))return void processHash("myarea/dashboard");if($target.is('a[purpose="newPrivateMsg"]'))return void processHash("myarea/privateMsg");if($target.is('a[purpose="newRecentActivity"]')){var currStatus=$target.attr("currStatus");return"dashboard"==currStatus?void processHash("myarea/"+currStatus):void processHash("myarea/watchList/"+currStatus)}if($target.is('a[purpose="authorProfile"]')){var authorName=$target.attr("authorName");return void("0"==$target.attr("singleClickflag")&&(authorName==screenName||authorName==encodedScreenName?processHash("MyArea"):processHash("User/"+authorName),$target.attr("singleClickflag","1")))}if($targetParent.is("#loginToParticipate"))$("#signinwidgetBox").hide(),$("#iamLoginBox").show();else if($targetParent.is("#chartMenu")){if($target.is("li")){$target.siblings().removeClass("selected"),$target.addClass("selected");var assocImage=$target.attr("assocImage"),$assocImage=$(assocImage);if("#weekTrendChart"==assocImage){var $chartImage=$assocImage.find('img[chart="true"]');void 0===$chartImage.attr("src")?($chartImage.attr("src",$chartImage.attr("actualURL")),$("#weekTrendChartLoading").show().siblings("a").hide(),$chartImage.one("load",function(){$assocImage.show(),$assocImage.prev('div[purpose="chartLoading"]').hide()}).each(function(){this.complete&&$(this).trigger("load")})):$assocImage.show().siblings().hide()}else $assocImage.show().siblings().hide()}}else if($target.is("li[assocDiv]")){$target.siblings().removeClass("selected"),$target.addClass("selected");var assocDiv=$target.attr("assocDiv");if("#topPublishers_Month"==assocDiv){if(0==$(assocDiv).find("li").length){forumId=$target.attr("forumId");var categoryId=$target.attr("categoryId"),options={};options.forumGroupId=forumGroupId,options.forumId=forumId,options.categoryId=categoryId,doAjaxAction("/getLeaderboardTopics.do",options,function(data){$(assocDiv).get(0).innerHTML=data})}$(assocDiv).show(),$("#topContributors_Month").hide()}else $(assocDiv).show().siblings("ul").hide()}}}}function processAllForumsClick(event){var $target=$(event.target),$targetParent=$target.parent();if($target.is("a[hashPurpose]")){var hashPurpose=$target.attr("hashPurpose");if(("false"!=isTopicQuickView||0!=hashPurpose.indexOf("Topic/"))&&"Yes"!=$target.attr("isNiceUrl"))return processHash(hashPurpose),!1}else{if($targetParent.is('li[purpose="eachForumPermalink"]')){var thisForumPermalink=$targetParent.attr("thisForumPermalink");return $("#PermalinkCont textarea").val(thisForumPermalink),$("#permalink_Text").select(),void $("#PermalinkCont").show().parent().show()}if($targetParent.is("li.watchingForum"))watchThisItem($targetParent,"singleForumActions",event);else if(1==$targetParent.attr("watchItemType"))watchThisItem($targetParent,"singleCategoryActions",event);else if($targetParent.is('div[purpose="moderator"]')){var forumId=$targetParent.attr("forumId");$forumCont=$("#forumId_"+forumId),$forumCont.is(".singleForumSub")&&$forumCont.removeClass("singleForumSub"),$forumCont.toggleClass("singleForumMod")}else if($targetParent.is('div[purpose="subforums"]')){var forumIdSub=$targetParent.attr("forumId");$forumCont=$("#forumId_"+forumIdSub),$forumCont.is(".singleForumMod")&&$forumCont.removeClass("singleForumMod"),$forumCont.toggleClass("singleForumSub")}}}function handleTopicClick(event,forumTopicId,$location){var $topicContainer=$("#eachTopic_"+forumTopicId),$recentResponseContainer=$("#lastResponse_"+forumTopicId),$topicList=($recentResponseContainer.parents('li[parentCont="actualParent"]').attr("recentResponseId"),$("#topicList"));$topicList.data("currentSelectedPost",$topicContainer);var $currFocusPost=$topicList.data("currentFocusPost");null!=$currFocusPost&&$currFocusPost.removeClass("hotKeyTopicCont"),$topicList.data("currentFocusPost",$topicContainer),1==$recentResponseContainer.is(":visible")?$topicContainer.removeClass("ndquickList").addClass(""):($topicContainer.siblings("li.ndquickList").removeClass("ndquickList").addClass(" "),$topicContainer.addClass("ndquickList"),setFocusToContainer($("#eachTopic_"+forumTopicId),!1,0)),"No"==$recentResponseContainer.attr("navStatus")&&"topicList"==$location&&($recentResponseContainer.attr("navStatus","Yes"),getprevAndFirstPost($recentResponseContainer))}function getMoreTopics(forumId,categoryId,fetchPage,topicFilter,postSinceLastVisitTime,statusURL,isPagination){showLoadingImage();var options={},filterHash="",isTypeUrl=$("#topicListHeaderCont").attr("isTypeURL"),$currviewFilter=$("#innerTabFilter");$("#topicListFilter").is(":visible")&&($currviewFilter=$("#topicListFilter")),""!=forumId&&(options.forumURL=forumId,filterHash="true"==isTopicQuickView?"forum/"+forumId:forumId),""!=categoryId&&(options.categoryURL=categoryId,filterHash=filterHash+"/"+categoryId),options.forumGroupId=forumGroupId,options.fetchPage=fetchPage;var isFilterThere=0;if(topicFilter&&"all"!=topicFilter.toLowerCase()&&("true"!=isOneTopicType||"questions"!=topicFilter.toLowerCase()&&"ideas"!=topicFilter.toLowerCase()&&"problems"!=topicFilter.toLowerCase())&&(""==filterHash?filterHash="filter":filterHash+="/filter",isFilterThere=1,filterHash=filterHash+"/"+topicFilter),topicFilter){if("yes"==$currviewFilter.attr("isTypeURL")){var currTopicFilter=$currviewFilter.attr("topicfiltertype");"all"==topicFilter.toLowerCase()?topicFilter=currTopicFilter:"unrepliedposts"==topicFilter.toLowerCase()&&(options.unReplyWithType=currTopicFilter)}options.topicFilter=topicFilter}if("postssincelastvisit"==topicFilter){var lastVisit=$currviewFilter.attr("postSinceLastVisitTime");null!=lastVisit&&"undefined"!=lastVisit&&(options.postSinceLastVisitTime=lastVisit)}var action="";if(0<$("#topicList").length&&"reload"!=isPagination?(action="/getMoreTopics.do",$locadLocation=$("#topicList")):0<$("#topicsList").length&&"reload"!=isPagination?(action="/getMoreTopicsTP.do",$locadLocation=$("#topicsList")):(action="/getSingleForumTopics.do",$locadLocation=$("#mainContent")),statusURL){var currStatusURL=statusURL=(statusURL=statusURL.toLowerCase()).replace(/\s/gi,"").replace("-","");if("problems"==topicFilter&&"needmoreinfo"==statusURL&&(statusURL="moreinfo",currStatusURL="needmoreinfo"),"questions"==topicFilter&&"workingonit"==statusURL&&(statusURL="working",currStatusURL="workingonit"),i18n_Status_[statusURL]){var i18n_statusURL=i18n_Status_[statusURL];i18n_statusURL&&(0==isFilterThere&&""==filterHash?filterHash="filter":0==isFilterThere&&(filterHash+="/filter"),filterHash=filterHash+"/"+currStatusURL,options.statusURL=i18n_statusURL)}}return doAjaxAction(action,options,function(data){($locadLocation.get(0).innerHTML=data,bindTopicClicks($("#topicList")),bindTopicClicks($("#topicsList")),"/getSingleForumTopics.do"==action&&(lightBox("#chartWidget"),lightBox("#topicList"),bindTopicListHeaderClicks($("#topicListHeader")),bindWidgetsContClick($("#topicListWidgetsCont"))),goToTop(),hideLoadingImage(),"undefined"!=typeof WmsContacts&&"true"==ch)&&setPresenceInTopicList(WmsContacts.getZohoContacts());"PostsSinceLastVisit"==topicFilter&&$("#topicList").find("a.mediumUnderlineLink").removeClass("mediumUnderlineLink").addClass("mediumUnderlineLinkNew");"no"==isTypeUrl&&"true"==isTopicQuickView&&(""!=filterHash?1<parseInt(fetchPage)?$.history.add(filterHash+"/"+fetchPage):$.history.add(filterHash):1<parseInt(fetchPage)?$.history.add("home/"+fetchPage):$.history.add("home"))},function(errordata){}),!1}function getMoreTagRelatedPost(fetchPage,tagName,getPostFor){showLoadingImage();var options={};return options.fetchPage=fetchPage,options.tagName=tagName,options.forumGroupId=forumGroupId,options.getPostFor=getPostFor,doAjaxAction("/getMoreTagRelatedPosts.do",options,function(data){0<$("#topicList").length?($("#topicList").get(0).innerHTML=data,bindTopicClicks($("#topicList"))):($("#topicsList").get(0).innerHTML=data,bindTopicClicks($("#topicsList"))),goToTop(),hideLoadingImage()},function(errordata){}),!1}function getSingleForumTopics($target){showLoadingImage();var $this=$target,options={};return options.forumId=$this.attr("forumId"),options.categoryId=$this.attr("categoryId"),options.forumGroupId=forumGroupId,options.fetchPage=$this.attr("fetchPage"),options.ch=ch,doAjaxAction("/getSingleForumTopics.do",options,function(data){$("#mainContent").get(0).innerHTML=data,lightBox("#chartWidget"),lightBox("#topicList"),bindTopicClicks($("#topicList")),bindTopicClicks($("#topicsList")),bindTopicListHeaderClicks($("#topicListHeader")),bindWidgetsContClick($("#topicListWidgetsCont")),goToTop(),hideLoadingImage(),0<$("#allForumWidget").length&&$("#allForumWidget").find('li[purpose="forumList"]').length<9&&$("#moreForumView").hide()},function(errordata){$("#mainContent").get(0).innerHTML=errordata.responseText,hideLoadingImage()}),!1}function selectTopicType($this,givenKey){var topicType="";if(void 0===givenKey||""==givenKey){$this.addClass("selected").siblings('li[purpose="topicTypeTab"]').removeClass("selected"),topicType=$this.attr("topicType");var topicTypeIcon=$this.attr("topicIconClass")}else topicTypeIcon=givenKey,topicType=$("#writepostCont").attr("topicType");var imgAttrClass="";1==topicType?(imgAttrClass="imgAnnouncement",$("#announcementExpiryCont").show()):$("#announcementExpiryCont").hide(),$("#currentTopicType").val(topicType),"discuss"==topicTypeIcon?(imgAttrClass="imgDiscuss",$("#writeNewTopic").html(i18n["zohodiscussions.writePost.discussionTypeMessage"])):"question"==topicTypeIcon?(imgAttrClass="imgQuestion",$("#writeNewTopic").html(i18n["zohodiscussions.writePost.questionTypeMessage"])):"idea"==topicTypeIcon?(imgAttrClass="imgIdea",$("#writeNewTopic").html(i18n["zohodiscussions.writePost.ideaTypeMessage"])):"error"==topicTypeIcon?(imgAttrClass="imgError",$("#writeNewTopic").html(i18n["zohodiscussions.writePost.problemTypeMessage"])):$("#writeNewTopic").html(i18n["zohodiscussions.writePost.announcementTypeMessage"]),$("#TopicContentHolder").attr("class",topicTypeIcon).attr("imgAttrClass",imgAttrClass),null==$("#SelectForum").val()?$("#selectForumMessage").show():$("#selectForumMessage").hide()}discussionsFunctions.tphome=function(givenKey,forumId,categoryId,limit,style,ph,tps,widget,aj,stat,qstr,tgt){getForumTopics(forumId,categoryId,1,givenKey,limit,style,ph,tps,widget,aj,stat,qstr,tgt)},discussionsFunctions.home=function(givenKey,fetchPage){fetchPage=fetchPage;void 0===givenKey&&(givenKey="home",fetchPage=1),getForumTopics(-1,-1,fetchPage,givenKey)},discussionsFunctions.chome=function(givenKey,fetchPage){fetchPage=fetchPage;void 0===givenKey&&(givenKey="chome",fetchPage=1),getForumTopics(-1,-1,fetchPage,givenKey)},discussionsFunctions.stats=function(givenKey){getTopicsReport(-1,-1,1,givenKey)},discussionsFunctions.forum=function(givenKey,forumURL,categoryURL,fetchPage){document.title=forumGroupName;$("#topicListMainContainer");var options={};options.forumGroupId=forumGroupId,options.forumURL=forumURL,options.fetchPage=fetchPage,categoryURL&&(options.categoryURL=categoryURL),doAjaxAction("/getSingleForumTopics.do",options,function(data){hideLoadingImage(),$("#mainContent").get(0).innerHTML=data,lightBox("#chartWidget"),categoryURL?1<parseInt(fetchPage)?$.history.add(givenKey+"/"+forumURL+"/"+categoryURL+"/"+fetchPage):$.history.add(givenKey+"/"+forumURL+"/"+categoryURL):1<parseInt(fetchPage)?$.history.add(givenKey+"/"+forumURL+"/"+fetchPage):$.history.add(givenKey+"/"+forumURL),goToTop(),lightBox("#topicList"),bindTopicClicks($("#topicList")),bindTopicClicks($("#topicsList")),bindTopicListHeaderClicks($("#topicListHeader")),bindWidgetsContClick($("#topicListWidgetsCont"));var $topicListFilter=$("#forumComboCont"),forumId=$topicListFilter.attr("forumId"),hashPurpose="NewTopic/"+forumId+"/"+$topicListFilter.attr("categoryId");if(0<$("#allForumWidget").length&&$("#allForumWidget").find('li[purpose="forumList"]').length<9&&$("#moreForumView").hide(),$("#NewTopicTab").attr("hashPurpose",hashPurpose),"undefined"!=typeof WmsContacts&&"true"==ch){var dataOb=WmsContacts.getZohoContacts();setPresence(dataOb,"moderatorsChatList_"+forumId),setPresenceInTopicList(dataOb)}return setToHotkeys(),!1},function(errordata){$("#mainContent").get(0).innerHTML=errordata.responseText,hideLoadingImage()})},discussionsFunctions.newtopic=function(givenKey,forumId,categoryId){var zuid=ZUID;if(-1==zuid&&"false"==canThisUserPostATopic&&"false"==isCustomSSOPortal)initLoginFrame($("#NewTopicTab"));else if(-1==zuid&&"true"!=canThisUserPostATopic||"false"!=isTopicQuickView)-1!=zuid&&"undefined"==typeof canThisUserPostATopic?window.location.href=serverURL:void 0===forumId&&void 0===categoryId?getWritePost("-1","-1",givenKey):getWritePost(forumId=void 0===forumId?-1:forumId,categoryId=void 0===categoryId?-1:categoryId,givenKey);else{var topicUrl=$("#NewTopicTab").attr("topicURL");window.location.href=serverURL+"/"+topicUrl}},discussionsFunctions.search=function(givenKey,searchFor,isResourceSearch){var options={};if(options.forumGroupId=forumGroupId,searchFor||(searchFor=$("#searchInputBox").val(),searchFor=$.trim(searchFor)),""==searchFor)return showMessage(i18n["zohodiscussions.searchList.noSearchString"],"failure"),void hideLoadingImage();void 0!==isResourceSearch&&""!==isResourceSearch||(isResourceSearch=!1);var $forumComboCont=$("#forumComboCont"),$categoryComboCont=$("#categoryComboCont"),forumId=$forumComboCont.attr("forumId"),categoryId=$forumComboCont.attr("categoryId"),hashPurposeForSearch=$categoryComboCont.attr("hashPurpose");options.searchFor=searchFor,options.forumId=forumId,options.categoryId=categoryId;var searchingPurpose=$("#searchSelectedImage").attr("purpose");options.normalSearchType=searchingPurpose,options.isResourceSearch=isResourceSearch,searchingPurpose=void 0===searchingPurpose?"":"all"!=searchingPurpose?"/"+searchingPurpose:"",void 0!==hashPurposeForSearch&&""!=hashPurposeForSearch?givenKey=hashPurposeForSearch+"/"+givenKey:("Home"==(hashPurposeForSearch=$forumComboCont.attr("hashPurpose"))&&(hashPurposeForSearch=""),void 0!==hashPurposeForSearch&&""!=hashPurposeForSearch&&(givenKey=hashPurposeForSearch+"/"+givenKey)),void 0!==isResourceSearch&&""!==isResourceSearch&&!1!==isResourceSearch||$.history.add(givenKey+searchingPurpose+"/"+encodeURIComponent(searchFor)),"date"==$("#currSearchSortBy").attr("currSortBy")&&(options.searchSortBy="date"),doAjaxAction("/getSearchResult.do",options,function(data){hideLoadingImage();var $data=$("<div></div>");$data.get(0).innerHTML=data,$("#mainContent").get(0).innerHTML=data,bindSearchContentClick($("#mainContent")),showAuthorPopout($data),$("#searchInputBox").val(searchFor)},function(err){hideLoadingImage(),"REMOTE_IP_LOCKED"==toEvaluateData(err.responseText).errorcode&&showMessage(i18n["zohodiscussions.generalmessage.tryagainaftersometime"],"failure")})},discussionsFunctions.topic=function(givenKey,forumTopicId,recentResponseId){null!=recentResponseId?openSinglePost(forumTopicId,givenKey,recentResponseId):openSinglePost(forumTopicId,givenKey)},discussionsFunctions.tag=function(givenKey,tagName){$.history.add(givenKey+"/"+tagName),$this=$(this),loadTagRelatedPost(tagName)},discussionsFunctions.alltags=function(allTags){$.history.add(allTags),$this=$(this);var options={};options.forumGroupId=forumGroupId,doAjaxAction("/showAllTags.do",options,function(data){return hideLoadingImage(),$("#mainContent").get(0).innerHTML=data,bindTagsContClick($("#allTagsContainer")),bindWidgetsContClick($("#topicListWidgetsCont")),!1},function(errordata){hideLoadingImage();var responseData=errordata.responseText;$("#mainContent").get(0).innerHTML=responseData})},discussionsFunctions.allforums=function(givenKey){0<$("#preloadedForumsCont").length&&($("#preloadedForumsCont").show().siblings().remove(),$.history.add(givenKey),hideLoadingImage());var options={purpose:"AllForums"};options.forumGroupId=forumGroupId,options[csrfParamName]=csrfToken,doAjaxAction("/AllForums.do",options,function(data){hideLoadingImage(),document.title=i18n["zohodiscussions.general.allForums"],$.history.add("AllForums"),$("#mainContent").get(0).innerHTML=data;var $iframeLogin=$("#iamLoginBox").find("iframe"),currSRC=$iframeLogin.attr("src");return $iframeLogin.attr("src",currSRC),allForumsBindActions(),!1},function(errordata){hideLoadingImage();var responseData=errordata.responseText;$("#mainContent").get(0).innerHTML=responseData})},discussionsFunctions.myarea=function(givenKey,myAreaAction,subAction){document.title=i18n["zohodiscussions.general.myarea"];var $myAreaParentContainer=$("#myAreaParentContainer");if(0<$myAreaParentContainer.length&&$myAreaParentContainer.is('[shouldReload="false"]'))$myAreaParentContainer.show().attr("shouldReload","true").siblings().remove(),hideLoadingImage();else{var options={};if(options.forumGroupId=forumGroupId,options[csrfParamName]=csrfToken,myAreaAction||(myAreaAction="dashboard"),"dashboard"!=myAreaAction&&"myposts"!=myAreaAction&&"watchlist"!=myAreaAction&&"friends"!=myAreaAction&&"bookmark"!=myAreaAction&&"privatemsg"!=myAreaAction&&"preference"!=myAreaAction)return void hideLoadingImage();options.myAreaAction=myAreaAction,options.ch=ch,doAjaxAction("/getMyArea.do",options,function(data){return $("#authorPopout:visible").hide(),hideLoadingImage(),$("#mainContent").get(0).innerHTML=data,getMyAreaBindActions(myAreaAction,givenKey,"",subAction),!1},function(errordata){hideLoadingImage();var responseData=errordata.responseText;$("#mainContent").get(0).innerHTML=responseData})}},discussionsFunctions.user=function(givenKey,authorName){getAuthorProfile(authorName)},discussionsFunctions.moderation=function(givenKey){document.title=i18n["zohodiscussions.moderationAction.moderation"];var options={};options.forumGroupId=forumGroupId,0<portalPlanIndex?options.postFor="AllWaitingApproval":(options[csrfParamName]=csrfToken,options.postFor="AllReportedSpam"),ModerationLoadingPage(options)};var createEditor=function(){try{var initObject;initObject=1==isDiscussionsMobileDevice?{id:"editorHolder",mode:"plaintext",content:$("#postContentTA").val()}:{id:"editorHolder",content:$("#postContentTA").val(),allowTagsInsertHTML:["iframe"],allowAttrsInsertHTML:["frameborder","allowfullscreen"]},editor=ZE.create(initObject)}catch(ex){setTimeout(function(){createEditor()},300)}};function initWritePost(){$("#editorHolder > .ze").is(":visible")||newOpenEditor($("#editorLocation"),"responseContent","postContentTA"),loadCategories(),isAutoSuggestEnabled&&(portalUsersAutoSuggest($("#forumallTags"),$("#forumTags")),portalUsersAutoSuggest($("#allForumUsersEmail"),$("#emailIds"))),$('#writepostTabsCont li[purpose="topicTypeTab"]').click(function(){selectTopicType($(this))}),$("#SelectForum").change(function(){loadCategories()}),$("#publishTopic").click(function(){addForumPost(!1)}),$("#previewTopic").click(function(){var $this=$(this),isDraft=$this.attr("isDraft");writePostPreview($this.attr("userName"),"Preview","true",isDraft)}),$("#attachmentsListCont").find("div.imgAshDelete").click(function(event){$this=$(this),deleteUnpublishedAttachment($this.attr("attachmentName"),$this.attr("attachmentId"),event)}),$("#listOfMyDraftCont").click(function(){if(!($(this).attr("draftsize")<1)){var $this=$(this);$this.is(".moreOptionsTop")?$this.removeClass("moreOptionsTop").addClass("moreOptionsTopSelected"):$this.removeClass("moreOptionsTopSelected").addClass("moreOptionsTop"),$this.hover(function(){var handle=$this.data("destroyHandle");handle&&clearTimeout(handle)},function(){var handle=setTimeout(function(){$this.removeClass("moreOptionsTopSelected").addClass("moreOptionsTop")},500);$this.data("destroyHandle",handle)})}}),$("#saveDraft").click(function(){addForumPost(!0)}),$("#cancelAddTopic").click(function(){$("#mainContent div.mainFullWrite").html(""),isCancelButtonClicked("Home")}),loadUploadAttachmentsCont()}function closeGDocsAttachTemplate(docType){"zdocs"==docType?$("#zDocsTemplate").hide():$("#gDocsTemplate").hide(),hideLoadingImage()}function loadUploadAttachmentsCont(docs,attachType){var forNewPost=1==$("#attachTemplate").length,contName=1==forNewPost?"attachTemplate":"responseAttachTemplate",$attachmentsListCont=$("#attachmentsListCont"),attachementsUploaded=$attachmentsListCont.find("div.singleElementBox,li.tinyText").length;if($("#publishResponse,#previewResponse").attr("disabled",!1),$("#publishTopic,#saveDraft").attr("disabled",!1),"attachZDocs"===attachType&&($("#publishResponse,#previewResponse").attr("disabled",!0),$("#publishTopic,#saveDraft").attr("disabled",!0)),1==forNewPost?$('#newPostRightCont  div[purpose="attachmentTemplate"]').remove():$("#attachBrowseCont").html(""),attachementsUploaded<maxAttachmentsPerPost){var remAttachement=maxAttachmentsPerPost-attachementsUploaded,currentAttachementNo=attachementsUploaded+1,$attacher=$("#"+contName).clone();1==forNewPost?$attacher.insertBefore($attachmentsListCont).show():$("#attachBrowseCont").append($attacher.show()).show(),$attacher.attr("id",contName+"_"+currentAttachementNo),$attacher.attr("purpose","attachmentTemplate");var attacherAction='<form action = "/uploadFile.do" target = "fileUpdTgt" method="post" enctype="multipart/form-data"></form>';isEmbedService()&&(attacherAction='<form action = "/discussions/uploadFile.do" target = "fileUpdTgt" method="post" enctype="multipart/form-data"></form>'),$attacher.find("div.dataEncloser").wrap(attacherAction),$attacher.find("div.iFrameContainer").html('<iframe name = "fileUpdTgt_'+currentAttachementNo+'"> </iframe>'),$attacher.find("form").attr("target","fileUpdTgt_"+currentAttachementNo);var $currDataEncloser=$attacher.find("form > div.dataEncloser"),$currDesktopAttach=$currDataEncloser.find("span#desktopAttachments"),$currZDocsAttach=$currDataEncloser.find("a#zDocsAttachments"),$currGDocsAttach=$currDataEncloser.find("a#gDocsAttachments");if($currDesktopAttach.click(function(){if($("#publishResponse").attr("disabled")||$("#publishTopic").attr("disabled"))return!1;$("input[type=file]").change(function(){$("#publishResponse,#previewResponse").attr("disabled",!0),$("#publishTopic,#saveDraft").attr("disabled",!0)})}),$currZDocsAttach.click(function(){if($("#publishResponse").attr("disabled")||$("#publishTopic").attr("disabled"))return!1;var docsBaseURL="https://"+ZDOCS_URL,attachObj={servicename:"discussion",attachCount:currentAttachementNo,search:!1,docsURL:docsBaseURL};ATTACHDIALOG.showAttachFileDialog(attachObj)}),$currGDocsAttach.click(function(){if($("#publishResponse").attr("disabled")||$("#publishTopic").attr("disabled"))return!1;var gDocSrc=scheme+"://"+GADGET_URL+"/gdocs?serURL="+scheme+"://"+domainNameURL+"/jsp/AddGDocs.jsp&maxDocs="+remAttachement+"&id=1";isEmbedService()&&(gDocSrc=scheme+"://"+GADGET_URL+"/gdocs?serURL="+scheme+"://"+domainNameURL+"/discussions/jsp/AddGDocs.jsp&maxDocs="+remAttachement+"&id=1");var $gDocsTemplate=$("#gDocsTemplate");$gDocsTemplate.html('<iframe height="600px;" width="800px;" style="margin-top:5%; margin-left:17%" src="'+gDocSrc+'"></iframe>'),$gDocsTemplate.show()}),void 0===docs)$attacher.find(":file").change(function(){$attacher.find('[purpose="attachLoadingCont"]').show(),$attacher.find(':input[name="attacher"]').val(""),$attacher.find("form").get(0).submit()});else{showLoadingImage(i18n["zohodiscussions.settings.creating"]);var eachGDocs=docs.split(":"),docsType="attachZDocs";"gdocs"==attachType&&(docsType="attachGDocs"),$.each(eachGDocs,function(index,item){$attacher.find("form div.dataEncloser").append('<input name="'+docsType+'"  type="hidden" value="'+item+'">')}),$attacher.find("form").get(0).submit()}}}function uploadGDocsFileSuccess(attachDetails,forumGroupId,docType){for(var attachedLength=attachDetails.length,isFailed=0,listOfFailedAttach="",concat="",i=0;i<attachedLength;i++){var $eachAttachArr=attachDetails[i],result=$eachAttachArr.result,attachmentName=$eachAttachArr.actualFileName;if("success"==result){var actualAttachmentId=$eachAttachArr.actualAttachId,formattedFileSize=$eachAttachArr.attachmentSize;uploadFileSuccess($eachAttachArr.attachmentId,attachmentName,forumGroupId,actualAttachmentId,formattedFileSize)}else{isFailed=1;var reason=$eachAttachArr.reason;listOfFailedAttach=listOfFailedAttach+concat+"<b>"+attachmentName+"</b> : "+i18n[reason],concat="<br><br>"}}1==isFailed&&(showMessage(i18n["zohodiscussions.popupContainers.failedattachmentMess"]+"<br>"+listOfFailedAttach,"failure","20%"),($("#publishResponse").attr("disabled")||$("#publishTopic").attr("disabled"))&&($("#publishResponse,#previewResponse").attr("disabled",!1),$("#publishTopic,#saveDraft").attr("disabled",!1),loadUploadAttachmentsCont())),closeGDocsAttachTemplate(docType)}function uploadFileSuccess(attachmentId,attachmentName,forumGroupId,actualAttachmentId,formattedFileSize){var $currentAttachment,$attachmentsListCont=$("#attachmentsListCont"),forNewPost=1==$("#attachTemplate").length,attachmentDetails=attachmentId+","+encodeHTML(attachmentName)+","+formattedFileSize;if($("#previewResponse").append('<input type = "hidden" name="attachmentId" value = "'+attachmentId+'"  attachmentDetails= "'+attachmentDetails+'">'),1==forNewPost){$currentAttachment=$('<div id="newAttachment_'+attachmentId+'" class="singleElementBox" attachmentDetails="'+attachmentDetails+'"><div class="flLeft">'+encodeHTML(attachmentName)+'</div><div class="flRight imgAshDelete bgBox"></div></div>');$("#previewAttachment");$("#newAttachment_"+attachmentId).attr("attachmentDetails",attachmentDetails),$("#AttachmentPreviewCont").show()}else attachmentDetails=attachmentId+","+attachmentName+","+formattedFileSize,($currentAttachment=$("#responseEachAttachmentTemplate").clone()).attr("id","newAttachment_"+attachmentId).attr("attachmentDetails",attachmentDetails).show(),$currentAttachment.find('[attachmentPurpose="attachmentName"]').text(attachmentName),$currentAttachment.find('[attachmentPurpose="attachmentSize"]').text(formattedFileSize);-1!=actualAttachmentId&&$currentAttachment.append('<input type = "hidden" name="attachmentId" value = "'+actualAttachmentId+'">'),$currentAttachment.find("div.imgAshDelete").click(function(event){deleteUnpublishedAttachment(attachmentName,attachmentId,event)}),$attachmentsListCont.append($currentAttachment),loadUploadAttachmentsCont()}function deleteUnpublishedAttachment(attachmentName,attachmentId,event){if(confirm(i18n["zohodiscussions.generalmessage.deleteAttachmentConfirmMsg"])){showSmallLoadingImage(event);var options={};options.forumGroupId=forumGroupId,options.fileName=attachmentName,options.fileId=attachmentId,options[csrfParamName]=csrfToken,doAjaxAction("/deleteUnpublishedAttachment.do",options,function(data){hideLoadingImage(),"SUCCESS"==data&&($("#newAttachment_"+attachmentId).remove(),1==$("#previewAttachment").find("li.singleList").length&&$("#AttachmentPreviewCont").hide(),$("#previewResponse").find('input[value= "'+attachmentId+'"]').remove(),showTipper(i18n["zohodiscussions.general.Deleted"],"info"),loadUploadAttachmentsCont())})}}function loadCategories(){loadAdminActionsLinks();var $selectForumContainer=$("#SelectForum"),forumId=$selectForumContainer.val(),selectedCategoryId=($selectForumContainer.attr("selectedCategoryName"),$selectForumContainer.attr("selectedCategoryId")),categoriesForForum=$("#categoryList").val();$("#SelectCategory").hide(),$("#selectCategory").html(""),void 0!==categoriesForForum&&$.each(categoriesForForum.split("$$"),function(index,item){if(-1<item.indexOf(forumId+":"))return $("#SelectCategory").html(item.split(":")[1]).show(),!1;$("#SelectCategory").html('<option selected value="-1">Uncategorised</option>').show()});var $selectedCategoryCont=$("#SelectCategory").find('option[value="'+selectedCategoryId+'"]');1==$selectedCategoryCont.length?$selectedCategoryCont.attr("selected","true"):$("#SelectCategory option:first").attr("selected","true")}function loadAdminActionsLinks(){var isForumModerator=$("#SelectForum option:selected").attr("isForumModerator"),isForumPublicView=$("#SelectForum option:selected").attr("isForumPublicView");"true"==isForumModerator?$("#isStickyLinkCont,#announcementLinkCont").fadeIn():($("#isStickyLinkCont,#announcementLinkCont").fadeOut(),"announcement"==$("#writepostTabsCont li.selected").attr("topicIconClass")&&$("#writepostTabsCont li:first").trigger("click")),0x591a208af78bb8!=forumGroupId&&void 0!==isForumPublicView&&"false"==isForumPublicView?$("#isNotifyEveryone").fadeIn():$("#isNotifyEveryone").fadeOut()}function addForumPost(isDraft){if("uploading"!=$("#fileUploadStatus").val()){var loadingMessage=1==isDraft?i18n["zohodiscussions.general.saving"]:i18n["zohodiscussions.general.publishing"];disablePostButtons();$("#addForumPostForm");$topicTitle=$("#topicTitle");var postTitle=$topicTitle.val();if(postTitle=postTitle.replace(/^\s+|\s+$/g," ").replace(/\s+/g," "),""==(postTitle=$.trim(postTitle)))return hideLoadingImage(),setFocusToContainer($("#topicTitle")),enablePostButtons(),showDiscussionMessage(i18n["zohodiscussions.writePost.TopicTitleCannotbeEmptymessage"],"failure"),void $("#topicTitle").focus();if($("#topicTitle").val(postTitle),200<postTitle.length)return hideLoadingImage(),showDiscussionMessage(i18n["zohodiscussions.writePost.TopicTitleLengthMsg"],"failure"),void enablePostButtons();var postTags=$("#forumTags").val();if(""!=(postTags=postTags.replace(/^\s+|\s+$/g," ").replace(/\s+/g," "))&&null==postTags.match(/^[^\^\"'()~`!@#$%&:;\/\\?|<>{}[\]*-+=]+$/))return hideLoadingImage(),showDiscussionMessage(i18n["zohodiscussions.singlepost.specialCharacterNotAllowedMsg"],"failure"),void enablePostButtons();for(var tag=postTags.split(","),i=0;i<tag.length;i++)if(50<tag[i].length)return showDiscussionMessage(i18n["zohodiscussions.singlepost.TagexceedMessage"],"failure"),void enablePostButtons();var contentToPost=editor.getContent();contentToPost=contentToPost.replace(/^\s+/g,"").replace(/\s+$/g,"");var textContentToPost=editor.doc.body.textContent.trim();if("plaintext"===editor.mode&&(textContentToPost=contentToPost.trim(),contentToPost=(contentToPost=encodeHTML(contentToPost)).replace(/\n/g,"<br/>")),$("#postContentTA").val(contentToPost.trim()),""==textContentToPost)return setFocusToContainer($("#editorHolder").focus()),hideLoadingImage(),enablePostButtons(),void showDiscussionMessage(i18n["zohodiscussions.writePost.noContentInPost"],"failure");1==isDraft?$("#topicStatus").val(1):$("#topicStatus").val(0);var selectedForum=$("#SelectForum").val(),selectedCategory=$("#SelectCategory").val();if(null==selectedForum)return hideLoadingImage(),isZSupport?showDiscussionMessage(i18n["zohodiscussions.writePost.selectAnyCategoryForZSupport"],"failure"):showDiscussionMessage(i18n["zohodiscussions.writePost.selectAnyForum"],"failure"),void enablePostButtons();if("0"==selectedCategory)return hideLoadingImage(),isZSupport?showDiscussionMessage(i18n["zohodiscussions.writePost.selectAnyForumForZSupport"],"failure"):showDiscussionMessage(i18n["zohodiscussions.writePost.selectAnyCategory"],"failure"),void enablePostButtons();var action="/addForumPost.do";-1==ZUID&&(action="/addGuestForumPost.do"),showLoadingImage(loadingMessage),doAjaxAction(action,$("#addForumPostForm").serialize(),function(data){hideLoadingImage();var responseData=toEvaluateData(data);if("success"==responseData.result){var forumTopicId=responseData.value;if(1==isDraft)showDiscussionMessage(i18n["zohodiscussions.writePost.saveDraftMsg"],"success",3e3),enablePostButtons(),$("#forumTopicId").val(forumTopicId);else{if(0==responseData.isApproved)return $("#mainContent div.mainFullWrite").html(""),showDiscussionMessage(i18n["zohodiscussions.writePost.topicAwaitingModeration"],"info"),void("false"!=isTopicQuickView||isZSupport?-1==ZUID?window.location.href="/portalLogin.do?forumGroupUrl="+currentForumGroupURL+"&serviceurl=/":(showLoadingImage(),topiconClickActionNewTopic(selectedForum,forumTopicId,"newtopic",responseData.topicPermaLink)):window.location.href=serverURL+"/topic/"+responseData.topicPermaLink);$("#mainContent div.mainFullWrite").html(""),showDiscussionMessage(i18n["zohodiscussions.writePost.publishMsg"],"success",4e3),"false"!=isTopicQuickView||isZSupport?(showLoadingImage(),topiconClickActionNewTopic(selectedForum,responseData.value,"newtopic",responseData.topicPermaLink)):window.location.href=serverURL+"/topic/"+responseData.topicPermaLink}}else showDiscussionMessage(responseData.reason,"failure"),enablePostButtons()},function(errordata){if(hideLoadingImage(),0<errordata.responseText.indexOf("'result':'failure'")){var responseData=toEvaluateData(errordata.responseText);if("failure"==responseData.result)if("HIP_REQUIRED"==responseData.errorcode){var $writePostCaptcha=$("#writePostCaptcha");"new"==$writePostCaptcha.attr("currCaptcha")?showDiscussionMessage(i18n["zohodiscussions.writePost.captchaMsg"],"failure"):showDiscussionMessage(i18n["zohodiscussions.writePost.captchaErrorMsg"],"failure"),$writePostCaptcha.find('img[purpose="captchaImage"]').replaceWith("<img purpose=captchaImage name=hipImg border=0 src=/showcaptcha?digest="+responseData.reason+" align=absmiddle alt=HIP image>"),$("#captchaCode").attr("name",responseData.reason),$writePostCaptcha.attr("currCaptcha","old"),$writePostCaptcha.show()}else showDiscussionMessage(responseData.reason,"failure")}else""!=errordata.responseText&&($("#writepostCont").get(0).innerHTML=errordata.responseText);enablePostButtons()})}else $("#submitStat").show()}function singlePostDeleteAction($this,$location){var forumTopicId=$this.attr("forumTopicId");forumTopicId=forumTopicId||$this.parents('li[parentCont="actualParent"]').attr("forumTopicId");var responseId=$this.attr("responseId"),categoryId=$this.attr("categoryId");categoryId=categoryId||$this.parents('li[parentCont="actualParent"]').attr("categoryId");var responseAuthorId=$this.parents('li[parentCont="actualParent"]').attr("responseAuthorId"),forumId=$this.attr("forumId");if(forumId=forumId||$this.parents('li[parentCont="actualParent"]').attr("forumId"),"post"!=$this.attr("itemType")){var deleteResponse={};responseAuthorId==ZUID&&(deleteResponse.responseowner="true"),deleteResponse.forumGroupId=forumGroupId,deleteResponse.forumTopicId=forumTopicId,deleteResponse.categoryId=categoryId,deleteResponse.forumId=forumId,deleteResponse.responseId=responseId,deleteResponse[csrfParamName]=csrfToken,isEmbedService()?doAjaxAction("/deleteForumResponse.do",deleteResponse,function(data){if("SUCCESS"==data){if(showTipper(i18n["zohodiscussions.generalmessage.responseMovedToTrash"],"info",2e3),"moderation"==$location){var tabPurpose=$("#moderationTabCont").find("li.selected").attr("tabPurpose");refreshingPage(tabPurpose)}else refreshSingleTopic(forumTopicId);updateAwaitingApprovalCount()}}):"topicList"==$location?doAjaxAction("/deleteForumResponse.do",deleteResponse,function(data){if("SUCCESS"==data){showTipper(i18n["zohodiscussions.generalmessage.responseMovedToTrash"],"info",2e3);var tagName=$("#eachTopic_"+forumTopicId).attr("currTagName");" "==tagName?getSingleForumTopics($("#forumComboCont")):loadTagRelatedPost(tagName)}}):slideUpActionInModeration("/deleteForumResponse.do",deleteResponse,$this)}else{var deleteOptions={};if(responseAuthorId==ZUID&&(deleteOptions.access="author"),deleteOptions.forumGroupId=forumGroupId,deleteOptions.forumTopicId=forumTopicId,deleteOptions.categoryId=categoryId,deleteOptions.forumId=forumId,deleteOptions[csrfParamName]=csrfToken,isEmbedService())doAjaxAction("/deleteTopic.do",deleteOptions,function(data){if("SUCCESS"==data)if(showTipper(i18n["zohodiscussions.generalmessage.topicMovedToTrash"],"info",2e3),"moderation"==$location){var tabPurpose=$("#moderationTabCont").find("li.selected").attr("tabPurpose");refreshingPage(tabPurpose)}else refreshSingleTopic(forumTopicId)});else if("topicList"==$location){var tagName=$("#eachTopic_"+forumTopicId).attr("currTagName");doAjaxAction("/deleteTopic.do",deleteOptions,function(data){"SUCCESS"==data&&(showTipper(i18n["zohodiscussions.generalmessage.topicMovedToTrash"],"info",2e3)," "==tagName?getSingleForumTopics($("#forumComboCont")):loadTagRelatedPost(tagName))})}else slideUpActionInModeration("/deleteTopic.do",deleteOptions,$this)}}function refreshSingleTopic(forumTopicId){var $topicList=$("#topicList");$topicList.length<1&&($topicList=$("#topicsList"));var options={};options.forumTopicId=forumTopicId,options.forumGroupId=forumGroupId,options.singleTopicRefresh="singleTopicRefresh";var $divToRefresh=$("#eachTopic_"+forumTopicId);doAjaxAction("/refreshSingleTopic.do",options,function(data){if(hideLoadingImage(),$data=$("<div></div>").html(data),$data.find("li.singleList").length<1)return $divToRefresh.remove(),!1;var thisModifiedTime=$data.find("div.singleTopicCont").attr("modifiedtime"),endPostModifiedTime=$topicList.find("div.singleTopicCont:last").attr("modifiedtime"),$firstSinglePost=$topicList.find("div.singleTopicCont:first"),startPostModifiedTime=$firstSinglePost.attr("modifiedtime"),shouldScrollTop=!1;thisModifiedTime<endPostModifiedTime?$divToRefresh.remove():(startPostModifiedTime<thisModifiedTime?$data.insertBefore($firstSinglePost):$data.insertBefore($divToRefresh),$divToRefresh.remove(),shouldScrollTop=!0),1==shouldScrollTop&&goToTop()})}function disablePostButtons(){$("#publishTopic").attr("disabled",!0),$("#saveDraft").attr("disabled",!0),$('button[purpose="publishPreviewLink"]').attr("disabled",!0)}function enablePostButtons(){$("#publishTopic").attr("disabled",!1),$("#saveDraft").attr("disabled",!1),$('button[purpose="publishPreviewLink"]').attr("disabled",!1)}function getprevAndFirstPost($content){var forumTopicId=$content.parents('li[parentCont="actualParent"]').attr("forumTopicId"),options={};options.forumGroupId=forumGroupId,options.forumTopicId=forumTopicId;var responseId=$content.attr("recentResponseId");if(void 0!==responseId)options.responseId=responseId,options.modifiedTime=$content.attr("modifiedTime"),options.currResponseCount=$content.attr("currResponseCount");else{var targetParent=$content.parents("div.listOfResponseLink");options.responseId=targetParent.attr("responseId"),options.modifiedTime=targetParent.attr("modifiedTime"),options.currResponseCount=targetParent.attr("currResponseCount")}options.toProvide="First",options.currStage="1",doAjaxAction("/getResponse.do",options,function(data){var $data=$(data),$currResponseContent=$("#recent_ResPonse_"+responseId);$("#lastResponse_"+forumTopicId).find('div.listOfResponseLink[prev="-1"]').length<1&&($data.insertAfter($currResponseContent),lightBox("#"+$data.get(0).id),$currResponseContent.next("div.listOfResponseLink").attr("Prev","-1"));var $navLoading=$("#navigationLoading_"+responseId);"first"==$navLoading.attr("currRequest")?($navLoading.remove(),$currResponseContent.hide(),$("#navCont_"+responseId+",#navCont_1_"+responseId).removeClass("navLoading"),firstOrLastResponse($("#navCont_"+responseId).find("li.ndtopicNavFirst"))):provideResponse($content)})}function provideResponse($content){var forumTopicId=$content.parents('li[parentCont="actualParent"]').attr("forumTopicId"),responseId=$content.attr("recentResponseId"),toProvide=$content.attr("toProvide"),options={};if(options.forumGroupId=forumGroupId,options.forumTopicId=forumTopicId,options.toProvide=toProvide,void 0!==responseId)options.modifiedTime=$content.attr("modifiedTime"),options.currResponseCount=$content.attr("currResponseCount"),options.currStage=$content.attr("currResponsestage");else{var targetParent=$content.parents("div.listOfResponseLink");responseId=targetParent.attr("responseId"),options.modifiedTime=targetParent.attr("modifiedTime"),options.currResponseCount=targetParent.attr("currResponseCount"),options.currStage=targetParent.attr("currResponsestage")}options.responseId=responseId,doAjaxAction("/getResponse.do",options,function(data){var $currResponseContent=$("#recent_ResPonse_"+responseId),$this=$("<div>"+data+"</div>"),inputResponseId=$this.find("div.listOfResponseLink").attr("responseId"),inputResponseContent=$("#lastResponse_"+forumTopicId).find('div.listOfResponseLink[responseId = "'+inputResponseId+'"]');if(0<inputResponseContent.length)"Prev"==toProvide?($currResponseContent.attr("Prev",inputResponseId),inputResponseContent.attr("Next",responseId)):"Next"==toProvide&&($currResponseContent.attr("Next",inputResponseId),inputResponseContent.attr("Prev",responseId));else{var $data=$($this.html());if("Prev"==toProvide)$data.insertAfter($currResponseContent),lightBox("#"+$data.get(0).id),$currResponseContent.next("div.listOfResponseLink").attr("Next",responseId),$currResponseContent.attr("Prev",inputResponseId);else if("Next"==toProvide){$data.insertBefore($currResponseContent),$currResponseContent.prev("div.listOfResponseLink").attr("Prev",responseId),$currResponseContent.attr("Next",inputResponseId)}}var $navLoading=$("#navigationLoading_"+responseId);"Prev"==$navLoading.attr("currRequest")?($navLoading.remove(),$currResponseContent.hide(),checkPrevNextResponse($("#navCont_"+responseId).find("li.ndtopicNavPrev")),$("#navCont_"+responseId+",#navCont_1_"+responseId).removeClass("navLoading")):"Next"==$navLoading.attr("currRequest")&&($navLoading.remove(),$currResponseContent.hide(),checkPrevNextResponse($("#navCont_"+responseId).find("li.ndtopicNavNext")),$("#navCont_"+responseId+",#navCont_1_"+responseId).removeClass("navLoading"))})}function checkPrevNextResponse($content){var $contentParent=$content.parents("div.listOfResponseLink"),responseId=$contentParent.attr("responseId"),toProvide=$content.attr("toProvide"),currResponse=$contentParent.attr(toProvide);if("0"==currResponse){var $loading=$("#navigationLoading").clone();$loading.attr("id","navigationLoading_"+responseId).attr("currRequest",toProvide);var $navCont=$("#navCont_"+responseId);return $loading.insertAfter($navCont).show(),$("#navCont_"+responseId+",#navCont_1_"+responseId).addClass("navLoading"),void provideResponse($content)}var $newResponseCont=$("#recent_ResPonse_"+currResponse);$contentParent.hide(),$newResponseCont.show(),setFocusToContainer($newResponseCont.parents(".ndquickList"),!1,0),$("#navCont_"+currResponse).is(".navLoading")&&$("#navCont_"+responseId+",#navCont_1_"+responseId).removeClass("navLoading"),"0"==$newResponseCont.attr(toProvide)&&provideResponse($("#navCont_"+currResponse).find('li[toProvide="'+toProvide+'"]'))}function firstOrLastResponse($content){var $targetParent=$content.parents("div.listOfResponseLink"),toProvide=$content.attr("toProvide"),responseId=$targetParent.attr("responseId"),forumTopicId=$content.parents('li[parentCont="actualParent"]').attr("forumTopicId"),$responaseContainer=$("#lastResponse_"+forumTopicId),$currentOpenedResponse=$("#recent_ResPonse_"+responseId);if("First"==toProvide){var $firstResponse=$responaseContainer.find('div.listOfResponseLink[Prev="-1"]');if(0==$firstResponse.length){var $loading=$("#navigationLoading").clone();$loading.attr("id","navigationLoading_"+responseId).attr("currRequest","first");var $navCont=$("#navCont_"+responseId);return $loading.insertAfter($navCont).show(),$("#navCont_"+responseId+", #navCont_1_"+responseId).addClass("navLoading"),void getprevAndFirstPost($content)}$currentOpenedResponse.hide(),$firstResponse.show(),setFocusToContainer($("#eachTopic_"+forumTopicId),!1,0),$("#navCont_"+responseId).is(".navLoading")&&$("#navCont_"+responseId+",#navCont_1_"+responseId).removeClass("navLoading");var currResponse=$firstResponse.attr("responseId");if("0"==$firstResponse.attr("Next"))provideResponse($("#navCont_"+currResponse).find('li[toProvide="Next"]'))}else"Last"==toProvide&&($currentOpenedResponse.hide(),$responaseContainer.find('div.listOfResponseLink[Next="-1"]').show(),setFocusToContainer($("#eachTopic_"+forumTopicId),!1,0))}function lightBox(containerId){$(containerId).find("a.lightbox").lightbox({navbarOnTop:!0,resizeSpeed:150,overlayOpacity:.1,fitToScreen:!0}),$(window.document).keydown(function(e){if(27==e.keyCode)return $("#lightbox").is(":visible")&&($("#lightbox").hide(),$("#overlay").hide()),!1})}function saveButtonClick(id){var $this=$("#"+id),options={};options.forumGroupId=forumGroupId,options.referrer=$this.attr("referrer"),options.customFieldValue=$this.prev().val(),options[csrfParamName]=csrfToken,$.ajax({url:"/joinPortal.do",type:"POST",data:options,error:function(err,desc,exceptionobj){showTipper(err.responseText)},success:function(data){"success"==data?(showTipper(i18n["zohodiscussions.widgetscontainer.subscribedSuccessfully"],"success",1e3),$("#waitingforApproval,#portalWaitingforApproval").show(),$("#joinPortalContent,#portaljoinContent").hide()):"open"==data?window.location.reload():"customSignUp"==data&&(location.href=action)}})}function bindSubscribeAction(){$("#joinThisPortal,#portalJoin").unbind("click").click(function(){var options={};options.forumGroupId=forumGroupId,options.referrer="ajax",options[csrfParamName]=csrfToken;"1"==$(this).attr("isCustomFieldStatus")?($("#customFieldDiv,#customFieldWidgetDiv").show(),$("#portalJoin,#joinThisPortal").hide()):$.ajax({url:"/joinPortal.do",type:"POST",data:options,error:function(err,desc,exceptionobj){showTipper(err.responseText,"failure",1e3)},success:function(data){"success"==data?(showTipper(i18n["zohodiscussions.widgetscontainer.subscribedSuccessfully"],"success",1e3),$("#waitingforApproval,#portalWaitingforApproval").show(),$("#joinPortalContent,#portaljoinContent").hide()):"open"==data?window.location.reload():showTipper(i18n["zohodiscussions.widgetscontainer.failure"],"failure",1e3)}})}),$("#joinButtonClick,#portalJoinButtonClick").click(function(){$("#signInorSignUp,#portalsignInorSignUp").toggle(),$("#participateButtonClick,#portalparticipateButtonClick").toggle()}),$("#signInClick,#participateButtonClick").click(function(){"portalBut"==this.className&&$("#portalSignUpClick").attr("action",$(this).attr("action")),$("#iamLoginBox").show(),$("#joinPortalWidget,#portaljoinContent").hide();var currSrc=$(this).attr("src");$("#iamLoginBox iframe,#portaliamLoginBox iframe").attr("src",currSrc)}),$("#signUpClick,#portalSignUpClick,#portalSignUpClickPopup").click(function(){var action=$(this).attr("action");location.href=action})}function showall(cont,isCatg){return"show"==$("#showAll").attr("currentmode")?($("#"+cont).removeAttr("style"),$("#showAll").text(i18n["zohodiscussions.general.less"]),$("#showAll").attr("currentmode","hide")):("isCatg"==isCatg?$("#"+cont).attr("style","min-height:40px;max-height:170px;overflow:hidden;"):$("#"+cont).attr("style","min-height:40px;max-height:230px;overflow:hidden;"),$("#showAll").text(i18n["zohodiscussions.general.more"]),$("#showAll").attr("currentmode","show")),!1}function topiconClickActionNewTopic(forumId,forumTopicId,hash,topicPermaLink){return isEmbedService()&&void 0!==hash&&"newtopic"==hash?(isZIntranet?ZIntranet.loadTopic(forumId,forumTopicId):isSupportPortalCall?ZSupport.callForumEmbedSinglePost(topicPermaLink):ZSupport.callBackForumPost(forumId,forumTopicId),!1):!isTopicQuickView||(openSinglePost(forumTopicId),!1)}function topiconClickArrowAction(forumId,forumTopicId,defaultTopicView,topicPermalink){return topiconClickAction(forumId,forumTopicId,!defaultTopicView,topicPermalink),!1}function topiconClickAction(forumId,forumTopicId,defaultTopicView,topicPermaLink){return(void 0===defaultTopicView||defaultTopicView)&&(isEmbedService()?isZIntranet?ZIntranet.loadTopic(forumId,forumTopicId):isSupportPortalCall?ZSupport.callForumEmbedSinglePost(topicPermaLink,!0):ZSupport.callBackForumPost(forumId,forumTopicId):isTopicQuickView),!1}function topicHeaderForumDropDownClick(provideUrl,topicHeaderForumAction,forumId,categoryId,forumURL,categoryURL){return isEmbedService()?(void 0===categoryId&&(categoryId="-1"),void 0===forumId&&(forumId="-1"),forumClickAction(forumId,categoryId,"1",forumURL,categoryURL)):"true"!==provideUrl||(window.location.href=topicHeaderForumAction),!1}function topicListHeaderFilterAction(provideUrl,topicHeaderForumAction,forumId,categoryId,topicFilter,statusURL,forumURL,categoryURL){return isEmbedService()?(forumFilterClickAction(forumId,categoryId,topicFilter=topicFilter.toLowerCase(),statusURL,1,forumURL,categoryURL),!1):"true"==provideUrl&&void(window.location.href=topicHeaderForumAction)}function forumFilterClickAction(forumId,categoryId,topicType,topicFilter,fetchpage,forumURL,categoryURL){return forumURL=void 0===forumURL?"":forumURL,categoryURL=void 0===categoryURL?"":categoryURL,isEmbedService()&&(isZIntranet?ZIntranet.loadForum(forumId,topicType,topicFilter):isSupportPortalCall?ZSupport.callForumEmbedSingleForumTopics(forumURL,categoryURL,topicType,topicFilter,fetchpage,!0):ZSupport.callBackForumFilter(forumId,categoryId,topicType,topicFilter,fetchpage)),!1}function forumClickAction(forumId,categoryId,fetchpage,forumURL,categoryURL){return categoryId=null==categoryId?-1:categoryId,fetchpage=null==fetchpage?1:fetchpage,forumURL=void 0===forumURL?"":forumURL,categoryURL=void 0===categoryURL?"":categoryURL,isEmbedService()&&(isZIntranet?ZIntranet.loadForum(forumId):isSupportPortalCall?ZSupport.callForumEmbedSingleForumTopics(forumURL,categoryURL,"","",fetchpage,!0):ZSupport.callBackForumView(forumId,categoryId,fetchpage)),!1}function initTopicsPageActions(){lightBox("#chartWidget"),lightBox("#topicList"),bindTopicClicks($("#topicList")),bindTopicClicks($("#topicsList")),bindTopicListHeaderClicks($("#topicListHeader")),bindWidgetsContClick($("#topicListWidgetsCont")),setToHotkeys()}function newTopicCall(){initLoginFrame($("#NewTopicTab"))}function initLoginFrame($target){var $loginFrame=$("#loginFrame");hideLoadingImage();var iamLogin=$target.attr("iamURL");0<$loginFrame.size()&&($loginFrame.show().find("div.iFrameContainer").show().html('<iframe scrolling="no" frameborder="0" height="192px" src="'+iamLogin+'"></iframe>'),$("#iamLoginBox").hide());var $listof_FC_Counts=$("#listof_FC_Counts");$("#countOfForum").html($listof_FC_Counts.attr("forumCount")),$("#countOfCategory").html($listof_FC_Counts.attr("categoryCount")),$("#countOfPosts").html($listof_FC_Counts.attr("postCount")),$("#countOfResponses").html($listof_FC_Counts.attr("responseCount"));var $tploginforms=$("#tploginforms"),loginServiceUrl=$target.attr("loginURL"),loginIamUrl=$target.attr("iamURL");return $tploginforms.find('input[name="serviceurl"]').val(loginServiceUrl),$tploginforms.find('input[name="domain"]').val(loginIamUrl),!1}function loginBoxClose(){$("#iamLoginBox").show(),0<$("#joinPortalWidget").size()&&($("#joinPortalWidget").show(),$("#iamLoginBox").hide()),$("#loginFrame").hide(),initTopicsPageActions()}function signInViaGoogle(){return $("#tploginforms").find('form[name="googleform"]').submit(),!1}function signInViaYahoo(){return $("#tploginforms").find('form[name="yahooform"]').submit(),!1}function signInViaFacebook(){return $("#tploginforms").find('form[name="fbform"]').submit(),!1}function signInViaGoogleApps(){return $("#tploginforms").find('form[name="gappsform"]').submit(),!1}function forumGroupNameDecode(forumGroupName){for(var count=forumGroupName.split("&#39;").length-1,incr=0;incr<count;incr++)forumGroupName=forumGroupName.replace("&#39;","/'");return forumGroupName}function attachDocsIntegCallBackFn(params){if(void 0!==(params=params.replace(/\%20/g," "))){var eachparams=params.split("&");if(eachparams.length<3)return;for(var tempdocsIds=eachparams[0].split("docIds="),tempdocsNames=eachparams[1].split("docNames="),tempdocsService=eachparams[2].split("service="),docsIds=tempdocsIds[1].split(","),docsNames=tempdocsNames[1].split(","),docsService=tempdocsService[1].split(","),zDocIds=(docsIds.length,""),Concat="",i=0;i<docsIds.length;i++){var docs=docsIds[i],docName=docsNames[i],serviceName=docsService[i];docName.indexOf(".")<0&&("show"==serviceName?docName+=".ppt":"sheet"==serviceName?docName+=".xls":"writer"==serviceName&&(docName+=".doc")),zDocIds=zDocIds+Concat+docs+","+serviceName+","+docName+",false",Concat=":"}loadUploadAttachmentsCont(zDocIds,"attachZDocs")}}function zohoSupportSearch(searchFor,forumGroupId,forumId,categoryId){if(null==searchFor||""==searchFor.trim())return showMessage(i18n["zohodiscussions.searchList.noSearchString"],"failure"),void hideLoadingImage();var options={};options.forumGroupId=forumGroupId,null!=forumId&&""!=forumId&&(options.forumId=forumId),null!=categoryId&&""!=categoryId&&(options.categoryId=categoryId),options.searchFor=searchFor,doAjaxAction("/getSearchResult.do",options,function(data){hideLoadingImage();var $data=$("<div></div>");$data.get(0).innerHTML=data,$("#mainContent").get(0).innerHTML=data,bindSearchContentClick($("#mainContent")),showAuthorPopout($data),$("#searchInputBox").val(searchFor)},function(err){hideLoadingImage(),"REMOTE_IP_LOCKED"===toEvaluateData(err.responseText).errorcode&&showMessage(i18n["zohodiscussions.generalmessage.tryagainaftersometime"],"failure")})}function UpdateCursorPosition(e){cX=e.pageX,cY=e.pageY}function UpdateCursorPositionDocAll(e){cX=event.clientX,cY=event.clientY}function HideTags(d){d.length<1||(document.getElementById(d).style.display="none")}function tagOnLoad(d){document.all?document.onmousemove=UpdateCursorPositionDocAll:document.onmousemove=UpdateCursorPosition,showDiscussionsManageTags(d)}function showDiscussionsManageTags(d){if(!(d.length<1)){var dd=document.getElementById(d);AssignPosition(dd),dd.style.display="block"}}function AssignPosition(d){self.pageYOffset?(rX=self.pageXOffset,rY=self.pageYOffset):document.documentElement&&document.documentElement.scrollTop?(rX=document.documentElement.scrollLeft,rY=document.documentElement.scrollTop):document.body&&(rX=document.body.scrollLeft,rY=document.body.scrollTop),document.all&&(cX+=rX,cY+=rY),d.style.left=cX+10+"px",d.style.top=cY+10+"px"}function getUsersStartingWith(nameStartsWith){discussionsFunctions.users("Users",1,nameStartsWith)}function updateUserScreenName(attr){var $userNameChangeDialog=$(attr),options={};options.forumGroupId=forumGroupId,options.zuid=$userNameChangeDialog.find(':input[name="zuid"]').val();var screenName=$.trim($userNameChangeDialog.find(':input[name="screenName"]').val()),message="";""!==screenName&&null!==screenName?screenName.match("^[^-!$%^&*()@+\\\\|#~=`{}\\[\\]:\";'<>?,\\/]{4,50}$")?($userNameChangeDialog.find(':input[name="update"]').attr("disabled","true"),$userNameChangeDialog.find(':input[name="update"]').attr("value",i18n["zohodiscussions.myArea.screenName.Update"]),options.screenName=screenName,options[csrfParamName]=csrfToken,doAjaxAction("/updateScreenName.do",options,function(data){var responseData=toEvaluateData(data);message=responseData.reason,displayScreenMessage(attr,message,responseData.result),"success"===responseData.result&&location.reload(),$userNameChangeDialog.find(':input[name="update"]').removeAttr("disabled"),$userNameChangeDialog.find(':input[name="update"]').attr("value",i18n["zohodiscussions.buttons.save"])},function(err){var responseData=toEvaluateData(err.responseText),reason=responseData.reason;"REMOTE_IP_LOCKED"===responseData.errorcode?reason="zohodiscussions.generalmessage.tryagainaftersometime":"PATTERN_NOT_MATCHED"===responseData.errorcode?reason="zohodiscussions.myArea.screenNameValid":$userNameChangeDialog.find(':input[name="update"]').removeAttr("disabled"),$userNameChangeDialog.find(':input[name="update"]').attr("value",i18n["zohodiscussions.buttons.save"]),displayScreenMessage(attr,reason)})):displayScreenMessage(attr,message="zohodiscussions.myArea.screenNameValid","failure"):displayScreenMessage(attr,message="zohodiscussions.myArea.screenNameEmpty")}function checkScreenNameAvailablity(attr){var $userNameChangeDialog=$(attr),options={};options.forumGroupId=forumGroupId,options.zuid=$userNameChangeDialog.find(':input[name="zuid"]').val();var screenName=$.trim($userNameChangeDialog.find(':input[name="screenName"]').val()),message="";""!==screenName&&null!==screenName?screenName.match("^[^-!$%^&*()@+\\\\|#~=`{}\\[\\]:\";'<>?,\\/]{4,50}$")?(options.screenName=screenName,options[csrfParamName]=csrfToken,doAjaxAction("/screenNameAvailablity.do",options,function(data){var responseData=toEvaluateData(data);message=responseData.reason,displayScreenMessage(attr,message,responseData.result)},function(err){$userNameChangeDialog.find(':input[name="update"]').removeAttr("disabled"),$userNameChangeDialog.find(':input[name="update"]').attr("value",i18n["zohodiscussions.buttons.save"]);var responseData=toEvaluateData(err.responseText),reason=responseData.reason;"REMOTE_IP_LOCKED"===responseData.errorcode?reason="zohodiscussions.generalmessage.tryagainaftersometime":"PATTERN_NOT_MATCHED"===responseData.errorcode&&(reason="zohodiscussions.myArea.screenNameValid"),displayScreenMessage(attr,reason)})):displayScreenMessage(attr,message="zohodiscussions.myArea.screenNameValid","failure"):displayScreenMessage(attr,message="zohodiscussions.myArea.screenNameEmpty","failure")}function displayScreenMessage(attr,message,reason){var $errorText,$userNameChangeDialog=$(attr);message=i18n[message],$errorText=$userNameChangeDialog.find('span[purpose="showMsg"]'),"success"!==reason?(reason="failure",$errorText.removeClass("screenGreenMarkText").addClass("redMarText")):$errorText.removeClass("redMarText").addClass("screenGreenMarkText"),$userNameChangeDialog.find("a.greenLink").hide(),$errorText.show(),$errorText.text(message)}function gettingstarted(pageNum,loaded,isSkipped,forumGroupId,serviceurl){var options={};options.pageNum=pageNum,options.loaded=loaded,options.isSkipped=isSkipped,options.forumGroupId=forumGroupId,options.serviceurl=void 0!==serviceurl?serviceurl:serverURL,doAjaxAction("/gettingStarted.do",$.param(options,!0),function(data){$(".topWhiteBorder").width("95%"),$(".topWhiteBorder").html(data),gettingstartedSteps()})}function openSinglePost(forumTopicId,givenHashKey,recentResponseId){givenHashKey=givenHashKey||"Topic",null!=recentResponseId?loadSinglePost(forumTopicId,"true",void 0,recentResponseId):loadSinglePost(forumTopicId),isZIntranet||isZSupport||$.history.add(givenHashKey+"/"+forumTopicId)}function loadSinglePost(forumTopicId,shouldScrollToTop,goHere,recentResponseId,isSpam){if(isNaN(forumTopicId)){var param={requestedUrlPurpose:"pageAccess"};doAjaxAction("/errorInfo.do",param,function(errorData){$("body").get(0).innerHTML=errorData,document.title="Requested url not found"})}else{var options={};options.forumTopicId=forumTopicId,options.forumGroupId=forumGroupId,"spamReported"==isSpam&&(options.isSpamReported=!0),void 0===shouldScrollToTop&&(shouldScrollToTop=!0),isThreadSorting&&(options.sortThreads=$("#SinglePostContainer").attr("sortThread")),doAjaxAction("/getSinglePost.do",options,function(data){if(hideLoadingImage(),1==data.indexOf('"result":"failure"')){var param={requestedUrlPurpose:"pageAccess"};doAjaxAction("/errorInfo.do",param,function(errorData){$("body").get(0).innerHTML=errorData,document.title="Requested url not found"})}else if(1==data.indexOf('"result":"portalLogin"')){var responseData=$.parseJSON(data);return void(window.location.href="/portalLogin.do?forumGroupUrl="+responseData.sURL+"&serviceurl=/"+responseData.sURL)}if(0<$("#topicListMainContainer").length||0<$("#userProfileMainContainer").length||0<$("#myAreaParentContainer").length)if($("#topicListMainContainer").hide().attr("shouldReload","false"),$("#userProfileMainContainer").hide().attr("shouldReload","false"),$("#myAreaParentContainer").hide().attr("shouldReload","false"),0<$("#SinglePostContainer").length)$("#mainContent").get(0).innerHTML=data,$(window).scrollTop(0);else{var singlePostCont=document.createElement("div");singlePostCont.innerHTML=data,$("#mainContent").get(0).appendChild(singlePostCont)}else $("#mainContent").get(0).innerHTML=data;if(shouldScrollToTop&&1==shouldScrollToTop?$(window).scrollTop(0):shouldScrollToTop&&"showWatchOption"==shouldScrollToTop&&$("#followTopic_"+recentResponseId).show(),void 0!==goHere){var topDiff=$(goHere).offset().top;$("html,body").scrollTop(topDiff-100)}initSinglePost(forumTopicId);var $singlePostCont=$("#topicContainer_"+forumTopicId),forumId=$singlePostCont.attr("forumId"),categoryId=$singlePostCont.attr("categoryId");void 0===forumId&&(forumId=-1),void 0===categoryId&&(categoryId=-1);var hashPurpose="NewTopic/"+forumId+"/"+categoryId;($("#NewTopicTab").attr("hashPurpose",hashPurpose),"undefined"!=typeof WmsContacts&&"true"==ch)&&setPresenceInTopicList(WmsContacts.getZohoContacts(),forumTopicId);null!=recentResponseId&&void 0===goHere&&(setFocusToContainer($("#fullResponseContainer_"+recentResponseId),!1,100,0),$("#SinglePostContainer").data("currentFocusResponse",$("#"+recentResponseId))),"false"==isMac&&setHotkeysToSinglePost()},function(errordata){hideLoadingImage();var responseData=errordata.responseText;$("#mainContent").get(0).innerHTML=responseData})}}function initSinglePost(forumTopicId){showAuthorPopout($("#SinglePostContainer")),forumGroupName=forumGroupNameDecode(forumGroupName);var $documentTitle=$("#DocumentTitle");if(isZIntranet&&isThreadSorting){var styleStr="<style>.discussionsimgDownArrow{background:url('"+zohoStaticUrl+"/images/singlepostSprite.png')  -7px -3px no-repeat;width:8px;height:10px;cursor:pointer;margin:4px 2px 0 0;transform: rotate(180deg);-ms-transform: rotate(180deg);-webkit-transform: rotate(180deg);-o-transform: rotate(180deg);-moz-transform: rotate(180deg);}</style>";jQuery("head").append(styleStr)}isEmbedService()||(document.title=0<$documentTitle.length?$documentTitle.text()+" - "+forumGroupName:forumGroupName),bindSingleTopicClicks($("#SinglePostContainer")),lightBox("#SinglePostContainer");$("#topicContainer_"+forumTopicId);return $("#SinglePostContainer").unbind("click",singlePostWidgetActions).click(singlePostWidgetActions),singlePostTagActions(forumTopicId),$("#mainContent").attr("process-pre-tags",forumTopicId),setTimeout(function(){processCodeTags($("#SinglePostContainer"),forumTopicId)},5),!1}function showCode(codeNode){var toUnFormat=codeNode.parentNode.nextSibling.innerHTML;toUnFormat=toUnFormat.replace(/<\/li>/gi,"\n").replace(/<[^>]*>/gi,"").replace(/&nbsp;/gi," ").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&amp;/gi,"&"),$("#CopyCodeCont").show().parent().show(),$("#copycode_text").val(toUnFormat).select()}$(window.document).click(function(event){$("#switchToProductOptions,#changePortalOptions");var $dropDownConts=$("#zdstatusList,#typeFilterOptions"),$target=$(event.target),$targetparent=$target.parent();if($target.is('[purpose="linkForDropDown"]')||$targetparent.is('[purpose="linkForDropDown"]')||$target.is("#zdstatusInfo")||$targetparent.is("#zdstatusContainer")||$target.is("#zdstatusContainer")){var dropDownPurpose=$target.attr("dropDownLinkPurpose");return dropDownPurpose=dropDownPurpose||$targetparent.attr("dropDownLinkPurpose"),$dropDownConts.each(function(index,item){var $item=$(item);void 0===dropDownPurpose&&$item.is("#zdstatusList")?(0<$("#zdstatusInfo").find("div.statuschanges").length||$("#zdstatusContainer").find("b.imgdownArrow"))&&($("#zdstatusList").is(":visible")?$item.hide():$item.show()):$item.is('div[dropDownPurpose!="'+dropDownPurpose+'"]:visible')&&($item.hide(),$item.parent(".newComboSelected").addClass("newCombo").removeClass("newComboSelected"))}),!1}$dropDownConts.parent(".newComboSelected").addClass("newCombo").removeClass("newComboSelected")}),$(window.document).keypress(function(e){var $dropDownConts=$("#zdstatusList,#typeFilterOptions,#privateConversation"),$conboCont=$("#portalComboCont");if(27==e.keyCode)return $("#messageContainer").hide(),$("#authorPopout:visible").hide(),$('#PopupContainer div.dimDiv:visible button:visible[purpose="closePopout"]').trigger("click"),$('#PopupContainer div.dimDiv:visible div:visible[purpose="imgCancel"]')&&$("#imgCancel").trigger("click"),$dropDownConts.is(":visible")&&$dropDownConts.hide(),$conboCont.is(".newComboSelected")&&$conboCont.addClass("newCombo").removeClass("newComboSelected"),$("#privateMsgPrompt").is(":visible")&&$("#privateMsgPrompt").parent().hide(),$("#inappropriateReason").is(":visible")&&$("#inappropriateReason").hide(),!1}),discussionsFunctions.users=function(givenKey,fetchPage,nameStartsWith){var options={};options.purpose="Users",options.forumGroupId=forumGroupId,options.forumId=-1,options.fetchPage=fetchPage,options.nameStartsWith=nameStartsWith,bindTopicClicks($("#topicList")),bindTopicClicks($("#topicsList")),doAjaxAction("/Users.do",options,function(data){hideLoadingImage(),document.title="Users",$.history.add("Users"),$("#mainContent").get(0).innerHTML=data;var $iframeLogin=$("#iamLoginBox").find("iframe"),currSRC=$iframeLogin.attr("src");$iframeLogin.attr("src",currSRC),lightBox("#chartWidget"),bindWidgetsContClick($("#topicListWidgetsCont")),goToTop();var $listof_FC_Counts=$("#listof_FC_Counts");($("#countOfForum").html($listof_FC_Counts.attr("forumCount")),$("#countOfCategory").html($listof_FC_Counts.attr("categoryCount")),$("#countOfPosts").html($listof_FC_Counts.attr("postCount")),$("#countOfResponses").html($listof_FC_Counts.attr("responseCount")),"undefined"!=typeof WmsContacts&&"true"===ch)&&setPresenceInTopicList(WmsContacts.getZohoContacts());return!1})};var codeForPreview='<div class="__zd_findAndReplaceParent" style="height:11px"></div><div class = "__zd_findAndReplace" style="text-align:right;float:right;background-color:#efefef;margin-right:30px;padding:0px 3px;"><span id="showCopyCode" onclick = "javascript:showCode(this);return false;" style="font:normal 10px trebuchet ms,arial;text-decoration:underline;color:blue;cursor:pointer">Copy code</span></div>';function processCodeTags($codeTagContainer,passKey){if(passKey&&$codeTagContainer&&!($codeTagContainer.length<1)&&$("#mainContent").attr("process-pre-tags")==passKey){$codeTagContainer.find("ol.code").before(codeForPreview);for(var copyNode=$("#mainContent #showCopyCode"),codecounter=0;codecounter<copyNode.length;codecounter++){""==copyNode[codecounter].parentNode.nextSibling.innerHTML&&(copyNode[codecounter].parentNode.previousElementSibling.remove(),copyNode[codecounter].parentNode.remove())}}}function bindSingleTopicClicks($context){$context.unbind("click",processSingleTopicClicks).click(processSingleTopicClicks);var forumTopicId=$("#SinglePostContainer").attr("forumTopicId"),$this=$("#replyToTopicBtn_"+forumTopicId),replyContainer=$this.attr("replyContainer");"true"==$this.attr("canUserReplyThis")&&"true"==replyContainer&&$("#replyToTopicBtn_"+forumTopicId).find("div.imgReply").trigger("click")}function processSingleTopicClicks(event){var $target=$(event.target),$targetParent=$target.parent(),forumTopicId=$("#SinglePostContainer").attr("forumTopicId"),$topicContainer=$("#topicContainer_"+forumTopicId),$dropDownConts=$("#zdstatusList");if("threadSorting"===$target.attr("purpose")){if(""===$target.attr("style"))return!1;var options={},sortingOrder=$target.attr("sortingOrder");options.forumGroupId=forumGroupId,options.forumTopicId=forumTopicId,options.sortThreads=sortingOrder,$("#SinglePostContainer").attr("sortThread",sortingOrder),doAjaxAction("/getSortedThread.do",options,function(data){loadNewPost("/getSortedThread.do",data,forumTopicId)})}if(!$("#loadingImg").is(":visible")){if($target.is('a[id="attachmentViewPermission"]')&&-1==ZUID){var iamLogin=$target.attr("iamURL");$("#loginFrame").show().find("div.iFrameContainer").show().html('<iframe scrolling="no" frameborder="0" height="192px" src="'+iamLogin+'"></iframe>')}if($target.is('a[purpose="authorProfile"]')){var authorName=$target.attr("authorName");"0"==$target.attr("singleClickflag")&&processHash(authorName==screenName||authorName==encodedScreenName?"MyArea":"User/"+authorName)}else{if($target.is("#replyToTopicBtn_"+forumTopicId+",#replyToTopicBtnSec_"+forumTopicId)||$targetParent.is("#privateResponseThisTopic_"+forumTopicId)){var postauthor=$target.attr("postauthor"),$topicUtilContainer=$("#paginationContainer"),canUserReplyThis=$target.attr("canUserReplyThis"),replyContainer=$target.attr("replyContainer");if("undefined"!=canUserReplyThis&&"false"==canUserReplyThis)return void initLoginFrame($target,replyContainer);if(0<$("#topicListMainContainer").length&&0<$("#SinglePostContainer").length&&$topicUtilContainer.data("inEditMode")&&removeTopicListCache(),$("#responsePreviewContainer").is(":visible")){$("#responsePreviewContainer").find('button[purpose="backToEditorResponse"]').trigger("click"),showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"info");var openedEditorLcation=$topicContainer.data("editorContLocation");return void setFocusToContainer($(openedEditorLcation),!1)}var replyLink="replyToTopicBtn",isPrivateRes="false";$targetParent.is('[purpose="privateResponse"]')&&(replyLink="privateResponseThisTopic",isPrivateRes="true");var newResponseLocation="#newResponseCont_"+forumTopicId;if($topicContainer.data("inEditMode")){showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"]),$("#responsePreviewButton").find('button[purpose="backToEditorResponse"]').trigger("click");openedEditorLcation=$topicContainer.data("editorContLocation");return setFocusToContainer($(openedEditorLcation),!1),!1}return $(newResponseLocation).show(),newOpenEditor($("#newResponse_"+forumTopicId),"responseContent","postContentTA",replyLink+"_"+forumTopicId,"Write","topicContainer_"+forumTopicId,isPrivateRes),setFocusToContainer($(newResponseLocation),!1),$topicContainer.data("inEditMode",!0),$topicContainer.data("editorContLocation",newResponseLocation),$("#previewResponse").attr("forumTopicId",forumTopicId),$(this).is('[purpose="privateResponse"]')&&$("#newResponseCont_"+forumTopicId).find("div.header").html(i18n["zohodiscussions.singlePost.editorHeaderPrivateResponseTo"]+" "+postauthor),!1}if($target.is("#TopicListLink,#ForumTopicListLink,#CategoryTopicListLink,#singlePostForumLink")){if($this=$target,hashPurpose=$this.attr("hashPurpose"),$("#topicListMainContainer").attr("shouldReload","true"),null!=hashPurpose)return processHash(hashPurpose),!1}else if($target.is("#topicVoteLink")||$targetParent.is("#topicVoteLink")){var $this=$target.is("#topicVoteLink")?$target:$targetParent,responseId=$("#topicVoteLink").attr("firstResponseId");if(-1==ZUID)return void showTipper(i18n["zohodiscussions.singlepost.logintovotetopic"],"failure");if("true"==$this.attr("isThisUserVoted"))return void showTipper(i18n["zohodiscussions.singlepost.alreadyVotedTopic"],"failure");showLoadingImage(i18n["zohodiscussions.general.updating"]),doAjaxAction("/voteTopic.do?forumGroupId="+forumGroupId+"&forumTopicId="+forumTopicId+"&responseId="+responseId,csrfOptions,function(data){if("SUCCESS"==data){showTipper(i18n["zohodiscussions.singlepost.votedresponse"],"success"),removeTopicListCache();var voteCount=parseInt($("#topicVoteLink").attr("responseVoteCount"))+1,voteTitle=$("#topicVoteLink").attr("votemessage");voteTitle=voteTitle.substring(1,voteTitle.length),$("#topicVoteLink").attr("title",voteCount+" "+voteTitle),0<$("#topicVoteLink > span").length?$("#topicVoteLink > span").html(voteCount):$("#topicVoteLink").append("<span class='flLeft'>"+voteCount+"</span>"),hideLoadingImage()}else hideLoadingImage(),showTipper(i18n["zohodiscussions.singlepost.alreadyVotedTopic"],"failure")})}else if($target.is("input[followItem]")){"true"==$target.attr("followItem")&&watchThisItem($target,"singlePost",event)}else{if($targetParent.is("#topicPermalink")){var thisTopicPermalink=$targetParent.attr("thisTopicPermalink");return $("#PermalinkCont textarea").val(thisTopicPermalink),$("#permalink_Text").select(),void $("#PermalinkCont").show().parent().show()}if($targetParent.is("#linkToTopic"))linkToTopic();else if($target.is("#deleteLinkedTopic"))deletelinkedTopic($target);else if($target.is('a[purpose="linkedTopicTitle"]')){if("false"!=isTopicQuickView)return processHash("Topic/"+(forumTopicId=$target.attr("forumTopicId"))),!1}else{if($target.is('input[purpose="watchAction"]')){var $isFollowTopicCont=$("#editorHolder").find('input[name="isFollowTopic"]');return void($target.is(":checked")||1==$target.attr("checked")||"true"==$target.attr("checked")?$isFollowTopicCont.attr("value","true"):$isFollowTopicCont.attr("value","false"))}if($targetParent.is("#emailThisTopic"))return openEmailTopicDialog($targetParent),!1;if($targetParent.is('li[actionPurpose="reportSpam"],div[actionPurpose="reportSpam"]')||$target.is('a[actionPurpose="reportSpam"]'))return void singlePostSpamAction($target.is('a[actionPurpose="reportSpam"]')?$target:$targetParent,"singlePost");if($targetParent.is('div[buttonPurpose="approve"]')||$targetParent.is('li[buttonPurpose="approve"]')||$target.is('a[buttonPurpose="approve"]'))return void singlePostApproveAction($target.is('a[buttonPurpose="approve"]')?$target:$targetParent,"singlePostApprove");if($target.is('div[purpose="inappropriateReason"]')||$target.is('span[purpose="inappropriateReason"]'))getReasonForInapppropriate($target);else{if($targetParent.is('span[deletepurpose="deleteAttachment"]'))return void deletePublishedAttachment($targetParent,event);if($target.is('li[purpose="topicLabel"]'))changeTopicLabel($target);else{var topicAuthorId=$topicContainer.attr("topicAuthorId"),thisForumId=$topicContainer.attr("forumId"),thisCategoryId=$topicContainer.attr("categoryId"),$singlePostUtilCont=$("#singlePostUtilCont"),newThreadReplyLinks=$singlePostUtilCont.attr("newThreadReplyLinks");if($target.is(newThreadReplyLinks)){forumTopicId=($this=$target).attr("forumTopicId");var thisResponseId=$this.attr("responseId"),isPrivate=$this.attr("isPrivate"),newThreadResponseLocation="#newThreadResponseCont_"+thisResponseId;$topicUtilContainer=$("#paginationContainer");if(0<$("#topicListMainContainer").length&&0<$("#SinglePostContainer").length&&$topicUtilContainer.data("inEditMode")&&removeTopicListCache(),$("#responsePreviewContainer").is(":visible")){$("#responsePreviewContainer").find('button[purpose="backToEditorResponse"]').trigger("click"),showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"info");openedEditorLcation=$topicContainer.data("editorContLocation");return void setFocusToContainer($(openedEditorLcation),!1)}if($topicContainer.data("inEditMode")){showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"info"),$("#responsePreviewButton").find('button[purpose="backToEditorResponse"]').trigger("click");openedEditorLcation=$topicContainer.data("editorContLocation");return setFocusToContainer($(openedEditorLcation),!1),!1}return $(newThreadResponseLocation).show(),newOpenEditor($("#newThreadResponse_"+thisResponseId),"responseContent","postContentTA","newThreadReply_"+thisResponseId,"Write","topicContainer_"+forumTopicId,isPrivate),setFocusToContainer($(newThreadResponseLocation),!1),$topicContainer.data("inEditMode",!0),$topicContainer.data("editorContLocation",newThreadResponseLocation),$("#previewResponse").attr("forumTopicId",forumTopicId),$("#previewResponse").attr("responseId",thisResponseId),!1}var responseVoteLinks=$singlePostUtilCont.attr("responseVoteLinks");if($target.is(responseVoteLinks)){thisResponseId=($this=$target).attr("responseId");var purpose=$this.attr("votePurpose");return"removeVote"==purpose?void showTipper(i18n["zohodiscussions.singlepost.alreadyVotedResponse"],"failure"):(showLoadingImage(i18n["zohodiscussions.general.updating"]),void doAjaxAction(("removeVote"==purpose?"/removeResponseVote.do":"/voteResponse.do")+"?forumGroupId="+forumGroupId+"&responseId="+thisResponseId+"&forumTopicId="+forumTopicId,csrfOptions,function(data){if("SUCCESS"==data){showTipper(i18n["zohodiscussions.singlepost.votedresponse"],"success"),removeTopicListCache();var voteCount=parseInt($("#resposeVoteLink_"+thisResponseId).attr("responseVoteCount"))+1,voteTitle=$("#postActions_"+thisResponseId+" > .commentLikeButtion").attr("votemessage");voteTitle=voteTitle.substring(2,voteTitle.length),$("#postActions_"+thisResponseId+" > .commentLikeButtion").attr("title",voteCount+" "+voteTitle),$("#postActions_"+thisResponseId+" > .commentLikeButtion > span").html(voteCount),$("#resposeVoteLink_"+thisResponseId).attr("votePurpose","removeVote")}else hideLoadingImage()}))}var chooseBestResponseLinks=$singlePostUtilCont.attr("chooseBestResponseLinks");if($target.is(chooseBestResponseLinks)){showLoadingImage(i18n["zohodiscussions.general.updating"]);thisResponseId=($this=$target).attr("responseId");return(options={}).forumGroupId=forumGroupId,options.responseId=thisResponseId,options.forumTopicId=forumTopicId,topicAuthorId==ZUID&&(options.topicowner="true"),options[csrfParamName]=csrfToken,isThreadSorting&&(options.sortThreads=$("#SinglePostContainer").attr("sortThread")),void doAjaxAction("/bestResponse.do",options,function(data){removeTopicListCache(),showTipper(i18n["zohodiscussions.singlepost.bestResponseSuccessMsg"],"success"),loadNewPost("/bestResponse.do",data,forumTopicId),(options={}).forumGroupId=forumGroupId,options.forumTopicId=forumTopicId,options[csrfParamName]=csrfToken,doAjaxAction("/notifyForBestResponse.do",options,function(){})},function(errordata){hideLoadingImage(),showMessage(i18n["zohodiscussions.generalmessage.noPermission"])})}var responseEditLinks=$singlePostUtilCont.attr("responseEditLinks");if($target.is(responseEditLinks)){var editLinkId=$target.attr("id"),editResponseLocation=(thisResponseId=($this=$target).attr("responseId"),isPrivate=$this.attr("isPrivate"),"#fullResponseContainer_"+thisResponseId);$topicUtilContainer=$("#paginationContainer");if(0<$("#topicListMainContainer").length&&0<$("#SinglePostContainer").length&&$topicUtilContainer.data("inEditMode")&&removeTopicListCache(),$("#responsePreviewContainer").is(":visible")){$("#responsePreviewContainer").find('button[purpose="backToEditorResponse"]').trigger("click"),showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"info");openedEditorLcation=$topicContainer.data("editorContLocation");return void setFocusToContainer($(openedEditorLcation),!1)}if($topicContainer.data("inEditMode")){showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"info");openedEditorLcation=$topicContainer.data("editorContLocation");return $("#responsePreviewButton").find('button[purpose="backToEditorResponse"]').trigger("click"),setFocusToContainer($(openedEditorLcation),!1),!1}return $(editResponseLocation).show(),"editTopic"==editLinkId&&($("#linkTopicCont_"+forumTopicId).hide(),$("#zdstatusContainer").hide()),newOpenEditor($("#responseContentContainer_"+thisResponseId),"responseContent","postContentTA",editLinkId,"Edit","topicContainer_"+forumTopicId,isPrivate),setFocusToContainer($(editResponseLocation),!1),$topicContainer.data("inEditMode",!0),$topicContainer.data("editorContLocation",editResponseLocation),$("#previewResponse").attr("responseId",thisResponseId),"postContent"==$(editResponseLocation).attr("class")||"editTopic"==editLinkId?$("#previewResponse").attr("location","editTopic"):$("#previewResponse").attr("location","editResponse"),$("#previewResponse").attr("forumTopicId",forumTopicId),!1}if($target.is("#removeBestResponse"))return showLoadingImage(i18n["zohodiscussions.general.updating"]),(options={}).forumGroupId=forumGroupId,options.forumTopicId=forumTopicId,topicAuthorId==ZUID&&(options.topicowner="true"),options[csrfParamName]=csrfToken,isThreadSorting&&(options.sortThreads=$("#SinglePostContainer").attr("sortThread")),void doAjaxAction("/removeBestResponse.do",options,function(data){removeTopicListCache(),showTipper(i18n["zohodiscussions.singlePost.removeBestResponseMsg"],"info"),loadNewPost("/removeBestResponse.do",data,forumTopicId)},function(errordata){hideLoadingImage(),showMessage(i18n["zohodiscussions.generalmessage.noPermission"])});if($target.is("#deleteTopic")){showLoadingImage(i18n["zohodiscussions.general.deleting"]);var deleteTopicOptions={};return topicAuthorId==ZUID&&(deleteTopicOptions.access="author"),deleteTopicOptions.forumGroupId=forumGroupId,deleteTopicOptions.forumTopicId=forumTopicId,deleteTopicOptions.categoryId=thisCategoryId,deleteTopicOptions.forumId=thisForumId,deleteTopicOptions[csrfParamName]=csrfToken,void doAjaxAction("/deleteTopic.do",deleteTopicOptions,function(data){"SUCCESS"==jQuery.trim(data)&&(removeTopicListCache(),showTipper(i18n["zohodiscussions.generalmessage.topicMovedToTrash"],"info"),isEmbedService()?forumClickAction(thisForumId):processHash("Home"))},function(errordata){})}var responseDeleteLinks=$singlePostUtilCont.attr("responseDeleteLinks");if($target.is(responseDeleteLinks)){showLoadingImage(i18n["zohodiscussions.general.deleting"]);thisResponseId=($this=$target).attr("responseId");var deleteResponseOptions={};return $this.attr("responseAuthorId")==ZUID&&(deleteResponseOptions.responseowner="true"),deleteResponseOptions.forumGroupId=forumGroupId,deleteResponseOptions.forumTopicId=forumTopicId,deleteResponseOptions.categoryId=thisCategoryId,deleteResponseOptions.forumId=thisForumId,deleteResponseOptions.responseId=thisResponseId,deleteResponseOptions[csrfParamName]=csrfToken,$("#fullResponseContainer_"+thisResponseId).hide(),hideLoadingImage(),doAjaxAction("/deleteForumResponse.do",deleteResponseOptions,function(data){"SUCCESS"==data&&(removeTopicListCache(),showTipper(i18n["zohodiscussions.generalmessage.responseMovedToTrash"],"info"),loadSinglePost(forumTopicId,"true",void 0,void 0,"spamReported"))},function(errordata){}),!1}}}}}$dropDownConts.hover(function(){var handle=$dropDownConts.data("destroyHandle");handle&&clearTimeout(handle)},function(){var handle=setTimeout(function(){$dropDownConts.hide()},500);$dropDownConts.data("destroyHandle",handle)})}}}function getReasonForInapppropriate($this){if("true"==moderatorForSpam){showLoadingImage();var responseId=$this.attr("responseId"),options={};options.forumGroupId=forumGroupId,options.responseId=responseId,options[csrfParamName]=csrfToken,doAjaxAction("/getInappropriateReason.do",options,function(data){hideLoadingImage(),$("<div></div>").html(data).is("#noInappropriateReason")&&showMessage(i18n["zohodiscussions.inappropriate.NoReasonForInappropriate"],"failure");var $inappropriateReason=$("#inappropriateReason");$inappropriateReason.html(data).show(),$("#inappropriateReasonClose").click(function(){$inappropriateReason.html("").hide()})})}}function linkToTopic(){$("#linkToTopicTemplate").html($("#dimDivLinkTO").html()),$("#dimDivLinkTO").html(""),$("#linkToTopicTemplate").show(),$("#linkTopicUrl").focus(),$("#cancelLinkTo").click(function(){$this=$(this),$("#dimDivLinkTO").html($("#linkToTopicTemplate").html()),$("#linkToTopicTemplate").hide(),$("#linkToTopicTemplate").html("")}),$("#saveLinkToTopic").click(function(){showLoadingImage(i18n["zohodiscussions.general.deleting"]),$this=$(this);var currentTopicId=$this.attr("currentTopicId"),linkToTopicUrl=$("#linkTopicUrl").val();if(""!=jQuery.trim(linkToTopicUrl))if((linkToTopicUrl=$.trim(linkToTopicUrl)).match("^(ht|f)tp(s?)://[0-9a-zA-Z]([-.w]*[0-9a-zA-Z])*(:(0-9)*)*(/?)([a-zA-Z0-9-.?,:'/\\+=&amp;%$#_]*)?$"))if(-1<linkToTopicUrl.indexOf("#Topic/")||-1<linkToTopicUrl.indexOf("?ftid=")||linkToTopicUrl.indexOf("/topic/")){var options={};options.forumGroupId=forumGroupId,options.currentTopicId=currentTopicId,options.forumTopicId=currentTopicId,options.linkToTopicUrl=linkToTopicUrl,options[csrfParamName]=csrfToken,isThreadSorting&&(options.sortThreads=$("#SinglePostContainer").attr("sortThread")),doAjaxAction("/addLinkToTopic.do",options,function(data){if(0<data.indexOf("'result':'failure'")){var message=toEvaluateData(data).reason;showTipper(i18n[message],"failure")}else"FAILURE"===data||""===data?showTipper(i18n["zohodiscussions.singlePost.requestedURLnotfoundMessage"],"failure"):(removeTopicListCache(),loadNewPost("/addLinkToTopic.do",data,currentTopicId),showTipper(i18n["zohodiscussions.singlepost.topicLinkedSuccessMessage"],"success"),$("#linkToTopicTemplate").hide())})}else showTipper(i18n["zohodiscussions.settings.PleaseEnteraValidurl"],"failure");else showTipper(i18n["zohodiscussions.settings.PleaseEnteraValidurl"],"failure");else showMessage(i18n["zohodiscussions.createforumgroup.LinkEmpty"],"failure")})}function deletelinkedTopic($this){var forumTopicId=$this.attr("currentTopicId"),linkedTopicId=$this.attr("linkedTopicId"),location=$this.attr("location"),options={};options.forumGroupId=forumGroupId,options.forumTopicId=forumTopicId,options.linkedTopicId=linkedTopicId,options[csrfParamName]=csrfToken,isThreadSorting&&(options.sortThreads=$("#SinglePostContainer").attr("sortThread")),confirm(i18n["zohodiscussions.singlepost.removeLinkConfirmationMess"])&&doAjaxAction("/deleteLinkedTopic.do",options,function(data){removeTopicListCache(),showTipper(i18n["zohodiscussions.singlePost.deleteLinkedTopicMessage"],"success"),"topicList"==location?getForumTopics(-1,-1,1,"Home"):"singlepost"==location&&loadNewPost("/deleteLinkedTopic.do",data,forumTopicId)},function(errordata){showTipper(i18n["zohodiscussions.generalmessage.errorOccured"],"failure")})}function deletePublishedAttachment($target,event){if(confirm(i18n["zohodiscussions.generalmessage.deleteAttachmentConfirmMsg"])){showLoadingImage(i18n["zohodiscussions.general.deleting"]),$this=$target;var deletingAttachmentId=$this.attr("attachmentId"),forumTopicId=$this.attr("forumTopicId"),responseId=$this.attr("responseId"),attachmentDiv=void 0!==responseId?responseId:forumTopicId,totalAttachment=$("#fullResponseContainer_"+responseId).find(".spattachmentList").attr("totalAttachment"),options={};options.forumGroupId=forumGroupId,options.forumTopicId=forumTopicId,options.responseId=responseId,options.fileName=$this.attr("attachmentName"),options.fileId=deletingAttachmentId,options.access="author",options[csrfParamName]=csrfToken,hideLoadingImage(),doAjaxAction("/deleteAttachment.do",options,function(data){"SUCCESS"==data&&(showTipper(i18n["zohodiscussions.general.Deleted"],"info"),0<$("#SinglePostContainer").length?(hideLoadingImage(),showLoadingImage(),removeTopicListCache(),1<totalAttachment?($("#discussionsAttachment_"+deletingAttachmentId).remove(),$("#fullResponseContainer_"+responseId).find(".spattachmentList").attr("totalAttachment",totalAttachment-1)):$("#fullResponseContainer_"+responseId).find(".attachments").remove()):0<$("#topicList").length||0<$("#topicsList").length?($("#topicListMainContainer").attr("shouldReload","true"),0<$("#currentCategoryContext").length?$("#currentCategoryContext").trigger("click"):$("#currentForumContext").trigger("click")):0<$("#topicContent_"+attachmentDiv).length&&($("#topicContent_"+attachmentDiv).find("li[attachmentId ="+deletingAttachmentId+"]").remove(),0==$("#topicContent_"+attachmentDiv).find("li.singleList").length&&$("#topicContent_"+attachmentDiv).find("div.Attachments").remove()))})}}function openEmailTopicDialog($target){var $this=$target,title=$this.attr("topicTitle"),forumTopicId=$this.attr("forumTopicId");forumTopicId=forumTopicId||$this.parents('div[parentCont="actualParent"]').attr("forumTopicId");var $emailDialog=$("#emailTopicPrompt");return $emailDialog.find(':input[name="Subject"]').val(title),$emailDialog.find(':input[name="forumTopicId"]').val(forumTopicId),$emailDialog.find(':input[name="topicTitle"]').val(title),$emailDialog.find(':input[name="emailIds"]'),$emailDialog.show().parent().show(),$emailDialog.find(':input[name="emailIds"]').focus(),!1}function emailTopic(event){var $this=$(event.target);$this.html(i18n["zohodiscussions.singlePost.sending"]);var $emailDialog=$("#emailTopicPrompt");return 1==discussionsValidate($emailDialog.find("form"))?doAjaxAction("/eMailTopic.do",$emailDialog.find("form").serialize(),function(data){if("SUCCESS"==data)showTipper(i18n["zohodiscussions.singlepost.mailsentmessage"],"success"),$this.html(i18n["zohodiscussions.general.send"]),cancelEmailTopic();else if("FAILURE"===data)showTipper(i18n["zohodiscussions.generalmessage.errorOccured"]);else if(0<data.indexOf("'result':'failure'")){showTipper(toEvaluateData(data).reason,"failure"),$this.html(i18n["zohodiscussions.general.send"])}},function(err){0<err.responseText.indexOf("'result':'failure'")?(showTipper(toEvaluateData(err.responseText).reason,"failure"),$this.html(i18n["zohodiscussions.general.send"])):showTipper(i18n["zohodiscussions.errorpage.requestedURLisnotfoundMess"],"failure",1e3)}):$this.html(i18n["zohodiscussions.general.send"]),!1}function cancelEmailTopic(){var $emailDialog=$("#emailTopicPrompt");return $emailDialog.hide().parent().hide(),$emailDialog.find(':input[name="emailIds"]').val(""),$emailDialog.find(':input[name="Subject"]').val(""),$("#emailContentArea").val(""),!1}function singlePostApproveAction($target){showLoadingImage(i18n["zohodiscussions.general.publishing"]);var action=$target.attr("action"),forumTopicId=$target.attr("forumTopicId"),forumId=$target.attr("forumId"),categoryId=$target.attr("categoryId"),itemType=$target.attr("itemType"),options={};if(options.forumGroupId=forumGroupId,options.forumTopicId=forumTopicId,options.forumId=forumId,options.categoryId=categoryId,options.authorId=$target.attr("authorId"),options[csrfParamName]=csrfToken,"response"==itemType){var responseId=$target.attr("responseId");options.responseId=responseId}$target.hide(),$("div.approveButton").hide(),hideLoadingImage(),doAjaxAction(action,options,function(data){"SUCCESS"==data&&(removeTopicListCache(),updateAwaitingApprovalCount())})}function singlePostSpamAction($this,$location){var postType=$this.attr("postType");"topic"===postType?postType=i18n["zohodiscussions.moderationList.topic"]:"response"===postType&&(postType=i18n["zohodiscussions.moderationList.response"]);var spamValue=$this.attr("spamValue"),confirmMess="";"true"==moderatorForSpam?(confirmMess=1==spamValue?i18n["zohodiscussions.singlepost.spamActionconfirmationmessage1"]+" "+postType+" "+i18n["zohodiscussions.singlepost.inappropriateActionconfirmationmessage2"]:i18n["zohodiscussions.singlepost.spamActionconfirmationmessage3"]+" "+postType+" "+i18n["zohodiscussions.singlepost.appropriateActionconfirmationmessage2"],confirm(confirmMess)&&spamAction($this,postType,$location)):1==spamValue?($("#spamStatusMsg").show(),$("#spamDetails_Text").val(""),$("#spamContentDetails").unbind("click").click(function(){var spamDetails=$("#spamDetails_Text").val();""!=(spamDetails=$.trim(spamDetails))?spamAction($this,postType,$location,"appropriate",spamDetails):showMessage(i18n["zohodiscussions.singlePost.EmptyMsgError"],"failure")})):confirm(i18n["zohodiscussions.singlepost.spamActionconfirmationmessage3"]+" "+postType+" "+i18n["zohodiscussions.singlepost.appropriateActionconfirmationmessage2"])&&spamAction($this,postType,$location,"appropriate")}function spamAction($this,postType,$location,appropriate,spamDetails){var forumTopicId=$this.attr("forumTopicId");forumTopicId=forumTopicId||$this.parents('div[parentCont="actualParent"]').attr("forumTopicId");var forumId=$this.attr("forumId");forumId=forumId||$this.parents('div[parentCont="actualParent"]').attr("forumId");var categoryId=$this.attr("categoryId");categoryId=categoryId||$this.parents('div[parentCont="actualParent"]').attr("categoryId");var options={},spamValue=$this.attr("spamValue");options.forumTopicId=forumTopicId,options.forumGroupId=forumGroupId,options.action=spamValue,options.postType=$this.attr("postType"),options.purpose=appropriate||$this.attr("purpose"),options.forumId=forumId,options.categoryId=categoryId,options[csrfParamName]=csrfToken,void 0!==spamDetails&&(options.spamDetails=spamDetails);var responseId=$this.attr("responseId");void 0!==responseId&&(options.responseId=responseId),doAjaxAction("/spamAction.do",options,function(data){if($("#spamStatusMsg").hide(),"SUCCESS"==data)if(removeTopicListCache(),showTipper("1"==spamValue?"appropriate"==appropriate?i18n["zohodiscussions.statistics.this"]+" "+postType+" "+i18n["zohodiscussions.singlepost.Inappropriatemarkedmessage2"]:i18n["zohodiscussions.statistics.this"]+" "+postType+" "+i18n["zohodiscussions.singlepost.spammarkedmessage2"]:"appropriate"==appropriate?i18n["zohodiscussions.statistics.this"]+" "+postType+" "+i18n["zohodiscussions.singlepost.InappropriateRemovedmessage"]:i18n["zohodiscussions.statistics.this"]+" "+postType+" "+i18n["zohodiscussions.singlepost.spamRemovedmessage"],"success",1e3),"singlePost"==$location)loadSinglePost(forumTopicId,"true",void 0,void 0,"spamReported");else if("true"==moderatorForSpam)1==spamValue?processHash("home"):($this.parent().remove(),$("#reportInappropriate_"+responseId).remove());else if(1==spamValue){if(($reportInappropriate=$("#reportInappropriate_"+responseId)).attr("spamValue","2"),$reportInappropriate.find("div.imgAshSpam").removeClass("imgAshSpam").addClass("imgNotSpamIcon"),$reportInappropriate.find("a").html(i18n["zohodiscussions.singlePost.Appropriate"]),0<$("#reasonInappropriate_"+responseId).length){var $reasonInappropriate=$("#reasonInappropriate_"+responseId),reportCount=parseInt($reasonInappropriate.attr("reportCount"));reportCount+=1,$reasonInappropriate.find('span[purpose="inappropriateReason"]').html(i18n["zohodiscussions.singlePost.Inappropriate"]+" ("+reportCount+")"),$reasonInappropriate.attr("reportCount",reportCount)}}else{var $reportInappropriate;($reportInappropriate=$("#reportInappropriate_"+responseId)).attr("spamValue","1"),$reportInappropriate.find("div.imgNotSpamIcon").removeClass("imgNotSpamIcon").addClass("imgAshSpam"),$reportInappropriate.find("a").html(i18n["zohodiscussions.singlePost.Inappropriate"]);$reasonInappropriate=$("#reasonInappropriate_"+responseId),reportCount=parseInt($reasonInappropriate.attr("reportCount"));0<(reportCount-=1)?($reasonInappropriate.attr("reportCount",reportCount),$reasonInappropriate.find('span[purpose="inappropriateReason"]').html(i18n["zohodiscussions.singlePost.Inappropriate"]+" ("+reportCount+")")):$reasonInappropriate.remove()}},function(errordata){var responseData=toEvaluateData(errordata.responseText);"failure"==responseData.result&&showMessage(responseData.reason,"failure")})}function singlePostWidgetActions(event){var $target=$(event.target),$targetParent=$target.parent();if($targetParent.is('li[purpose="bookmark"]'))bookMark($targetParent,event);else if($targetParent.is('li[purpose="watchAction"]')||$targetParent.is('div[purpose="watchAction"]'))watchThisItem($targetParent,"singlePost",event);else if($targetParent.is('li[purpose="lockTopic"]')||$target.is("#unLockTopic")){lockTopicLink($target.is("#unLockTopic")?$target:$targetParent,event)}else if($targetParent.is('li[purpose="moveTopic"]'))moveTopic($targetParent);else if($targetParent.is('li[purpose="stickyPost"]'))stickyLink($targetParent,event);else if($targetParent.is('li[purpose="moderateThisTopic"]'))moderateAction($targetParent,"singlePost",event);else if($targetParent.is('li[purpose="changeTopicType"]')){changeTopicType($targetParent.attr("forumTopicId"))}else if($target.is('input[purpose="notifyAuthor"]')){updateNotification($target,$target.attr("forumTopicId"),event)}else{if($target.is('a[purpose="forumPostsFilter"]'))return hashPurpose=$target.attr("hashPurpose"),processHash(hashPurpose),!1;$targetParent.is('li[purpose="raiseZSupportRequest"]')&&raiseZSupportRequest($targetParent,event)}}function changeTopicType(forumTopicId){$("#changeTopicTypeTemplate").html($("#changeTopicType_"+forumTopicId).html()),$("#changeTopicType_"+forumTopicId).html(""),$("#changeTopicTypeTemplate").show(),$("#cancelTopicChange,#cancelChangingTopicType").click(function(){$("#changeTopicType_"+forumTopicId).html($("#changeTopicTypeTemplate").html()),$("#changeTopicTypeTemplate").hide(),$("#changeTopicTypeTemplate").html("")}),$("#topicTypeListForChange").change(function(){1==$(this).val()?$("#postExpiryDays_"+forumTopicId).show():$("#postExpiryDays_"+forumTopicId).hide()}),$("#doChange_"+forumTopicId).click(function(){var $this=$(this);$(this).attr("disabled",!0);var value=$("#topicTypeListForChange").val(),forumId=$this.attr("forumId"),categoryId=$this.attr("categoryId"),options={};if("true"==$this.attr("isTopicOwner")&&(options.access="author"),1==value){var expiryDay=$("#announcementExpiryDays_"+forumTopicId).val();options.expiryDay=expiryDay}options.forumGroupId=forumGroupId,options.forumTopicId=forumTopicId,options.forumId=forumId,options.categoryId=categoryId,options.postTopicType=value,options[csrfParamName]=csrfToken,isThreadSorting&&(options.sortThreads=$("#SinglePostContainer").attr("sortThread")),doAjaxAction("/updateTopicType.do",options,function(data){removeTopicListCache(),loadNewPost("/updateTopicType.do",data,forumTopicId),$("#changeTopicTypeTemplate").hide(),showTipper(i18n["zohodiscussions.singlePost.updateTopicTypeSuccessMessage"],"success")},function(errordata){showTipper(i18n["zohodiscussions.singlePost.updateTopicTypeErrorMessage"],"failure")})})}function updateNotification($this,forumTopicId,event){var options={};options.forumGroupId=forumGroupId,options.forumTopicId=forumTopicId,options.access="author",notifyStat=$this.attr("notifyOnResponse"),"true"==notifyStat?notifyStat="false":notifyStat="true",$this.attr("notifyOnResponse",notifyStat),options.currNotifyStatus=notifyStat,options[csrfParamName]=csrfToken,doAjaxAction("/updateNotify.do",options,function(data){"SUCCESS"?(removeTopicListCache(),showTipper(i18n["zohodiscussions.singlepost.Notificationsavedmessage"],"success",1e3)):showTipper(i18n["zohodiscussions.generalmessage.errorOccured"],"failure")})}function moderateAction($this,$location,event){var forumTopicId=$this.attr("forumTopicId");forumTopicId=forumTopicId||$this.parents('div[parentCont="actualParent"]').attr("forumTopicId");var forumId=$this.attr("forumId");if(forumId=forumId||$this.parents('div[parentCont="actualParent"]').attr("forumId"),"moderate"==$this.attr("moderationStatus")){var moderateTopic={};moderateTopic.forumTopicId=forumTopicId,moderateTopic.forumGroupId=forumGroupId,moderateTopic.forumId=forumId,moderateTopic[csrfParamName]=csrfToken,showSmallLoadingImage(event),doAjaxAction("/moderateTopic.do",moderateTopic,function(data){"SUCCESS"==data?(removeTopicListCache(),$this.attr("moderationStatus","moderated"),showTipper(i18n["zohodiscussions.singlepost.Now"]+i18n["zohodiscussions.singlepost.topicundermoderationmessage"],"success",2e3),"singlePost"==$location?$("#moderateTopicText").html(i18n["zohodiscussions.singlepost.unmoderatethistopicmessage"]):$this.find('a[purpose = "moderateTopicText"]').html(i18n["zohodiscussions.singlepost.unmoderatethistopicmessage"])):showTipper(i18n["zohodiscussions.singlepost.Moderationfailed"],"success",2e3),hideLoadingImage()})}else if("moderated"==$this.attr("moderationStatus")){var unModerateTopic={};unModerateTopic.forumTopicId=forumTopicId,unModerateTopic.forumGroupId=forumGroupId,unModerateTopic[csrfParamName]=csrfToken,doAjaxAction("/unModerateTopic.do",unModerateTopic,function(data){"SUCCESS"==data?(removeTopicListCache(),$this.attr("moderationStatus","moderate"),showTipper(i18n["zohodiscussions.singlepost.moderationtopicremoved"],"success",2e3),"singlePost"==$location?$("#moderateTopicText").html(i18n["zohodiscussions.singlepost.moderatethistopicmessage"]):$this.find('a[purpose = "moderateTopicText"]').html(i18n["zohodiscussions.singlepost.moderatethistopicmessage"])):showTipper(i18n["zohodiscussions.singlepost.Moderationfailed"],"success",2e3)})}}function moveTopic($moveTopicLink){var forumTopicId=$moveTopicLink.attr("forumTopicId");$("#moveTopicTemplate").html($("#moveTopic_"+forumTopicId).html()),loadCategoriesToMove($("#forumListForMove").val()),$("#moveTopicTemplate").show();var $forumListForMove=$("#forumListForMove"),$forumListForModerator=$("#forumListForModerator");"yes"==$moveTopicLink.attr("moderatorUser")?($forumListForModerator.hide(),$forumListForMove.show(),$forumListForMove.val($moveTopicLink.attr("forumId")),loadCategoriesToMove($moveTopicLink.attr("forumId")),$("#moveToCategory").val($moveTopicLink.attr("categoryId"))):($forumListForMove.hide(),$forumListForModerator.show(),loadCategoriesToMove($forumListForModerator.val())),$("#cancelMove,#cancelMoveTopic").click(function(){$("#moveTopic_"+forumTopicId).html($("#moveTopicTemplate").html()),$("#moveTopicTemplate").hide(),$("#moveTopicTemplate").html(""),$("#doMove").html(i18n["zohodiscussions.singlePost.Movetopic"])}),$("#forumListForMove,#forumListForModerator").change(function(){$moveTopicLink.attr("forumId")==$(this).val()?$("#doMove").attr("disabled",!0):$("#doMove").attr("disabled",!1),loadCategoriesToMove($(this).val())}),$("#doMove").unbind("click").click(function(){var $moveButton=$(this);$moveButton.html(i18n["zohodiscussions.singlePost.Moving"]);var modratorUser=0;"yes"==$moveTopicLink.attr("moderatorUser")&&(modratorUser=1);var isTopicOwner=$(this).attr("isTopicOwner"),args={};args.forumTopicId=forumTopicId,args.forumId=$("#forumListForMove").val(),0==modratorUser&&(args.forumId=$("#forumListForModerator").val()),isTopicOwner&&(args.topicowner="true");var $categoryListCont=$("#moveToCategory"),doescategoryExists=$categoryListCont.is(":visible");args.categoryId=1==doescategoryExists?$categoryListCont.val():-1,args.forumGroupId=forumGroupId,args[csrfParamName]=csrfToken,args.categoryId||(args.categoryId=""),doAjaxAction("/moveTopic.do",args,function(data){removeTopicListCache(),$("#moveTopicTemplate").hide(),$("#moveTopicTemplate").html(""),showTipper(i18n["zohodiscussions.generalmessage.moveTopicSuccessMsg"],"success",3e3),loadNewPost("/moveTopic.do",data,forumTopicId),$("#NewTopicTab").attr("hashPurpose","NewTopic/"+$("#moveTopicLink").attr("forumId")+"/"+$("#moveTopicLink").attr("categoryId")),0<data.indexOf("'result':'failure'")&&$moveButton.html(i18n["zohodiscussions.singlePost.Movetopic"])})})}function loadCategoriesToMove(forumId){categoriesForForum=$("#categoryListFormove").val().split("$$"),$("#moveToCategory").hide().parent().hide(),$.each(categoriesForForum,function(index,item){-1<item.indexOf(forumId+":")&&$("#moveToCategory").html(item.split(":")[1]).show().parent().show()})}function singlePostTagActions(forumTopicId,givenHashKey){$("#forumTopicTags").find('b[purpose = "deleteTag"]').click(function(){if(confirm(i18n["zohodiscussions.singlepost.tagDeleteConfirmMsg"])){$this=$(this);var deletePostTags={},postTagId=$this.attr("postTagId"),tagName=$this.attr("eachTagName"),zuid=$this.attr("zuid"),forumId=$this.attr("forumId");$this.attr("postAuthorId")==zuid&&(deletePostTags.access="author"),deletePostTags.forumGroupId=forumGroupId,deletePostTags.forumTopicId=forumTopicId,deletePostTags.forumId=forumId,deletePostTags.postTagId=postTagId,deletePostTags[csrfParamName]=csrfToken;var tagCount=$("#tagRelatedPosts_"+postTagId).attr("tagCount");doAjaxAction("/deleteForumPostTags.do",deletePostTags,function(data){"SUCCESS"==data&&(removeTopicListCache(),tagCount=--tagCount,$(".deleteTag").attr("tagCount",tagCount),showTipper("<i>"+tagName+" </i> "+i18n["zohodiscussions.resource.tagdelete"],"info",3e3),$("#tagRelatedPosts_"+postTagId).hide(),0==tagCount&&($("#LockTopicLink").attr("isLocked")&&0<$("#linkTopicCont_"+forumTopicId).length?$("#forumTopicTags").append('<span class="addTagSpan">'+i18n["zohodiscussions.singlepost.noTagsMsg"]+"</span>"):($("#addTagsForPost").hide(),$("#forumTopicTags").append('<span class="addTagSpan"> Click <a id="addNewTag" href="javascript:;">here</a> to add new tags.</span>'),singlePostTagActions())))})}return!1}),$("#addTagsForPost,#addNewTag").click(function(){$("#addPostTags").show(),$("#addPostTags").find(':input[name="postTags"]').focus(),$("#addTagSpan").hide()}),$("#cancelTags").click(function(){$("#addPostTags").hide(),$("#addPostTags").find(':input[name="postTags"]').attr("value"," ")}),$("#savePostTags").click(function(){$this=$(this);var postTags=$("#addPostTags").find(':input[name="postTags"]').val(),flag="false";if(""!=(postTags=postTags.replace(/^\s+|\s+$/g," ").replace(/\s+/g," "))&&null==postTags.match(/^[^\^\"'()~`!@#$%&:;\/\\?|<>{}[\]*-+=]+$/))return hideLoadingImage(),showMessage(i18n["zohodiscussions.singlepost.specialCharacterNotAllowedMsg"],"failure"),void enablePostButtons();for(var checkEmpty=postTags.split(","),i=0;i<checkEmpty.length;i++){if(50<checkEmpty[i].length)return void showTipper(i18n["zohodiscussions.singlepost.TagexceedMessage"],"failure");""!=checkEmpty[i]&&""==!jQuery.trim(checkEmpty[i])&&(flag="true")}if("false"!=flag){if(postTags.indexOf("-")<0){var forumId=$this.attr("forumId"),addPostTagsOption={};if($this.attr("postAuthorId")==ZUID&&(addPostTagsOption.access="author"),addPostTagsOption.forumId=forumId,addPostTagsOption.postTags=postTags,addPostTagsOption.forumGroupId=forumGroupId,addPostTagsOption.forumTopicId=forumTopicId,addPostTagsOption[csrfParamName]=csrfToken,""==jQuery.trim(postTags))return void showMessage(i18n["zohodiscussions.singlepost.tagNameEmptyMsg"],"failure");doAjaxAction("/addNewTagsForPost.do",addPostTagsOption,function(data){removeTopicListCache(),showTipper(i18n["zohodiscussions.resource.tagsadded"],"success",2e3),loadNewPost("/addNewTagsForPost.do",data,forumTopicId)})}}else showMessage(i18n["zohodiscussions.singlepost.tagNameEmptyMsg"],"failure")}),$("#forumTopicTags").find('[purpose="getTagRelatedPosts"]').unbind("click").click(function(){return $this=$(this),givenHashKey=givenHashKey||"Tag",processHash($this.attr("hashPurpose")),!1})}function changeTopicLabel($this){var $topicStatusList=$("#zdstatusList"),topicLabelId=$this.attr("topicLabelId"),forumTopicId=$topicStatusList.attr("forumTopicId"),forumId=$topicStatusList.attr("forumId"),params={};params.forumGroupId=forumGroupId,params.forumTopicId=forumTopicId,params.forumId=forumId,params.topicLabelId=topicLabelId,params[csrfParamName]=csrfToken,doAjaxAction("/updateTopicLabel.do",params,function(data){if("success"==data){removeTopicListCache(),showTipper(i18n["zohodiscussions.singlePost.updateTopicLabelSuccessMsg"],"success");var topicLabelName=$.trim($this.html());$("#zdstatusInfo").html(topicLabelName)}else showMessage(i18n["zohodiscussions.singlePost.updateTopicLabelErrorMessage"],"failure")},function(errorData){})}function watchThisItem($this,$location,event){var hashPurpose=$this.attr("hashPurpose"),itemType=$this.attr("watchItemType"),itemId=$this.attr("watchItemId");itemId=itemId||$this.parents('div[parentCont="actualParent"]').attr("forumTopicId");var status=$this.attr("status"),watchStatus=$this.attr("watchStatus"),itemName=$this.attr("itemName"),watchOptions={};if(watchOptions.watchItemType=itemType,watchOptions.watchItemId=itemId,watchOptions.forumGroupId=forumGroupId,watchOptions[csrfParamName]=csrfToken,"watch"==status||"watch"==watchStatus)showSmallLoadingImage(event),doAjaxAction("/watchItem.do",watchOptions,function(data){if("SUCCESS"==data)if(removeTopicListCache(),0==itemType)if(showTipper(i18n["zohodiscussions.singlepost.watchTopicSuccessMsg"],"success",3e3),"singlePost"==$location)$(".wrapper > div[watchItemId="+itemId+"]").attr("status","unwatch"),$(".wrapper > div[watchItemId="+itemId+"] > a").html(i18n["zohodiscussions.singlePost.unwatchTopic"]),hideLoadingImage();else if("singleTopicWatch"==$location){$this.attr("status","unwatch"),$this.parent().removeClass("smallAshBox").addClass("smallAshBoxShow"),$this.removeClass("imgSmallWatch").addClass("imgSmallWatchSel"),hideLoadingImage()}else $this.attr("status","unwatch"),$this.find('a[purpose = "watchItemText"]').html(i18n["zohodiscussions.singlePost.unwatchTopic"]),hideLoadingImage();else{if(2==itemType)return showTipper(i18n["zohodiscussions.widgetscontainer.watchForumSuccessMsg"],"success",3e3),$this.attr("status","unwatch"),"type"!=hashPurpose?processHash(hashPurpose):($this.find("a").html(i18n["zohodiscussions.general.Unwatch"]+" "+itemName),$("#ajaxLoaderSmall").hide()),!1;if(1==itemType)return showTipper(i18n["zohodiscussions.widgetscontainer.watchCategorySuccessMsg"],"success",3e3),$this.attr("status","unwatch"),"type"!=hashPurpose?processHash(hashPurpose):($this.find("a").html(i18n["zohodiscussions.general.Unwatch"]+" "+itemName),$("#ajaxLoaderSmall").hide()),!1;if(4==itemType||5==itemType||6==itemType)return showTipper(i18n["zohodsicussions.watchlist.announcement.follow.success"],"success",3e3),$this.attr("status","unwatch"),$this.html(i18n["zohodiscussions.general.Unwatch"]+" "+itemName),$("#ajaxLoaderSmall").hide(),!1}});else{var confirmMess="";if(0==itemType?confirmMess=i18n["zohodiscussions.singlepost.unwatchTopicConfirmMsg1"]:1==itemType?confirmMess=i18n["zohodiscussions.singlepost.unwatchCategoryConfirmMsg3"]:2==itemType?confirmMess=i18n["zohodiscussions.singlepost.unwatchForumConfirmMsg2"]:4!=itemType&&5!=itemType&&6!=itemType||(confirmMess=i18n["zohodsicussions.watchlist.announcement.unwatch.confirm"]),confirm(confirmMess)){var unWatchOptions={};unWatchOptions.watchItemId=itemId,unWatchOptions.forumGroupId=forumGroupId,unWatchOptions[csrfParamName]=csrfToken,doAjaxAction("/unWatch.do",unWatchOptions,function(data){if("SUCCESS"==data)if(removeTopicListCache(),0==itemType)if(showTipper(i18n["zohodiscussions.singlepost.unwatchTopicSuccessMsg"],"info",3e3),"singlePost"==$location)$(".wrapper > div[watchItemId="+itemId+"]").attr("status","watch"),$(".wrapper > div[watchItemId="+itemId+"] > a").html(i18n["zohodiscussions.singlePost.watchTopic"]);else if("singleTopicWatch"==$location){$this.attr("status","watch"),$this.parent().removeClass("smallAshBoxShow").addClass("smallAshBox"),$this.removeClass("imgSmallWatchSel").addClass("imgSmallWatch"),hideLoadingImage()}else $this.attr("status","watch"),hideLoadingImage();else{if(2==itemType)return showTipper(i18n["zohodiscussions.widgetscontainer.unwatchForumSuccessMsg"],"success",3e3),$this.attr("status","watch"),"type"!=hashPurpose?processHash(hashPurpose):($this.find("a").html(i18n["zohodiscussions.general.watch"]+" "+itemName),$("#ajaxLoaderSmall").hide()),!1;if(1==itemType)return showTipper(i18n["zohodiscussions.widgetscontainer.unwatchCategorySuccessMsg"],"success",3e3),$this.attr("status","watch"),"type"!=hashPurpose?processHash(hashPurpose):($this.find("a").html(i18n["zohodiscussions.general.watch"]+" "+itemName),$("#ajaxLoaderSmall").hide()),!1;if(4==itemType||5==itemType||6==itemType)return showTipper(i18n["zohodsicussions.watchlist.announcement.stop.success"],"success",3e3),$this.attr("status","watch"),$this.html(i18n["zohodiscussions.general.watch"]+" "+itemName),$("#ajaxLoaderSmall").hide(),!1}})}}}function bookMark($this,event){var status=$this.attr("status"),bookmarkOptions={};bookmarkOptions.forumGroupId=forumGroupId,bookmarkOptions.forumTopicId=$this.attr("forumTopicId"),bookmarkOptions[csrfParamName]=csrfToken,showSmallLoadingImage(event),"bookmark"==status?doAjaxAction("/addBookMark.do",bookmarkOptions,function(data){hideLoadingImage(),"SUCCESS"==data?(removeTopicListCache(),showTipper(i18n["zohodiscussions.singlepost.bookmarkTopicSuccessMsg"],"success",3e3),$this.attr("status","removeBookmark"),$this.find("a").html(i18n["zohodiscussions.singlePost.removeBookmark"])):showTipper(i18n["zohodiscussions.singlePost.bookMarkErrorMessage"],"failure")}):doAjaxAction("/removeBookMark.do",bookmarkOptions,function(data){hideLoadingImage(),"SUCCESS"==data?(removeTopicListCache(),showTipper(i18n["zohodiscussions.singlePost.removeBookmarkMsg"],"info",3e3),$this.attr("status","bookmark"),$this.find("a").html(i18n["zohodiscussions.singlePost.bookmarkTopic"])):showTipper(i18n["zohodiscussions.singlePost.removeBookMarkErrorMessage"],"failure")})}function stickyLink($this,event){var action=0,status=$this.attr("status");"true"==$this.attr("isSticky")&&(action=1);var stickyActionOptions={};stickyActionOptions.forumGroupId=forumGroupId,stickyActionOptions.forumTopicId=$this.attr("forumTopicId"),stickyActionOptions.action=action,stickyActionOptions[csrfParamName]=csrfToken,showSmallLoadingImage(event),doAjaxAction("/stickyAction.do",stickyActionOptions,function(data){"SUCCESS"==data&&(removeTopicListCache(),"stickyPost"==status?(showTipper(i18n["zohodiscussions.singlepost.stickyPostSuccessMsg"],"success",3e3),$this.attr("status","normal"),$this.attr("isSticky","true"),$("#stickyPostText").html(i18n["zohodiscussions.singlePost.notStickyPost"])):(showTipper(i18n["zohodiscussions.singlePost.removeStickyPostMsg"],"info",3e3),$this.attr("status","stickyPost"),$this.attr("isSticky","false"),$("#stickyPostText").html(i18n["zohodiscussions.singlePost.makeStickyPost"])),hideLoadingImage())})}function lockTopicLink($this,event){var action=0,status=$this.attr("status"),isLocked=$this.attr("isLocked"),forumTopicId=$this.attr("forumTopicId");"true"==isLocked&&(action=1);var actionToDo="lockTopic"==status?i18n["zohodiscussions.singlepost.lockConfirmationMsg"]:i18n["zohodiscussions.singlepost.unlockConfirmationMsg"];if(confirm(actionToDo)){var lockActionOptions={};lockActionOptions.forumGroupId=forumGroupId,lockActionOptions.forumTopicId=forumTopicId,lockActionOptions.action=action,lockActionOptions[csrfParamName]=csrfToken,isThreadSorting&&(lockActionOptions.sortThreads=$("#SinglePostContainer").attr("sortThread")),doAjaxAction("/lockAction.do",lockActionOptions,function(data){removeTopicListCache(),showTipper("lockTopic"==status?i18n["zohodiscussions.singlepost.lockTopicSuccessMsg"]:i18n["zohodiscussions.singlepost.unlockTopicSuccessMsg"],"info",3e3),loadNewPost("/lockAction.do",data,forumTopicId)})}}function raiseZSupportRequest($this,event){var raiseZSupportRequest={};raiseZSupportRequest.forumGroupId=forumGroupId,raiseZSupportRequest.forumTopicId=$this.attr("forumTopicId"),raiseZSupportRequest.forumId=$this.attr("forumId"),raiseZSupportRequest[csrfParamName]=csrfToken,showSmallLoadingImage(event),jQuery("#ajax_load_tab").show(),doAjaxAction("/raiseZSupportRequest.do",raiseZSupportRequest,function(data){jQuery("#ajax_load_tab").hide();var responseData=toEvaluateData(data);"success"==responseData.result?(showTipper("Support ticket added successfully","info",3e3),"raiseZSupportRequest"==$this.attr("Purpose")&&($this.remove(),$(".sideBar").find(".wrapper").prepend('<div class="spwidgetBox"><div class="zsupportReqMsg">'+i18n["zohodiscussions.singlepost.zsupportRequestMsg"]+"</div></div>")),$this.parents('[purpose="zsRequestLinkCont"]').remove(),hideLoadingImage()):showMessage(responseData.reason,"failure")})}function disablePostResponseButtons(){$("#publishResponse").attr("disabled",!0),$('button[purpose="publishPreviewResponse"]').attr("disabled",!0)}function enablePostResponseButtons(){$("#publishResponse").attr("disabled",!1),$('button[purpose="publishPreviewResponse"]').attr("disabled",!1)}function addForumResponse(forumTopicId,editorMode,responseId,tweetStatusId){showLoadingImage(i18n["zohodiscussions.general.publishing"]);var contentToPost=editor.getContent();contentToPost=contentToPost.replace(/^\s+/g,"").replace(/\s+$/g,"");var textContentToPost=editor.doc.body.textContent.trim();if("plaintext"===editor.mode&&(textContentToPost=contentToPost.trim(),contentToPost=(contentToPost=encodeHTML(contentToPost)).replace(/\n/g,"<br/>")),$("#postContentTA").val(contentToPost.trim()),""===textContentToPost)return hideLoadingImage(),void showMessage(i18n["zohodiscussions.writePost.noContentInPost"],"failure");$("#editorHolder").append($("#attachmentsListCont").clone().hide());var newResponseAction=editorMode&&"Edit"==editorMode?"/updateResponse.do":-1==ZUID?"/addGuestForumResponse.do":"/addForumResponse.do";if("TweetPost"==editorMode){var postTitle=$("#editorHolder").find('input[name="forumPostTitle"]').val();postTitle=postTitle.replace(/^\s+/g,"").replace(/\s+$/g,"");var $tempTitle=$("<div></div>").html(postTitle);if($tempTitle=$tempTitle.text(),""==($tempTitle=$.trim($tempTitle)))return hideLoadingImage(),showMessage(i18n["zohodiscussions.writePost.TopicTitleCannotbeEmptymessage"],"failure"),void $("#editorHolder").find('input[name="forumPostTitle"]').focus();if(-1==$("#forum_Twitter_SelectForum").val())return hideLoadingImage(),void showMessage(i18n["zohodiscussions.writePost.selectAnyForum"],"failure");if(-1==$("#forum_Twitter_SelectSubForum_"+tweetStatusId).val()&&"Uncategorised"!=$("#forum_Twitter_SelectSubForum_"+tweetStatusId).text())return hideLoadingImage(),void showMessage(i18n["zohodiscussions.writePost.selectAnyCategory"],"failure");newResponseAction="/addTweetPost.do";var tweetContent=$tempCont;$("#editorHolder").find('input[name="twitterResponseContent"]').val(tweetContent)}return disablePostResponseButtons(),doAjaxAction(newResponseAction,$("#editorHolder").serialize(),function(data){if(data=$.trim(data),hideLoadingImage(),"failure"==data.substring(12,19)){"SPAM_DETECTED"==(responseData=toEvaluateData(data)).errorcode?confirm(responseData.reason)&&($("#editorHolder").find('input[name="detectSpamPresence"]').val(0),$("#publishResponse").trigger("click")):showMessage(responseData.reason,"failure"),enablePostResponseButtons()}else{if("success"==data.substring(12,19)){var responseData=toEvaluateData(data);return 0<$("#SinglePostContainer").length?(removeTopicListCache(),loadSinglePost(forumTopicId,!1,void 0,void 0,"spamReported")):(0<$("#topicList").length||0<$("#topicsList").length)&&($("#topicListMainContainer").attr("shouldReload","true"),0<$("#currentCategoryContext").length?$("#currentCategoryContext").trigger("click"):"TweetPost"==editorMode?(showTipper(i18n["zohodiscussions.writePost.publishMsg"],"success",4e3),"false"==isTopicQuickView?window.location.href=serverURL+"/topic/"+responseData.topicPermaLink:(showLoadingImage(),loadSinglePost(responseData.value))):$("#currentForumContext").trigger("click")),void showTipper(i18n[responseData.reason],"info",5e3)}if(showTipper(editorMode&&"Edit"==editorMode?i18n["zohodiscussions.singlepost.ResponseUpdated"]:i18n["zohodiscussions.singlepost.ResponseAdded"],"success",3e3),0<$("#SinglePostContainer").length)removeTopicListCache(),showLoadingImage(),loadNewPost(newResponseAction,data,forumTopicId);else if(0<$("#topicList").length||0<$("#topicsList").length){$("#topicListMainContainer").attr("shouldReload","true");var forumId=$("#topicListMainContainer").attr("forumId");if(isEmbedService())return ZIntranet.loadForum(forumId),$("#cancelResponse").trigger("click"),!1;if(0<$("#currentCategoryContext").length)$("#currentCategoryContext").trigger("click");else if(0==$("#currentForumContext").length){loadTagRelatedPost($("#eachTopic_"+forumTopicId).attr("currTagName"))}else $("#currentForumContext").trigger("click")}else if(0<$("#myJournalsInnerContent").length){var topicId=forumTopicId;responseId&&$("#topicContent_"+topicId).length<1&&(topicId=responseId),$("#topicContent_"+topicId).html(contentToPost),$("#editTopic_"+topicId).html(contentToPost),$("#cancelResponse").trigger("click")}else if(0<$("#authorProfileInnerContent").length){topicId=forumTopicId;responseId&&$("#topicContent_"+topicId).length<1&&(topicId=responseId),$("#topicContent_"+topicId).html(contentToPost),$("#editTopic_"+topicId).html(contentToPost),$("#cancelResponse").trigger("click")}$('#responsePreviewContainerTemplate button[purpose="publishPreviewResponse"]').attr("disabled",!1)}},function(errordata){if(hideLoadingImage(),0<errordata.responseText.indexOf("'result':'failure'")){var responseData=toEvaluateData(errordata.responseText);if("failure"==responseData.result)if("HIP_REQUIRED"==responseData.errorcode){$("#editorHolder").find("div#responseAttachmentContActual").remove();var $writePostCaptcha=$("#responseAttachmentContActual").find('div[purpose="responseCaptcha"]');"new"==$writePostCaptcha.attr("currCaptcha")?showMessage(i18n["zohodiscussions.writePost.captchaMsg"],"failure"):showMessage(i18n["zohodiscussions.writePost.captchaErrorMsg"],"failure"),$writePostCaptcha.find('img[purpose="captchaImage"]').replaceWith("<img purpose=captchaImage name=hipImg border=0 src=/showcaptcha?digest="+responseData.reason+" align=absmiddle alt=HIP image>"),$writePostCaptcha.find(":input").attr("name",responseData.reason),$writePostCaptcha.attr("currCaptcha","old"),$writePostCaptcha.show(),$("#responseAttachmentContActual").is(":visible")||$("#responseAttachmentContActual").show(),enablePostResponseButtons()}else showMessage(responseData.reason,"failure"),enablePostResponseButtons()}else $("#SinglePostContainer").get(0).innerHTML=errordata.responseText}),!1}function removeTopicListCache(){$("#topicListMainContainer:hidden").remove(),$("#userProfileMainContainer:hidden").remove(),$("#myAreaParentContainer:hidden").remove()}function loadNewPost(action,data,forumTopicId){var $responseData=$(data),$topicContainer=$("#topicContainer_"+forumTopicId);if(hideLoadingImage(),"/updateResponse.do"==action){var currResponseId=$('#editorHolder [name="responseId"]').val(),updatedContent=$responseData.find("#fullResponseContainer_"+currResponseId).html();$("#fullResponseContainer_"+currResponseId).html(updatedContent)}else if("/moveTopic.do"==action){var responseId=$("#topicVoteLink").attr("firstResponseId"),UpdatedContent=$responseData.find(".spbreadCrumbCont").html(),UpdatedActionContent=$responseData.find("#fullResponseContainer_"+responseId).html(),UpdatedWidgetActionContent=$responseData.find("#singlePostActionsWidget_"+forumTopicId).html();$(".spbreadCrumbCont").html(UpdatedContent),$("#fullResponseContainer_"+responseId).html(UpdatedActionContent),$("#singlePostActionsWidget_"+forumTopicId).html(UpdatedWidgetActionContent)}else if("/addLinkToTopic.do"==action||"/lockAction.do"==action||"/deleteLinkedTopic.do"==action){UpdatedContent=$responseData.find("#SinglePostContainer_"+forumTopicId).html(),UpdatedActionContent=$responseData.find("#singlePostActionsWidget_"+forumTopicId).html();var UpdatedTagContent=$responseData.find("#forumTopicTags").html();$("#SinglePostContainer_"+forumTopicId).html(UpdatedContent),$("#singlePostActionsWidget_"+forumTopicId).html(UpdatedActionContent),$("#forumTopicTags").html(UpdatedTagContent)}else if("/addNewTagsForPost.do"==action){var UpdatedTagsContent=$responseData.find("#forumTopicTags").html();$("#forumTopicTags").html(UpdatedTagsContent)}else if("/updateTopicType.do"===action||"/addForumResponse.do"===action||"/bestResponse.do"===action||"/removeBestResponse.do"===action||"/addGuestForumResponse.do"===action){var UpdatedTopicTypeContent=$responseData.find("#SinglePostContainer_"+forumTopicId).html();if($("#SinglePostContainer_"+forumTopicId).html(UpdatedTopicTypeContent),"/addForumResponse.do"==action){var addResponseCount=$responseData.find("#discussionsResponseCount").html();$("#discussionsResponseCount").html(addResponseCount);var watchAction=$responseData.find('.sideBar > .wrapper > div[purpose="watchAction"]');0<watchAction.length&&($('.sideBar > .wrapper > div[purpose="watchAction"]').remove(),$(".sideBar > .wrapper").prepend(watchAction));var recentResponseId=$responseData.find("#topicContainer_"+forumTopicId).attr("recentResponseId");$("#topicContainer_"+forumTopicId).attr("recentResponseId",recentResponseId),$(window).scrollTop($("#fullResponseContainer_"+recentResponseId).offset().top)}}else if("/getSortedThread.do"===action){UpdatedTopicTypeContent=$responseData.find("#singlePostreplyContainer_"+forumTopicId).html();$("#singlePostreplyContainer_"+forumTopicId).html(UpdatedTopicTypeContent)}$topicContainer.data("inEditMode",!1),initSinglePost(forumTopicId)}function bindMyAreaClicks($context){$context.unbind("click",processMyAreaClick).click(processMyAreaClick),$("#recentActivityContent, #profileDetailCont").unbind("click",processAllMyAreaMainClick).click(processAllMyAreaMainClick),$("#mainContent").unbind("click",processAuthorProfileClick),$("#mainContent").unbind("click",processAllActionClick),initialiseUserActivityChart()}function processMyAreaClick(event){var $target=$(event.target),$targetParent=$target.parent();$("#loadingImg").is(":visible")||$("#discussChartLoading").is(":visible")||(($targetParent.is('[purpose="dashBoard"]')||$targetParent.is('[purpose="myJournals"]')||$targetParent.is('[purpose="watchList"]')||$targetParent.is('[purpose="friends"]')||$targetParent.is('[purpose="bookMark"]')||$targetParent.is('[purpose="privateMsg"]')||$targetParent.is('[purpose="preference"]'))&&"Yes"!=$targetParent.attr("isNiceUrl")?getMyAreaAction($targetParent):($target.is('[purpose="dashBoard"]')||$target.is('[purpose="myJournals"]')||$target.is('[purpose="watchList"]')||$target.is('[purpose="friends"]')||$target.is('[purpose="bookMark"]')||$target.is('[purpose="privateMsg"]')||$target.is('[purpose="preference"]'))&&"Yes"!=$target.attr("isNiceUrl")&&getMyAreaAction($target))}function getMyAreaAction($target,subAction){showLoadingImage(),$target.parent("ul").find("li").removeClass("selected"),$target.addClass("selected");var action=$target.attr("action"),options={};options.forumGroupId=forumGroupId,options[csrfParamName]=csrfToken,options.ch=ch;var purpose=$target.attr("purpose");null!=subAction&&"watchList"==purpose&&(action="/myWatchListSubAction.do",options.subAction=subAction),$("#myAreaLists").attr("currView",purpose),"myJournals"==purpose&&(options.userId=$target.attr("userId"),options.viewType="myself"),doAjaxAction(action,options,function(data){return hideLoadingImage(),$("#myAreaInnerMainContent").find("div.innerWrapper").get(0).innerHTML=data,isEmbedAllowedService()&&("myJournals"==purpose?($.history.add("MyArea/myPosts"),lightBox("#myJournalsInnerContent")):"watchList"==purpose&&null!=subAction?$.history.add("MyArea/"+purpose+"/"+subAction):"friends"==purpose&&null!=subAction?$.history.add("MyArea/"+purpose+"/"+subAction):$.history.add("MyArea/"+purpose)),bindMyareaTabsActions(purpose,subAction),!1},function(err){showMessage(toEvaluateData(err.responseText).reason,"failure"),hideLoadingImage()})}function bindMyareaTabsActions(purpose,subAction){var $context=$("#myAreaInnerMainContent").find("div.innerWrapper");if("preference"==purpose){$context.unbind("click",processPreferenceClick).click(processPreferenceClick);var $userAvatarImage=$("#user_AvatarImage");0<$userAvatarImage.find("li.selected").length&&avatarImageFocus($userAvatarImage);var userPhotoPref=$("#preferenceInnerContent").find("form").attr("userPhotoPref"),userUploadPhotoUrl=$("#preferenceInnerContent").find("form").attr("userUploadPhotoUrl"),userIAMphoto=$("#preferenceInnerContent").find("form").attr("userIAMphoto"),userPhotoUrl="";if("IAM"==userPhotoPref)userPhotoUrl=userIAMphoto;else if("userUpload"==userPhotoPref)userPhotoUrl=userUploadPhotoUrl;else if("Avatar"==userPhotoPref&&0==$("#allAvatarList").find("li.selected").length){$("#allAvatarList").find('li[count="1"]').addClass("selected");var src="../images/avatars/avatarn1.gif";$("#userSelectedAvatarImage").attr("value",src),$("#userSelectedProfileImage").attr("value",src),$("#userPreferencePhotoCont").find("img").attr("src",src),$("#user_Photo").attr("value","Avatar")}insertBrowserOptionToUpload(userPhotoPref,userPhotoUrl);var $resetPass=$("#resetpassword"),options={};options[csrfParamName]=csrfToken,$resetPass.find("a").click(function(event){showSmallLoadingImage(event),$resetPass.hide(),doAjaxAction("https://"+defaultDomain+"/sendResetPassword.do",options,function(data){"success"==data?(hideLoadingImage(),$resetPass.html(i18n["zohodiscussions.reset.success"])):(hideLoadingImage(),$resetPass.html(i18n["zohodiscussions.reset.failure"])),$resetPass.show()})})}else $context.unbind("click",processAllMyAreaMainClick).click(processAllMyAreaMainClick),$context.unbind("click",processAllActionClick).click(processAllActionClick),allFilterOption(purpose),showAuthorPopout($context),"following"==subAction&&setFocusToContainer($context.find("#followingAuthors"),!1,100,0);if("dashBoard"==purpose){var dataOb;if("undefined"!=typeof WmsContacts&&"true"==ch)setPresence(dataOb=WmsContacts.getZohoContacts(),"followingUserDetails"),setPresence(dataOb,"followersUserDetails"),setPresence(dataOb,"friendsListContainer"),setPresenceInMyArea(dataOb,"current_recentActivity_List");initialiseUserActivityChart()}"watchList"==purpose&&("undefined"!=typeof WmsContacts&&"true"==ch&&setPresenceInMyArea(dataOb=WmsContacts.getZohoContacts(),"userChat_watchTopics"));"privateMsg"==purpose&&("undefined"!=typeof WmsContacts&&"true"==ch&&setPresenceInMyArea(dataOb=WmsContacts.getZohoContacts(),"userChat_inbox"));"friends"==purpose&&("undefined"!=typeof WmsContacts&&"true"==ch&&setPresenceInMyArea(dataOb=WmsContacts.getZohoContacts(),"friendsDetailsInnerContent"))}function avatarImageFocus($userAvatarImage){var imgTop=$userAvatarImage.find("li.selected").attr("count"),height=parseInt(imgTop/7);imgTop%7==0&&(height-=1),$userAvatarImage.scrollTop(60*height)}function UserPhotoPreference(imageURL,upload){"uploadUserPhoto"==upload&&($("#uploadPhotoCont").find('input[name="imageFileName"]').val(""),$("#uploadPhotoCont").find('img[purpose="uploadPhotoLoadingCont"]').remove(),$("#uploadPhotoPreference").attr("src",imageURL),$("#uploadPhotoCont").find('img[purpose="avat_Image"]').attr("src",imageURL),$("#userSelectedAvatarImage").attr("value",imageURL),$("#userSelectedProfileImage").attr("value",imageURL),$("#preferenceInnerContent").find("form").attr("userUploadPhotoUrl",imageURL),$("#userPreferencePhotoCont").find("img").attr("src",imageURL),$("#user_Photo").attr("value","userUpload"),$("#uploadPhotoCont").find("div.profilePhoto").removeClass("profilePhoto").addClass("profilePhotoSelected"),$("#allAvatarList").find("li.selected").removeClass("selected"),showTipper(i18n["zohodiscussions.userpreference.uploadsuccessMess"],"success",1e3))}function processAllMyAreaMainClick(event){var $target=$(event.target),$targetParent=$target.parent();if(lightBox("#myJournalsInnerContent"),!$("#loadingImg").is(":visible")&&!$("#discussChartLoading").is(":visible"))if($target.is('a[purpose="postTitle"]')){if("draft"==$target.attr("postType"))return void editDraftPost($target);if(showLoadingImage(),"false"!=isTopicQuickView){var forumTopicId=$target.attr("forumTopicId"),recentResponseId=$target.attr("recentResponseId");return processHash(null!=recentResponseId?"Topic/"+forumTopicId+"/"+recentResponseId:"Topic/"+forumTopicId),!1}}else{if(($target.is('a[purpose="forumAction"]')||$target.is('a[purpose="categoryAction"]'))&&"Yes"!=$target.attr("isNiceUrl"))return processHash($target.attr("hashPurpose")),!1;if($target.is('a[purpose="authorProfile"],a[purpose="authorProfileMore"]')&&"Yes"!=$target.attr("isNiceUrl")){var authorName=$target.attr("authorName");return void("0"==$target.attr("singleClickflag")&&(authorName==screenName||authorName==encodedScreenName?processHash("MyArea"):processHash("User/"+authorName),$target.attr("singleClickflag","1")))}if($target.is('div[purpose="unWatch"]'))return void unWatchItem($target);if($target.is('a[purpose="moreFollowing"]')&&"Yes"!=$target.attr("isNiceUrl"))return void processHash("myarea/watchList/following");if($target.is('a[purpose="moreFollowers"]')&&"Yes"!=$target.attr("isNiceUrl"))return void processHash("myarea/watchList/follower");if($targetParent.is('li[deletepurpose="deleteAttachment"]'))return void deletePublishedAttachment($targetParent,event);if($target.is("li.navBtnEnabled")&&$target.is('li[action="false"]'))return void fnPaginationProcess($targetParent,$target.attr("purpose"))}}function processAllActionClick(event){var $target=$(event.target),$targetParent=$target.parent(),currView=$("#myAreaLists").attr("currView");if(currView||(currView="authorProfile"),!$("#loadingImg").is(":visible")&&!$("#discussChartLoading").is(":visible")){var $parent;if($target.is(".bigPlusIcon"))return($parent=$target.parents("li.headerContent")).find("div.expandTextContent").is(":visible")&&"privateMsg"!=currView?$parent.find("div.textContent").addClass("expandTextContent"):($parent.find("div.textContent").addClass("expandTextContent").show(),$parent.parents("div.moderateSinglePost").find("div.lowerButton").show()),$target.removeClass("bigPlusIcon").addClass("bigMinusIcon"),void setFocusToContainer($target,!0,200);if($target.is(".bigMinusIcon"))return($parent=$target.parents("li.headerContent")).find("div.textContent").removeClass("expandTextContent").hide(),$parent.parents("div.moderateSinglePost").find("div.lowerButton").hide(),void $target.removeClass("bigMinusIcon").addClass("bigPlusIcon");if($targetParent.is('li[purpose="expandedView"]')||$targetParent.is('li[purpose="listView"]'))manageExpandOrCollapseType($targetParent,currView);else if($target.is("li.navBtnEnabled")&&$target.is('li[action="true"]')){var navType=$target.attr("purpose");"authorProfile"==currView?fnPagination($targetParent,navType,"true"):fnPagination($targetParent,navType)}else if($target.is('li[purpose="removeBookMark"]'))removeBookMarkAction($target);else if($targetParent.is('li[purpose="removeBookMark"]'))removeBookMarkAction($targetParent);else if($target.is('li[purpose="postTitle"]')){if("draft"==$target.attr("postType"))return void editDraftPost($target);if(showLoadingImage(),"false"!=isTopicQuickView)return processHash("Topic/"+$target.attr("forumTopicId")),!1}else if($targetParent.is('li[purpose="postTitle"]')){if("draft"==$targetParent.attr("postType"))return void editDraftPost($targetParent);if(showLoadingImage(),"false"!=isTopicQuickView)return processHash("Topic/"+$targetParent.attr("forumTopicId")),!1}else{if($targetParent.is('li[purpose="delete"]'))return void myJournalsDeletePost($targetParent,currView+"Tab");if($target.is('li[purpose="delete"]'))return void myJournalsDeletePost($target,currView+"Tab");if($target.is('li[purpose="resources"]')||$target.is('li[purpose="topics"]')||$target.is('li[purpose="drafts"]')||$target.is('li[purpose="replies"]')||$target.is('li[purpose="authorTopics"]')||$target.is('li[purpose="authorReplies"]')||$target.is('li[purpose="privateMsg"]'))return $("#"+currView+"Tab").find("li").removeClass("selected"),void myAreaAllTabClick($target,currView);if($targetParent.is('li[purpose="resources"]')||$targetParent.is('li[purpose="topics"]')||$targetParent.is('li[purpose="drafts"]')||$targetParent.is('li[purpose="replies"]')||$targetParent.is('li[purpose="authorTopics"]')||$targetParent.is('li[purpose="authorReplies"]')||$targetParent.is('li[purpose="privateMsg"]'))return $("#"+currView+"Tab").find("li").removeClass("selected"),void myAreaAllTabClick($targetParent,currView);if("watchTopics"==$target.attr("purpose")||"watchUsers"==$target.attr("purpose")||"watchForums"==$target.attr("purpose")||"watchCategories"==$target.attr("purpose")||"simpleView"==$target.attr("purpose")||"followers"==$target.attr("purpose"))$("#watchListTabs").find("li").removeClass("selected"),myAreaAllTabClick($target,"watchList");else if("watchTopics"==$targetParent.attr("purpose")||"watchUsers"==$targetParent.attr("purpose")||"watchForums"==$targetParent.attr("purpose")||"watchCategories"==$targetParent.attr("purpose")||"simpleView"==$targetParent.attr("purpose")||"followers"==$targetParent.attr("purpose"))$("#watchListTabs").find("li").removeClass("selected"),myAreaAllTabClick($targetParent,"watchList");else if("friendsActivities"==$target.attr("purpose")||"friendsList"==$target.attr("purpose")||"pendingFriendRequests"==$target.attr("purpose"))$("#friendsDetailsTabs").find("li").removeClass("selected"),friendsTabClick($target,"friendsDetails");else if("friendsActivities"==$targetParent.attr("purpose")||"friendsList"==$targetParent.attr("purpose")||"pendingFriendRequests"==$targetParent.attr("purpose"))$("#friendsDetailsTabs").find("li").removeClass("selected"),friendsTabClick($targetParent,"friendsDetails");else if($targetParent.is('li[purpose="removeFriend"]'))removeFriend($targetParent);else if($targetParent.is('li[purpose="confirmFriend"]'))confirmFriendRequest($targetParent);else{if($target.is('li[purpose="unWatch"]'))return void unWatchItem($target);if($targetParent.is('li[purpose="unWatch"]'))return void unWatchItem($targetParent);if($targetParent.is('li[purpose="unWatchItem"]'))unWatchItem($targetParent,"authorProfile");else{var $newReplyEditor;if("inbox"==$target.attr("purpose")||"sent"==$target.attr("purpose"))return $("#privateMsgTab").find("li").removeClass("selected"),($newReplyEditor=$("#newReplyPrivateMsgCont")).is(":visible")&&($newReplyEditor.parent().hide(),$newReplyEditor.remove()),void myAreaAllTabClick($target,"privateMsg");if("inbox"==$targetParent.attr("purpose")||"sent"==$targetParent.attr("purpose"))return $("#privateMsgTab").find("li").removeClass("selected"),($newReplyEditor=$("#newReplyPrivateMsgCont")).is(":visible")&&($newReplyEditor.parent().hide(),$newReplyEditor.remove()),void myAreaAllTabClick($targetParent,"privateMsg");if($target.is('li[purpose="deleteThisPM"]'))deletePrivateMsg($target);else if($targetParent.is('li[purpose="deleteThisPM"]'))deletePrivateMsg($targetParent);else if($target.is('li[purpose="replyToThisPM"]')||$target.is('li[purpose="editThisPM"]'))replyToPrivateMsg($target);else if($targetParent.is('li[purpose="replyToThisPM"]')||$targetParent.is('li[purpose="editThisPM"]'))replyToPrivateMsg($targetParent);else if($targetParent.is('a[purpose="postConversation"]'))privateConversation($targetParent);else if($target.is('a[purpose="postConversation"]'))privateConversation($target);else if($target.is('a[purpose="postConversationTitle"]')){var $parents=$target.parents("li.headerContent");$parents.find("div.textContent").is(":visible")?$parents.find("div.bigMinusIcon").trigger("click"):$parents.find("div.bigPlusIcon").trigger("click")}}}}}}function allFilterOption(type){$("#"+type+"_Filter").change(function(){var $this=$(this),currOption=$this.val(),$currSelectOption=$(this).find('option[filterType="'+currOption+'"]');"true"==$this.attr("action")?myJournalsFilterAction($currSelectOption,type):myJournalsFilter($currSelectOption,type)})}function removeBookMarkAction($target){var forumTopicId=$target.attr("forumTopicId"),options={};options.forumGroupId=forumGroupId,options.forumTopicId=forumTopicId,options[csrfParamName]=csrfToken,doAjaxAction("/removeBookMark.do",options,function(data){"SUCCESS"===data?(hideLoadingImage(),showTipper(i18n["zohodiscussions.bookMark.successfullyRemoveBookMark"],"success"),$("#bookMark_"+forumTopicId).remove()):showTipper(i18n["zohodiscussions.singlePost.removeBookMarkErrorMessage"],"failure")},function(err){showMessage(toEvaluateData(err.responseText).reason,"failure"),hideLoadingImage()})}function processPreferenceClick(event){var $target=$(event.target),$targetParent=$target.parent(),userUploadPhotoUrl=$("#preferenceInnerContent").find("form").attr("userUploadPhotoUrl"),userIAMphoto=$("#preferenceInnerContent").find("form").attr("userIAMphoto");if(!$("#loadingImg").is(":visible")&&!$("#discussChartLoading").is(":visible")){if("profile"==$target.attr("purpose")||"notification"==$target.attr("purpose")||"privacy"==$target.attr("purpose"))$targetParent.find("li.selected").removeClass("selected"),$target.addClass("selected"),myAreaAllTabClick($target,"preference");else if("profile"==$targetParent.attr("purpose")||"notification"==$targetParent.attr("purpose")||"privacy"==$targetParent.attr("purpose"))$targetParent.parent("ul").find("li.selected").removeClass("selected"),$targetParent.addClass("selected"),myAreaAllTabClick($targetParent,"preference");else if($target.is('input[purpose="save"]')||$targetParent.is('input[purpose="save"]'))updateUserPreference();else if($targetParent.is('li[purpose="avat_Image"]')){$("#user_IamImage").find("div.profilePhotoSelected").removeClass("profilePhotoSelected").addClass("profilePhoto"),$("#user_AvatarImage").find("li.selected").removeClass("selected"),$targetParent.addClass("selected");var src=$target.attr("src");$("#userPreferencePhotoCont").find("img").attr("src",src),$("#user_Photo").attr("value","Avatar"),$("#userSelectedAvatarImage").val(src),$("#userSelectedProfileImage").val(""),$("#zohoAccounts").removeAttr("purpose"),$("#myComputer").removeAttr("purpose")}else if($target.is("#myComputer"))$("#zohoAccountMess").remove(),$("#uploadPhotoCont").remove(),$("#curr_UploadPhoto_Cont").remove(),$("#fgid").remove(),$("#allAvatarList").hide(),$("#myComputer").addClass("selected").siblings("li.selected").removeClass("selected"),insertBrowserOptionToUpload("userUpload",userUploadPhotoUrl);else if($target.is("#zohoAccounts"))$("#zohoAccountMess").remove(),$("#curr_UploadPhoto_Cont").remove(),$("#fgid").remove(),$("#uploadPhotoCont").remove(),$("#curr_UploadPhoto_Cont").remove(),$("#allAvatarList").hide(),$("#zohoAccounts").addClass("selected").siblings("li.selected").removeClass("selected"),insertBrowserOptionToUpload("IAM",userIAMphoto);else if($target.is("#AvatarsList")){if($("#zohoAccountMess").remove(),$("#uploadPhotoCont").remove(),$("#curr_UploadPhoto_Cont").remove(),$("#AvatarsList").addClass("selected").siblings("li.selected").removeClass("selected"),0==$("#fgid").length)$('<input type = "hidden" id="fgid" name="forumGroupId" value="'+forumGroupId+'"/>').insertAfter($('#preferenceInnerContent > form > input[name="avatar"]')).show();var selectedUrl=$("#allAvatarList").find("li.selected").find("img").attr("src");$("#userSelectedAvatarImage").attr("value",selectedUrl),$("#userSelectedProfileImage").attr("value",selectedUrl),$("#allAvatarList").show(),avatarImageFocus($("#user_AvatarImage"))}else if($targetParent.is('div[purpose="avat_Image"]')){$("#user_AvatarImage").find("li.selected").removeClass("selected"),$targetParent.removeClass("profilePhoto").addClass("profilePhotoSelected"),$("#userSelectedProfileImage").val("yes");src=$target.attr("src");$("#userPreferencePhotoCont").find("img").attr("src",src),$("#userSelectedAvatarImage").val(src),$("#zohoAccounts").removeAttr("purpose"),$("#myComputer").removeAttr("purpose")}$("#userNameChangePopUp").find('input[name="screenName"]').unbind("focus").focus(function(){$("#userNameChangePopUp").find("a.greenLink").show(),$("#userNameChangePopUp").find('span[purpose="showMsg"]').hide()})}}function insertBrowserOptionToUpload(userPhotoPref,userphoto){var userUploadPhotoUrl=$("#preferenceInnerContent").find("form").attr("userUploadPhotoUrl"),userIAMphoto=$("#preferenceInnerContent").find("form").attr("userIAMphoto");if("IAM"==userPhotoPref){var $uploadPhoto=$("#uploadPhoto_Cont").clone();$uploadPhoto.insertAfter($("#user_AvatarImage").find("ul")).show(),$uploadPhoto.attr("id","curr_UploadPhoto_Cont"),$uploadPhoto.attr("purpose","userPhotoTemplate"),$uploadPhoto.find('div[purpose="uploadPhotoContent"]').wrap('<form action = "/uploadUserPhoto.do" style="margin-left:230px;margin-top:-30px;margin-right:100px;" target = "fileUpdTgt_user" method="post" enctype="multipart/form-data"></form>'),$uploadPhoto.find("div.iFrameContainer").html('<iframe name = "fileUpdTgt_user"> </iframe>'),$uploadPhoto.find("form").attr("target","fileUpdTgt_user"),($forumgrouphiddenfield=$('<input type = "hidden"  name="forumGroupId" value="'+forumGroupId+'"/>')).insertAfter($("#curr_UploadPhoto_Cont").find('div[purpose="uploadPhotoContent"]')),$("#curr_UploadPhoto_Cont").find('div[purpose="uploadName"]').html(i18n["zohodiscussions.userProfile.zohoImage"]),$uploadPhoto.find(":file").change(function(){$uploadPhoto.find('[purpose="uploadPhotoLoadingCont"]').show(),$uploadPhoto.find(':input[name="attacher"]').val(""),$uploadPhoto.find("form").get(0).submit()});var profileselected="profilePhoto";void 0!==$("#zohoAccounts").attr("purpose")&&(profileselected="profilePhotoSelected"),$('<div class="'+profileselected+'"  imgpurpose="IAMPhotoSelected"><img height="48" width="48" purpose="avat_Image" src="'+userIAMphoto+'"/></div>').insertBefore($("#curr_UploadPhoto_Cont").find("form")),$('<div class="boldText" style="margin-left:120px;margin-top:-45px;margin-right:100px;">'+i18n["zohodiscussions.userpreference.changePhoto"]+":</div>").insertAfter($("#curr_UploadPhoto_Cont").find('div[imgpurpose="IAMPhotoSelected"]')),$("#curr_UploadPhoto_Cont").find('div[imgpurpose="IAMPhotoSelected"]').click(function(){var userIAMphoto=$("#preferenceInnerContent").find("form").attr("userIAMphoto");$("#userPreferencePhotoCont").find("img").attr("src",userIAMphoto);$("#userPreferencePhotoCont").attr("currentPref");"userUpload"&&($("#myComputer").removeAttr("purpose"),$("#zohoAccounts").attr("purpose","iamUploadselected")),$("#user_Photo").attr("value","IAM"),$("#allAvatarList").find("li.selected").removeClass("selected"),$("#curr_UploadPhoto_Cont").find("div.profilePhoto").removeClass("profilePhoto").addClass("profilePhotoSelected")}),$("#iamImageSize").show().siblings().hide(),$('<div id="zohoAccountMess" style="padding:50px;margin-left:50px;"><p class="innerInfo tinyText"><span>'+i18n["zohodiscussions.userpreference.uploadzohoAccountMess"]+"</span></p></div>").insertAfter($("#curr_UploadPhoto_Cont"))}else if("userUpload"==userPhotoPref){var $uploadPhotoPreference=$("#uploadPhoto_Cont").clone();$uploadPhotoPreference.insertAfter($("#user_AvatarImage").find("ul")).show(),$uploadPhotoPreference.attr("id","uploadPhotoCont"),$uploadPhotoPreference.attr("purpose","uploadUserPhotoTemplate"),$uploadPhotoPreference.find('div[purpose="uploadPhotoContent"]').wrap('<form action = "/uploadCustomFile.do" style="margin-left:230px;margin-top:-30px;margin-right:100px;" target = "fileUpdTgt_user" method="post" enctype="multipart/form-data"></form>'),$uploadPhotoPreference.find(':input[type="file"]').attr("name","imageFileName"),$uploadPhotoPreference.find("div.iFrameContainer").html('<iframe name = "fileUpdTgt_user"> </iframe>'),$uploadPhotoPreference.find("form").attr("target","fileUpdTgt_user");var $forumgrouphiddenfield=$('<input type = "hidden"  name="forumGroupId" value="'+forumGroupId+'"/>'),$portalzaidhiddenfield=$('<input type = "hidden"  name="portalzaid" value="'+discussionsZaid+'"/>'),$purposehiddenfield=$(' <input type="hidden" value="uploadUserPhoto" name="purpose"/>');$forumgrouphiddenfield.insertAfter($("#uploadPhotoCont").find('div[purpose="uploadPhotoContent"]')),$portalzaidhiddenfield.insertAfter($("#uploadPhotoCont").find('div[purpose="uploadPhotoContent"]')),$purposehiddenfield.insertAfter($("#uploadPhotoCont").find('div[purpose="uploadPhotoContent"]')),$uploadPhotoPreference.find(":file").change(function(){$uploadPhotoPreference.find('[purpose="uploadPhotoLoadingCont"]').show(),$uploadPhotoPreference.find("form").get(0).submit()});profileselected="profilePhoto";void 0!==$("#myComputer").attr("purpose")&&(profileselected="profilePhotoSelected"),$('<div class="'+profileselected+'" imgpurpose="userUploadedPhotoSelected"><img height="48" width="48" purpose="avat_Image" src="'+userUploadPhotoUrl+'"/></div>').insertBefore($("#uploadPhotoCont").find("form")),$('<div class="boldText" style="margin-left:120px;margin-top:-45px;margin-right:100px;">'+i18n["zohodiscussions.userpreference.changePhoto"]+":</div>").insertAfter($("#uploadPhotoCont").find('div[imgpurpose="userUploadedPhotoSelected"]')),$("#uploadPhotoCont").find('div[imgpurpose="userUploadedPhotoSelected"]').click(function(){var userUploadPhotoUrl=$("#preferenceInnerContent").find("form").attr("userUploadPhotoUrl");$("#uploadPhotoCont").find("div.profilePhoto").removeClass("profilePhoto").addClass("profilePhotoSelected"),$("#userPreferencePhotoCont").find("img").attr("src",userUploadPhotoUrl),$("#user_Photo").attr("value","userUpload"),$("#allAvatarList").find("li.selected").removeClass("selected");$("#userPreferencePhotoCont").attr("currentPref");"IAM"&&($("#zohoAccounts").removeAttr("purpose"),$("#myComputer").attr("purpose","userUploadselected"))}),$("#customImageSize").show().siblings().hide()}}function uploadUserPhoto(result,reason){if($("#curr_UploadPhoto_Cont").find('img[purpose="uploadPhotoLoadingCont"]').remove(),"failure"==result)showMessage(reason+" ,Please try again.","failure");else{$("#curr_UploadPhoto_Cont").find('input[name="uploadPhotoFile"]').val("");var src=$("#preferenceInnerContent").find("form").attr("photoUrl")+"/file?t=user&width=48&height=48&ID="+ZUID+"&nocache=1";$("#curr_UploadPhoto_Cont").find('img[purpose="avat_Image"]').attr("src",src),$("#userSelectedAvatarImage").attr("value",src),$("#userSelectedProfileImage").attr("value",src),$("#preferenceInnerContent").find("form").attr("userIAMphoto",src),$("#userPreferencePhotoCont").find("img").attr("src",src),$("#curr_UploadPhoto_Cont").find("div.profilePhoto").removeClass("profilePhoto").addClass("profilePhotoSelected"),$("#user_Photo").attr("value","IAM"),$("#allAvatarList").find("li.selected").removeClass("selected"),showTipper(i18n["zohodiscussions.userpreference.uploadsuccessMess"],"success",1e3),processHash("myArea/preference")}}function updateUserPreference(){if($("#userAvatarList").is(":focus")){var $listAvatarUl=$("#imgContUl"),src=$listAvatarUl.find("li.listAvatarSelected").find("img").attr("src");$listAvatarUl.find('input[name="avatar"]').val(src)}var $wikiUrl=$("#wikiUrl"),$blogUrl=$("#blogUrl"),$webSite=$("#webSite"),wikiURL=sanitizeURL($.trim(""+$wikiUrl.val())),blogURL=sanitizeURL($.trim(""+$blogUrl.val())),website=sanitizeURL($.trim(""+$webSite.val()));$wikiUrl.val(wikiURL),$blogUrl.val(blogURL),$webSite.val(website);var $twitterLink=$("#twitterLink"),$facebookLink=$("#facebookLink"),$linkedinLink=$("#linkedinLink"),twitterLink=sanitizeURL($.trim(""+$twitterLink.val())),facebookLink=sanitizeURL($.trim(""+$facebookLink.val())),linkedinLink=sanitizeURL($.trim(""+$linkedinLink.val()));$twitterLink.val(twitterLink),$facebookLink.val(facebookLink),$linkedinLink.val(linkedinLink),doAjaxAction("/updateUserSetting.do",$("#preferenceInnerContent").find("form").serialize(),function(data){if("SUCCESS"==data){showTipper(i18n["zohodiscussions.userpreference.userprofileupdated"],"success");var currSrc=$("#userSelectedAvatarImage").val();$("#topContainerPhoto").find("img").attr("src",currSrc),isEmbedService()?authorProfileEmbedClickAction("myarea"):processHash("myArea/preference")}},function(err){showMessage(toEvaluateData(err.responseText).reason,"failure")})}function editDraftPost($target){showLoadingImage();var authorId=$target.attr("authorId"),forumTopicId=$target.attr("forumTopicId"),options={};options.forumGroupId=forumGroupId,options.forumTopicId=forumTopicId,options[csrfParamName]=csrfToken,options.editMode="true";var forumId=$target.attr("forumId"),categoryId=$target.attr("categoryId");authorId==ZUID&&(options.access="author"),doAjaxAction("/editDraft.do",options,function(data){if(hideLoadingImage(),document.title=i18n["zohodiscussions.writePost.documentTitle"]+" - "+forumGroupName,$("#mainContent").get(0).innerHTML=data,$("#SelectForum").val(forumId),initWritePost(),$("#SelectCategory").val(categoryId),isAutoSuggestEnabled){var tags=$("#forumTags").val();tags=null!=tags?tags.split(","):[];for(var tagcounter=0;tagcounter<tags.length-1;tagcounter++)addTagsToContainer(tags[tagcounter],$("#forumTags"),$("#forumallTags"))}},function(errordata){showMessage(toEvaluateData(errordata.responseText).reason,"failure"),hideLoadingImage()})}function myJournalsDeletePost($target,tabType){var authorId=$target.attr("authorId"),action=$target.attr("action"),options={};options.forumGroupId=forumGroupId,options.forumId=$target.attr("forumId"),options.categoryId=$target.attr("categoryId"),options.forumTopicId=$target.attr("forumTopicId"),options[csrfParamName]=csrfToken,"/deleteForumResponse.do"==action&&(options.responseId=$target.attr("responseId")),authorId==ZUID&&(options.access="author"),doAjaxAction(action,options,function(data){hideLoadingImage(),showTipper("/deleteForumResponse.do"==action?i18n["zohodiscussions.myJournals.successfullyTopicDeleted"]:i18n["zohodiscussions.myJournals.successfullyResponseDeleted"],"success"),$target.parents("div.moderateSinglePost").hide()},function(err){showMessage(toEvaluateData(err.responseText).reason,"failure"),hideLoadingImage()})}function myJournalsFilter($target,tabType){var filterType=$target.attr("purpose"),$currShowList=$("#"+tabType+"InnerContent").find('div[status="show"]');$currShowList.attr("currFilterType",$target.text()),$currShowList.attr("filterType",filterType),$currShowList.find("div.moderateSinglePost").hide();var totalPost=-1;$listOfTypes="all"==filterType?$currShowList.find("div.moderateSinglePost"):$currShowList.find("div."+filterType),$listOfTypes.each(function(index,item){index<postPerPage&&$(item).show(),totalPost=index}),"watchList"==tabType&&(tabType="watchTopic"),postPerPage>totalPost||-1==totalPost?$("#"+tabType+"Next").removeClass("navBtnEnabled").addClass("navBtnDisabled"):$("#"+tabType+"Next").removeClass("navBtnDisabled").addClass("navBtnEnabled");var $prevButton=$("#"+tabType+"Prev");$prevButton.removeClass("navBtnEnabled").addClass("navBtnDisabled"),$prevButton.parent("ul").attr("fetchPage",1),-1==totalPost?($("#"+tabType+"FilterEmptyMsg").show(),$("#"+tabType+"_Nav").hide()):($("#"+tabType+"FilterEmptyMsg").hide(),$("#"+tabType+"_Nav").show())}function myJournalsFilterAction($target,tabType){var $targetParent=$target.parent(),$currShowList=($target.attr("purpose"),$("#"+tabType+"InnerContent").find('div[status="show"]')),filterText=$target.text();$currShowList.attr("currFilterType",filterText);var postType=$("#"+tabType+"Tab").find("li.selected").attr("purpose");showLoadingImage();var action=$targetParent.attr(postType+"Action"),options={};options.forumGroupId=forumGroupId,options.userId=$targetParent.attr("userId"),options.filterType=filterText,options[csrfParamName]=csrfToken,doAjaxAction(action,options,function(data){if(hideLoadingImage(),$currShowList.get(0).innerHTML=data,"myJournals"==tabType){var $currentSelectAction=$("#"+tabType+"SelectAction");$currentSelectAction.find('li[purpose="expandedView"]').html("<a class=underline href=javaScript:;>"+i18n["zohodiscussions.myArea.expandView"]+"</a>"),$currentSelectAction.find('li[purpose="listView"]').html("<span class=boldText>"+i18n["zohodiscussions.myArea.listView"]+"</span>")}},function(err){showMessage(toEvaluateData(err.responseText).reason,"failure"),hideLoadingImage()})}function replyToPrivateMsg($this){var $newReplyEditor=$("#newReplyPrivateMsgCont");if(!$newReplyEditor.is(":visible")){var type=$this.attr("postType"),forumTopicId=$this.attr("forumTopicId"),$newPMLocation=$("#privateMsgCont_"+forumTopicId),action=($("#privateMsg"+type+"Container"),"reply"),toMember=$this.attr("toMember"),purpose=$this.attr("purpose"),responseId=-1,responseAuthor="";"Sent"==type&&$("#topicContent_"+forumTopicId).hide(),$newPMLocation.show(),"editThisPM"==purpose?($("#PrivateMsgReply").hide(),$("#PrivateMsgEdit").show()):($("#PrivateMsgReply").show(),$("#PrivateMsgEdit").hide());var $replyPMArea=$("#replyPrivateMsgContent");($newReplyEditor=$replyPMArea.clone()).attr("id","newReplyPrivateMsgCont"),$newReplyEditor.find("#PrivateMsgReply").attr("id","newPrivateMsgReply"),$newReplyEditor.find("#PrivateMsgEdit").attr("id","newPrivateMsgEdit"),$newReplyEditor.find("#cancelPrivateReplyButton").attr("id","newcancelPrivateReplyButton");action="";var $pmReplyContent=$newReplyEditor.find('textarea[name="privateMsgContent"]'),$pmReplyToMember=$newReplyEditor.find('input[name="toMemberName"]'),$pmReplyTitle=$newReplyEditor.find('input[name="forumPostTitle"]'),postTitle="",editContent=$("#privateMsg_"+forumTopicId).html();return"editThisPM"==purpose?(responseId=$this.attr("responseId"),$pmReplyToMember.parent().hide(),postTitle=$this.attr("postTitle"),$pmReplyTitle.val(postTitle),action="/editPrivateMsg.do",$("#privateMsg_"+forumTopicId).hide()):(responseAuthor=$this.attr("toMemberName"),$pmReplyToMember.val(responseAuthor),$pmReplyTitle.parent().hide(),action="/replyToPM.do"),$pmReplyContent.val(editContent),$newReplyEditor.find('input[name="toMember"]').val(toMember),$newReplyEditor.find('input[name="forumTopicId"]').val(forumTopicId),$newReplyEditor.find('input[name="responseId"]').val(responseId),$newPMLocation.append($newReplyEditor.show()),$("#newPrivateMsgReply, #newPrivateMsgEdit").unbind("click").click(function(){if("editThisPM"==purpose&&""==$.trim($pmReplyTitle.val()))return void showMessage(i18n["zohodiscussions.writePost.noTitleInPost"],"failure");""!=$.trim($pmReplyContent.val())?doAjaxAction(action,$newReplyEditor.find("form").serialize(),function(data){showTipper(i18n["zohodiscussions.privateMsg.successfullyPMAdded"],"success"),"editThisPM"==purpose?($("#privateMsg_"+forumTopicId).html($pmReplyContent.val()),$("#topicContent_"+forumTopicId).html($pmReplyContent.val()),$("#editPrivateMsg_"+forumTopicId).attr("postTitle",$pmReplyTitle.val()),$("#privateMsgPostTitle_"+forumTopicId).html($pmReplyTitle.val()),$("#newcancelPrivateReplyButton").trigger("click")):processHash("myArea/privateMsg")},function(err,desc,exceptionobj){$newReplyEditor.find("div#writePMCaptcha").attr("id","newWritePMCaptcha");var responseData=toEvaluateData(err.responseText);if("HIP_REQUIRED"==responseData.errorcode){var $writePMCaptcha=$("#newWritePMCaptcha");$writePMCaptcha.find("input#captchaCodePM").attr("id","newCaptchaCodePM"),$writePMCaptcha.show(),"new"==$writePMCaptcha.attr("currCaptcha")?showMessage(i18n["zohodiscussions.writePost.captchaMsg"],"failure"):showMessage(i18n["zohodiscussions.writePost.captchaErrorMsg"],"failure"),$writePMCaptcha.find('img[purpose="captchaImage"]').replaceWith("<img purpose=captchaImage name=hipImg border=0 src=/showcaptcha?digest="+responseData.reason+" align=absmiddle alt=HIP image>"),$("#newCaptchaCodePM").attr("name",responseData.reason),$writePMCaptcha.attr("currCaptcha","old"),$writePMCaptcha.show()}else showMessage(responseData.reason,"failure");hideLoadingImage()}):showMessage(i18n["zohodiscussions.writePost.noContentInPost"],"failure")}),$("#newcancelPrivateReplyButton").click(function(){$("#privateMsgCont_"+forumTopicId).hide(),$newReplyEditor.remove(),"editThisPM"==purpose&&$("#privateMsg_"+forumTopicId).show()}),!1}showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"info")}function addPrivateMsg(forumTopicId,editorMode,responseId,type){(showLoadingImage(),"UserPM"==type)&&$("#privateMsgTab").find("li.selected").attr("isthere","false");var $postContentTA=$("#postContentTA"),postTitle="";if(editorMode&&"Edit"==editorMode&&""==(postTitle=(postTitle=$postContentTA.parent().find('input[name="forumPostTitle"]').val()).replace(/^\s+/g,"").replace(/\s+$/g,"")))return hideLoadingImage(),void showMessage(i18n["zohodiscussions.writePost.noTitleInPost"],"failure");var contentToPost=$postContentTA.data("editor").val();return""==(contentToPost=contentToPost.replace(/^\s+/g,"").replace(/\s+$/g,""))?(hideLoadingImage(),void showMessage(i18n["zohodiscussions.writePost.noContentInPost"],"failure")):($postContentTA.val(contentToPost),doAjaxAction(editorMode&&"Edit"==editorMode?"/editPrivateMsg.do":"UserPM"==type?"/addPrivateMsg.do":"/replyToPM.do",$("#editorHolder").serialize(),function(data){(hideLoadingImage(),showTipper(i18n["zohodiscussions.privateMsg.successfullyPMAdded"],"success"),"Edit"==editorMode)?($("#privateMsgCont_"+forumTopicId).parent("li").find('a[purpose="postConversationTitle"]').html(postTitle),$("#cancelResponse").trigger("click")):processHash("UserPM"==type?"user/"+$("#UserPM").attr("authorName"):"myArea/privateMsg")},function(err,desc,exceptionobj){var responseData=toEvaluateData(err.responseText);if("HIP_REQUIRED"==responseData.errorcode){var $writePostCaptcha=$("#replyPMContActual").show().find('div[purpose="responseCaptcha"]');$writePostCaptcha.find(":input").val(""),"new"==$writePostCaptcha.attr("currCaptcha")?showMessage(i18n["zohodiscussions.writePost.captchaMsg"],"failure"):showMessage(i18n["zohodiscussions.writePost.captchaErrorMsg"],"failure"),$writePostCaptcha.find('img[purpose="captchaImage"]').replaceWith("<img purpose=captchaImage name=hipImg border=0 src=/showcaptcha?digest="+responseData.reason+" align=absmiddle alt=HIP image>"),$writePostCaptcha.find(":input").attr("name",responseData.reason),$writePostCaptcha.attr("currCaptcha","old"),$writePostCaptcha.show()}else showMessage(responseData.reason,"failure");hideLoadingImage()}),!1)}function deletePrivateMsg($target){var forumTopicId=$target.attr("forumTopicId"),options={};options.forumGroupId=forumGroupId,options.forumTopicId=forumTopicId,options[csrfParamName]=csrfToken,doAjaxAction("/deletePM.do",options,function(data){hideLoadingImage(),showTipper(i18n["zohodiscussions.privateMsg.successfullyPMDeleted"],"success");var $currScreenView=$("#privateMsgTab").find("li.selected");"inbox"==$currScreenView.attr("purpose")?processHash("myArea/privateMsg"):$currScreenView.attr("isthere","false").trigger("click")},function(err){showMessage(toEvaluateData(err.responseText).reason,"failure"),hideLoadingImage()})}function privateConversation($target){var forumTopicId=$target.attr("forumTopicId"),$currPrivateCont=$("#privateConversation_"+forumTopicId).html(),$pirvateConversation=$("#privateConversation");$pirvateConversation.show(),$("#privateConversationCont").get(0).innerHTML=$currPrivateCont,$("#privateConversationClose").unbind("click").click(function(){$pirvateConversation.hide()}),$("#morePrivateConversation").unbind("click").click(function(){$pirvateConversation.hide(),showLoadingImage(),openSinglePost(forumTopicId)})}function friendsTabClick($target){$target.addClass("selected"),showLoadingImage();$target.attr("purpose");var action=$target.attr("action"),options={};options.forumGroupId=forumGroupId,doAjaxAction(action,options,function(data){hideLoadingImage(),$("#friendsInnerCont").get(0).innerHTML=data,setPresenceInMyArea(dataOb,"friendsDetailsInnerContent")})}function myAreaAllTabClick($this,parentName){var $currentShowingInnerContent=$("#"+parentName+"InnerContent"),$currentList=$currentShowingInnerContent.find('div[status="show"]');$this.addClass("selected"),"resources"==(purpose=$this.attr("purpose"))?$("#myAreaInnerMainContent").find("div.contentActionsCont").hide():$("#myAreaInnerMainContent").find("div.contentActionsCont").show();var isthere=$this.attr("isthere"),$requiredList=$currentShowingInnerContent.find('div[purpose="author_'+purpose+'"]');if($currentList.attr("status","hide").hide(),"authorProfile"==parentName&&("privateMsg"==purpose?$("#authorProfileContentAction").hide():$("#authorProfileContentAction").show()),"watchList"==parentName&&("watchTopics"!=purpose?$("#"+parentName+"_Filter").parent().hide():$("#"+parentName+"_Filter").parent().show()),"myJournals"==parentName||"privateMsg"==parentName||"authorProfile"==parentName){var $currentShowingSelectAction=$("#"+parentName+"SelectAction");if("true"==isthere){if("myJournals"==parentName||"authorProfile"==parentName){var $myJournalsFilter=$("#"+parentName+"_Filter");if("replies"==purpose||"authorReplies"==purpose)$myJournalsFilter.parent().hide();else{$myJournalsFilter.parent().show();var currFilterType=$requiredList.attr("currFilterType");$myJournalsFilter.val(currFilterType)}}if($requiredList.attr("status","show").show(),0<$requiredList.find("div.collapse").length?($currentShowingSelectAction.find('li[purpose="expandedView"]').html("<a class=underline href=javaScript:;>"+i18n["zohodiscussions.myArea.expandView"]+"</a>"),$currentShowingSelectAction.find('li[purpose="listView"]').html("<span class=boldText>"+i18n["zohodiscussions.myArea.listView"]+"</span>")):0<$requiredList.find("div.expand").length&&($currentShowingSelectAction.find('li[purpose="expandedView"]').html("<span class=boldText>"+i18n["zohodiscussions.myArea.expandView"]+"</span>"),$currentShowingSelectAction.find('li[purpose="listView"]').html("<a class=underline href=javaScript:;>"+i18n["zohodiscussions.myArea.listView"]+"</a>")),"privateMsg"==parentName)if("undefined"!=typeof WmsContacts&&"true"==ch)setPresenceInMyArea(WmsContacts.getZohoContacts(),"userChat_"+purpose);return}}else if("true"==isthere){if($requiredList.attr("status","show").show(),"watchList"==parentName)if("undefined"!=typeof WmsContacts&&"true"==ch)setPresenceInMyArea(WmsContacts.getZohoContacts(),"userChat_"+purpose);return}showLoadingImage();var purpose=$this.attr("purpose"),action=$this.attr("action"),options={};"privateMsg"!=purpose&&(options.forumGroupId=forumGroupId,options[csrfParamName]=csrfToken,"myJournals"!=parentName&&"authorProfile"!=parentName||(options.userId=$this.attr("userId"))),"myJournals"==parentName&&(options.viewType="myself"),doAjaxAction(action,options,function(data){var $data;if(hideLoadingImage(),"myJournals"==parentName||"authorProfile"==parentName){$data=$("<div purpose=author_"+purpose+" status=show currFilterType=all></div>").html(data);var $currFilter=$("#"+parentName+"_Filter");"replies"==purpose||"authorReplies"==purpose?$currFilter.parent().hide():($currFilter.parent().show(),$currFilter.val("All"))}else $data=$("<div purpose=author_"+purpose+" status=show id=userChat_"+purpose+"></div>").html(data);(hideLoadingImage(),showAuthorPopout($data),$data.insertAfter($currentList),$this.attr("isthere","true"),"drafts"===purpose||"inbox"===purpose||"sent"===purpose||"authorTopics"===purpose||"replies"===purpose?($currentShowingSelectAction.find('li[purpose="expandedView"]').html("<a class=underline href=javaScript:;>"+i18n["zohodiscussions.myArea.expandView"]+"</a>"),$currentShowingSelectAction.find('li[purpose="listView"]').html("<span class=boldText>"+i18n["zohodiscussions.myArea.listView"]+"</span>")):"authorReplies"===purpose&&($currentShowingSelectAction.find('li[purpose="expandedView"]').html("<span class=boldText>"+i18n["zohodiscussions.myArea.expandView"]+"</span>"),$currentShowingSelectAction.find('li[purpose="listView"]').html("<a class=underline href=javaScript:;>"+i18n["zohodiscussions.myArea.listView"]+"</a>")),"privateMsg"==parentName||"watchList"==parentName)&&("undefined"!=typeof WmsContacts&&"true"==ch&&setPresenceInMyArea(WmsContacts.getZohoContacts(),"userChat_"+purpose))},function(err){showMessage(toEvaluateData(err.responseText).reason,"failure"),hideLoadingImage()})}function manageExpandOrCollapseType($target,parentName){var purpose=$target.attr("purpose");if(!($target.find("a").length<1)){var $currentShowingInnerContent=$("#"+parentName+"InnerContent"),$currentShowingSelectAction=$("#"+parentName+"SelectAction"),currentShowList=$currentShowingInnerContent.find('div[status="show"]');"expandedView"==purpose?(currentShowList.find("div.collapse").attr("class","expand"),currentShowList.find("div.expand div.bigPlusIcon").removeClass("bigPlusIcon").addClass("bigMinusIcon"),currentShowList.find("div.textContent").addClass("expandTextContent").show(),currentShowList.find("div.moderateSinglePost div.lowerButton").show(),$currentShowingSelectAction.find('li[purpose="expandedView"]').html("<span class=boldText>"+i18n["zohodiscussions.myArea.expandView"]+"</span>"),$currentShowingSelectAction.find('li[purpose="listView"]').html("<a class=underline href=javaScript:;>"+i18n["zohodiscussions.myArea.listView"]+"</a>")):"listView"==purpose&&(currentShowList.find("div.expand").attr("class","collapse"),currentShowList.find("div.collapse div.bigMinusIcon").removeClass("bigMinusIcon").addClass("bigPlusIcon"),currentShowList.find("div.textContent").addClass("expandTextContent").hide(),currentShowList.find("div.moderateSinglePost div.lowerButton").hide(),$currentShowingSelectAction.find('li[purpose="expandedView"]').html("<a class=underline href=javaScript:;>"+i18n["zohodiscussions.myArea.expandView"]+"</a>"),$currentShowingSelectAction.find('li[purpose="listView"]').html("<span class=boldText>"+i18n["zohodiscussions.myArea.listView"]+"</span>"))}}function manageCountValue(selectTab){var currSelectedTab=$("#"+selectTab).find("li.selected"),count=currSelectedTab.attr("count");count=--count;var purpose=currSelectedTab.attr("purpose");"watchTopics"==purpose?currSelectedTab.find("a").html(i18n["zohodiscussions.myJournals.topics"]+"("+count+")"):"authorReplies"==purpose?currSelectedTab.find("a").html(i18n["zohodiscussions.general.replies"]+"("+count+")"):"watchUsers"==purpose?currSelectedTab.find("a").html(i18n["zohodiscussions.watchList.users"]+"("+count+")"):"inbox"==purpose?currSelectedTab.find("a").html(i18n["zohodiscussions.privateMsg.inbox"]+"("+count+")"):"sent"==purpose?currSelectedTab.find("a").html(i18n["zohodiscussions.privateMsg.sent"]+"("+count+")"):"watchForums"==purpose?currSelectedTab.find("a").html(i18n["zohodiscussions.general.forums"]+"("+count+")"):"watchCategories"==purpose&&currSelectedTab.find("a").html(i18n["zohodiscussions.myArea.subForums"]+"("+count+")"),currSelectedTab.attr("count",count)}function fnPagination($target,navType,authorProfile){showLoadingImage();var action=$target.attr("action"),currType=$target.attr("currType"),options={};"true"==authorProfile&&(currType="authorProfile");var currShowPage=$("#"+currType+"InnerContent").find('div[status="show"]');if(options.forumGroupId=forumGroupId,"privateMsg"!=currType){options.userId=$target.attr("userId");var postType=$("#"+currType+"Tab").find("li.selected").attr("purpose");"topics"!=postType&&"drafts"!=postType&&"authorTopics"!=postType||(options.filterType=currShowPage.attr("currfiltertype"))}"myJournals"==currType&&(options.viewType="myself");var fetchPage=parseInt($target.attr("fetchPage"));options.fetchPage="next"==navType?fetchPage+1:fetchPage-1,options.getPostFor=$target.attr("getPostFor"),doAjaxAction(action,options,function(data){hideLoadingImage(),currShowPage.get(0).innerHTML=data;var currSelectTab=$("#"+currType+"Tab").find("li.selected").attr("purpose"),$currentSelectAction=$("#"+currType+"SelectAction");"replies"==currSelectTab?($currentSelectAction.find('li[purpose="expandedView"]').html("<span class=boldText>"+i18n["zohodiscussions.myArea.expandView"]+"</span>"),$currentSelectAction.find('li[purpose="listView"]').html("<a class=underline href=javaScript:;>"+i18n["zohodiscussions.myArea.listView"]+"</a>")):($currentSelectAction.find('li[purpose="expandedView"]').html("<a class=underline href=javaScript:;>"+i18n["zohodiscussions.myArea.expandView"]+"</a>"),$currentSelectAction.find('li[purpose="listView"]').html("<span class=boldText>"+i18n["zohodiscussions.myArea.listView"]+"</span>"))},function(err){showMessage(toEvaluateData(err.responseText).reason,"failure"),hideLoadingImage()})}function fnPaginationProcess($target,type){var fetchPage=parseInt($target.attr("fetchPage")),currType=$target.attr("currType"),postCount=$target.attr("postCount");"next"==type?fetchPage+=1:fetchPage-=1,$target.attr("fetchPage",fetchPage);var $currShowList=$("#current_"+currType+"_List"),endPost=fetchPage*postPerPage,startPost=endPost-postPerPage+1,count=startPost;if(postCount<=endPost?(endPost=postCount,$target.find('li[purpose="next"]').removeClass("navBtnEnabled").addClass("navBtnDisabled")):$target.find('li[purpose="next"]').removeClass("navBtnDisabled").addClass("navBtnEnabled"),1==startPost?$target.find('li[purpose="prev"]').removeClass("navBtnEnabled").addClass("navBtnDisabled"):$target.find('li[purpose="prev"]').removeClass("navBtnDisabled").addClass("navBtnEnabled"),"recentActivity"==currType)for($currShowList.find("li").hide();count<=endPost;count++)$("#recentActivity_"+count).show();else{$currShowList.find("div.moderateSinglePost").hide();var currViewType=currType;"watchTopic"==currType&&(currType="watchList");var filterType=$("#"+currType+"InnerContent").find('div[status="show"]').attr("filterType");if("watchList"!=currType&&"bookMark"!=currType||"all"==filterType)for(;count<=endPost;count++)$currShowList.find('div.moderateSinglePost[listStage="'+currViewType+"_"+count+'"]').show();else $listOfTypes=$currShowList.find("."+filterType),count--,$listOfTypes.each(function(index,item){index<endPost&&count<=index&&$(item).show(),index})}}function getAuthorProfile(authorName){showLoadingImage();var $userProfileMainContainer=$("#userProfileMainContainer");if(0<$userProfileMainContainer.length&&$userProfileMainContainer.is('[shouldReload="false"]'))$userProfileMainContainer.show().attr("shouldReload","true").siblings().remove(),hideLoadingImage();else{var options={};options.forumGroupId=forumGroupId,options.authorName=authorName,options[csrfParamName]=csrfToken,options.ch=ch,doAjaxAction("/getAuthorProfile.do",options,function(data){hideLoadingImage(),$("#authorPopout:visible").hide(),$("#mainContent").get(0).innerHTML=data,$.history.add("User/"+authorName),bindAuthorProfileActions(authorName)},function(err){showMessage(toEvaluateData(err.responseText).reason,"failure"),hideLoadingImage()})}}function bindAuthorProfileActions(authorName){$("#mainContent").unbind("click",processAuthorProfileClick).click(processAuthorProfileClick),$("#mainContent").unbind("click",processAllMyAreaMainClick).click(processAllMyAreaMainClick),$("#mainContent").unbind("click",processAllActionClick).click(processAllActionClick),lightBox("#authorProfileInnerContent"),allFilterOption("authorProfile"),lightBox("#authorProfileInnerContent");var authorId=$("#mainContent > #userProfileMainContainer").attr("authorId");if($("#authorPopout_"+authorId).hide(),"undefined"!=typeof WmsContacts&&"true"==ch&&!isTopicQuickView){var authStatus=WmsContacts.status(authorId);!1===authStatus&&(authStatus=9),manageUserChatStatus("userOnlineStatus_"+authorId,authStatus)}initialiseUserActivityChart()}function processAuthorProfileClick(event){var $targetParent=$(event.target).parent();$("#loadingImg").is(":visible")||$("#discussChartLoading").is(":visible")||($targetParent.is('li[purpose="sendPM"]')?addPrivateMessage($targetParent):$targetParent.is('li[purpose="watchItem"]')?watchItem($targetParent):$targetParent.is('li[purpose="addAsFriend"]')?addAsFriend($targetParent):$targetParent.is('li[purpose="blockUser"]')?blockUser($targetParent):$targetParent.is('li[purpose="unBlockUser"]')?unBlockUser($targetParent):$targetParent.is('li[purpose="moderateUser"]')?moderateUser():$targetParent.is('li[purpose="assignLabel"]')&&bindUserLabelsAction())}function writePrivateMsg(){var $editTopicCont=$("#sentPrivateMsg"),$topicContainer=$("#editorContainer_PM");if($topicContainer.data("inEditMode"))return showMessage(i18n["zohodiscussions.singlepost.alertmessageforediting"],"failure"),!1;$editTopicCont.show(),openEditor($("#editPM"),"privateMsgContent","postContentTA","UserPM","Write","editorContainer_PM"),$topicContainer.data("inEditMode",!0)}function watchItem($target){showLoadingImage();var itemType=$target.attr("watchItemType"),options={};options.forumGroupId=forumGroupId,options.watchItemType=itemType,options.watchItemId=$target.attr("watchItemId"),options[csrfParamName]=csrfToken,doAjaxAction("/watchItem.do",options,function(data){hideLoadingImage(),showTipper(i18n["0"==itemType?"zohodiscussions.singlepost.watchTopicSuccessMsg":"zohodiscussions.generalmessage.userAddedToWatchlist"],"success"),$target.attr("purpose","unWatchItem"),$target.find("a").html(i18n["zohodiscussions.userProfile.unwatchUser"])},function(err){showMessage(toEvaluateData(err.responseText).reason,"failure"),hideLoadingImage()})}function unWatchItem($target,type){showLoadingImage();type=$target.attr("unWatchType");var itemId=$target.attr("watchItemId"),options={};options.forumGroupId=forumGroupId,options.watchItemId=itemId,options[csrfParamName]=csrfToken,doAjaxAction("/unWatch.do",options,function(data){hideLoadingImage(),"authorProfile"==type?(showTipper(i18n["zohodiscussions.generalmessage.userRemovedFromWatchlist"],"success"),$target.attr("purpose","watchItem"),$target.find("a").html(i18n["zohodiscussions.userProfile.watchUser"])):"following"==type?(showTipper(i18n["zohodiscussions.generalmessage.userRemovedFromWatchlist"],"success"),$("#watch_"+itemId).parents("li").remove()):(showTipper(i18n["zohodiscussions.singlepost.unwatchTopicSuccessMsg"],"success"),$target.parents("div#watch_"+itemId).remove(),manageCountValue("watchListTabs"))},function(err){showMessage(toEvaluateData(err.responseText).reason,"failure"),hideLoadingImage()})}function addAsFriend($target){showLoadingImage();var successMsg=$target.attr("successMsg"),options={};options.forumGroupId=forumGroupId,options.userId=$target.attr("userId"),options[csrfParamName]=csrfToken,doAjaxAction("/addAsFriend.do",options,function(data){hideLoadingImage(),"SUCCESS"==data&&($target.attr("purpose","friendWaitingApproval"),$("#addAsFriendLink").attr("style","cursor:default;text-decoration:none;").html(i18n["zohodiscussions.friends.awaitingApproval"]).siblings("div.imgAddFriend").removeClass("imgAddFriend").addClass("imgWaitingFriend"),showTipper(successMsg,"success"))},function(err){showMessage(toEvaluateData(err.responseText).reason,"failure"),hideLoadingImage()})}function confirmFriendRequest($target){showLoadingImage();var userId=$target.attr("userId"),successMsg=$target.attr("successMsg"),options={};options.forumGroupId=forumGroupId,options.userId=userId,options[csrfParamName]=csrfToken,doAjaxAction("/confirmFriendRequest.do",options,function(data){hideLoadingImage(),showTipper(successMsg,"info");var $friendCont=$("#friendId_"+userId);if(0<$friendCont.length){var $otherFriends=$friendCont.siblings("div.moderateSinglePost");$friendCont.fadeOut().remove(),$('#friendsDetailsTabs li.selected span[purpose="friendsCount"]').html($otherFriends.length);var actualFriendsCount=$('#friendsDetailsTabs li span[mainPurpose="approvedFriends"]').text();actualFriendsCount=parseInt(actualFriendsCount),actualFriendsCount++,$('#friendsDetailsTabs li span[mainPurpose="approvedFriends"]').html(actualFriendsCount)}else location.reload()},function(err){showMessage(toEvaluateData(err.responseText).reason,"failure"),hideLoadingImage()})}function removeFriend($target){var confirmMg=$target.attr("confirmMsg");if(confirm(confirmMg)){showLoadingImage();var userId=$target.attr("userId"),successMsg=$target.attr("successMsg"),options={};options.forumGroupId=forumGroupId,options.userId=userId,options[csrfParamName]=csrfToken,doAjaxAction("/removeFriend.do",options,function(data){hideLoadingImage(),showTipper(successMsg,"info");var $friendCont=$("#friendId_"+userId);if(0<$friendCont.length){var $otherFriends=$friendCont.siblings("div.moderateSinglePost");$friendCont.fadeOut().remove(),$('#friendsDetailsTabs li.selected span[purpose="friendsCount"]').html($otherFriends.length)}else location.reload()},function(err){showMessage(toEvaluateData(err.responseText).reason,"failure"),hideLoadingImage()})}}function blockUser($target){showLoadingImage();var options={};options.forumGroupId=forumGroupId,options.authorId=$target.attr("authorId"),options[csrfParamName]=csrfToken,doAjaxAction("/blockUser.do",options,function(data){if("SUCCESS"===data)hideLoadingImage(),showTipper(i18n["zohodiscussions.userProfile.successfullyBlockUser"],"success"),$target.attr("purpose","unBlockUser"),$target.find("a").html(i18n["zohodiscussions.userProfile.unblockUser"]);else if(0<data.indexOf("'result':'failure'")){showMessage(toEvaluateData(data).reason,"failure")}},function(err){showMessage(toEvaluateData(err.responseText).reason,"failure"),hideLoadingImage()})}function unBlockUser($target){showLoadingImage();var options={};options.forumGroupId=forumGroupId,options.authorId=$target.attr("authorId"),options[csrfParamName]=csrfToken,doAjaxAction("/unBlockUser.do",options,function(data){if("SUCCESS"===data)hideLoadingImage(),showTipper(i18n["zohodiscussions.userProfile.successfullyUnBlockUser"],"success"),$target.attr("purpose","blockUser"),$target.find("a").html(i18n["zohodiscussions.userProfile.blockUser"]);else if(0<data.indexOf("'result':'failure'")){showMessage(toEvaluateData(data).reason,"failure")}},function(err){showMessage(toEvaluateData(err.responseText).reason,"failure"),hideLoadingImage()})}function moderateUser(){$("#moderateUserTemplate").html($("#dimDivModerateUser").html()),$("#dimDivModerateUser").html(""),$("#moderateUserTemplate").show();var $forumCont=$("#eachForumListForModeration").find(":input[name='forumLevelModeration']"),$portalCont=$("#moderateUserPopOutForm").find(":input[name='portalLevelModeration']");0==$forumCont.length&&$("#forumLabel").hide(),$portalCont.attr("checked")&&$forumCont.attr("disabled",!0),$("#imgCancel").click(function(){var authorName=$(this).attr("authorName");if(isZSupport)authorProfileEmbedClickAction("user",authorName);else if("false"==isTopicQuickView)return void(location.href=serverURL+"/user/"+authorName);($("#dimDivModerateUser").html($("#moderateUserTemplate").html()),$("#moderateUserTemplate").hide(),$("#moderateUserTemplate").html(""),"changed"==$("#moderateUserCont").attr("status"))&&($("#userProfileMainContainer").show().attr("shouldReload","true"),getAuthorProfile(authorName))}),$portalCont.click(function(){$this=$(this),$this.attr("checked")?$forumCont.attr("disabled",!0):$forumCont.attr("disabled",!1),moderateUserAction($this)}),$forumCont.click(function(){$this=$(this),moderateUserAction($this)})}function moderateUserAction($this){$("#moderateUserCont").attr("status","changed");var authorId=$this.attr("authorId"),author=$this.attr("userName"),moderteStatus=$this.attr("moderationStatus"),adminUser=$this.attr("isAdmin"),isPortal=$this.attr("isPortal"),confirmMess="",successMess="",options={};if(options.authorId=authorId,options.forumGroupId=forumGroupId,options[csrfParamName]=csrfToken,options.adminUser=adminUser,isPortal)options.moderateType=1,"unmoderated"==moderteStatus?(confirmMess=i18n["zohodiscussions.userProfile.moderateUserConfirmMess"]+" "+author+" "+i18n["zohodiscussions.userProfile.moderateUserPortalLevel"],successMess=i18n["zohodiscussions.userProfile.usermoderatedSuccessMess"]):(confirmMess=i18n["zohodiscussions.userProfile.unmoderateUserConfirmMess"]+" "+author+" "+i18n["zohodiscussions.userProfile.moderateUserPortalLevel"],successMess=i18n["zohodiscussions.userProfile.userUnmoderatedSuccessMess"]);else{options.moderateType=0;var forumId=$this.attr("forumId");options.forumId=forumId;var forumName=$this.attr("forumName");"unmoderated"==moderteStatus?(confirmMess=i18n["zohodiscussions.userProfile.moderateUserConfirmMess"]+" "+author+" "+i18n["zohodiscussions.general.in"]+" "+forumName+" "+i18n["zohodiscussions.userProfile.moderateUserForumLevel"],successMess=" "+i18n["zohodiscussions.userProfile.usermoderatedSuccessMess"]):(confirmMess=i18n["zohodiscussions.userProfile.unmoderateUserConfirmMess"]+" "+author+" "+i18n["zohodiscussions.general.in"]+" "+forumName+" "+i18n["zohodiscussions.userProfile.moderateUserForumLevel"],successMess=i18n["zohodiscussions.userProfile.userUnmoderatedSuccessMess"])}"unmoderated"==moderteStatus?confirm(confirmMess)?doAjaxAction("/moderateUser.do",options,function(data){"SUCCESS"==data?(showTipper(author+" "+successMess,"success",1e3),$this.attr("moderationStatus","moderated"),$("#imgCancel").trigger("click"),isPortal||$("#itemListCont_"+forumId).find("span.italicText").html(i18n["zohodiscussions.moderationLeftContainer.moderated"])):showMessage(i18n["zohodiscussions.moderationAction.errormessage"],"failure")}):($("#moderateUserCont").attr("status",""),isPortal?($("#moderateUserPopOutForm").find(":input[isPortal='true']").attr("checked",!1),$("#eachForumListForModeration").find(":input[name='forumLevelModeration']").attr("disabled",!1)):$("#moderateUserPopOutForm").find(":input[forumId='"+forumId+"']").attr("checked",!1)):confirm(confirmMess)?doAjaxAction("/unModerateUser.do",options,function(data){"SUCCESS"==data?(showTipper(author+" "+successMess,"success",1e3),$this.attr("moderationStatus","unmoderated"),$("#imgCancel").trigger("click"),isPortal||$("#itemListCont_"+forumId).find("span.italicText").html(i18n["zohodiscussions.ModerateUsers.ModerateUsers"])):showMessage(i18n["zohodiscussions.moderationAction.errormessage"],"failure")}):($("#moderateUserCont").attr("status",""),isPortal?($("#moderateUserPopOutForm").find(":input[isPortal='true']").attr("checked",!0),$("#eachForumListForModeration").find(":input[name='forumLevelModeration']").attr("disabled",!0)):$("#moderateUserPopOutForm").find(":input[forumId='"+forumId+"']").attr("checked",!0))}function bindUserLabelsAction(){$("#userLabelsTemplate").html($("#dimDivUserLabels").html()),$("#dimDivUserLabels").html(""),$("#userLabelsTemplate").show(),$("#closeUserLabelsDialog").click(function(){$("#dimDivUserLabels").html($("#userLabelsTemplate").html()),$("#userLabelsTemplate").hide(),$("#userLabelsTemplate").html("")}),$('#userLabelsCont select[purpose="userLabelBox"]').change(function(){var $this=$(this),labelId=($this.attr("forumId"),$this.attr("userId"),$this.val()),options={};options.forumGroupId=forumGroupId,options.forumId=$this.attr("forumId"),options.userId=$this.attr("userId"),options.labelId=$this.val(),options[csrfParamName]=csrfToken,doAjaxAction("/mapLabelToUser.do",options,function(data){if("SUCCESS"==data){$this.find("option[selected]").removeAttr("selected");var $selectedLabel=$this.find("option[value='"+labelId+"']"),labelText=$selectedLabel.text();$selectedLabel.replaceWith("<option value='"+labelId+"' selected>"+labelText+"</option>"),"-1"==labelId?showTipper(i18n["zohodiscussions.UserDetails.labelRemovedMsg"],"info"):showTipper(i18n["zohodiscussions.UserDetails.labelAddedMsg"],"success")}})})}function setPresenceInTopicList(dObj,forumTopicId){if(dObj){var $authorContainer="";forumTopicId?($authorContainer=$("#SinglePostContainer_"+forumTopicId+" div.sppostAuthor div.authorChatPresence")).each(function(index,item){var $item=$(item),userId=$item.attr("authorId");if(userId!=ZUID){var $authorContainers,responseId=$item.attr("responseId");$authorContainers=$("#uc_"+forumTopicId+"_"+responseId+"_"+userId+",#ucReply_"+forumTopicId+"_"+responseId+"_"+userId);try{manageUserChatStatusInTopicList($authorContainers,dObj[userId].STATUS,"IS_SINGLE_POST")}catch(ex){}}}):($authorContainer=0<$("#topicList").length?$("#topicList > div.ndtopicsItemsContainer > div.ndwrapperIn > ul.ndtopicsList > li.ndsingleList > div.ndhideOverflow > p.ndPostMeta > img.authorChatPresence"):$("#topicsList > div.ndtopicsItemsContainer > div.ndwrapperIn > ul.ndtopicsList > li.ndsingleList > div.ndhideOverflow > p.ndPostMeta > img.authorChatPresence"),$stickyPostAuthors=$("#recentStickyPosts >li  >div.ashColorText >div.authorChatPresence"),$announcementPostAuthors=$("#recentAnnouncementPosts >li  >div.ashColorText >div.authorChatPresence"),$authorContainer.each(function(index,item){var $item=$(item),userId=$item.attr("authorId");if(userId!=ZUID){var $authorContainers,userChatId=$item.attr("userChatId");$authorContainers=$("#uc_"+userChatId+"_"+userId);try{manageUserChatStatusInTopicList($authorContainers,dObj[userId].STATUS,"topicList")}catch(ex){}}}),$stickyPostAuthors.each(function(index,item){var $item=$(item),userId=$item.attr("authorId");if(userId!=ZUID)try{manageUserChatStatusInTopicList($item,dObj[userId].STATUS)}catch(ex){}}),$announcementPostAuthors.each(function(index,item){var $item=$(item),userId=$item.attr("authorId");if(userId!=ZUID)try{manageUserChatStatusInTopicList($item,dObj[userId].STATUS)}catch(ex){}}))}}function setPresenceInMyArea(dObj,$currLocation){if(dObj){("current_recentActivity_List"==$currLocation?$("#"+$currLocation+" >li >div.authorChatPresence"):"userChat_inbox"==$currLocation||"userChat_sent"==$currLocation?$("#"+$currLocation+" div.moderateSinglePost ul li img.authorChatPresence"):$("#"+$currLocation+" div.moderateSinglePost ul li div.authorChatPresence")).each(function(index,item){var $item=$(item),userId=$item.attr("authorId");if(userId!=ZUID)try{manageUserChatStatusInTopicList($item,dObj[userId].STATUS)}catch(ex){}})}}function setPresence(dObj,userLocation){dObj&&$("#"+userLocation+" > li > div.userChatPresence").each(function(index,item){var $item=$(item),authorId=$item.attr("authorId");if(authorId!=ZUID){var authorLocation=$item.attr("id");try{manageUserChatStatus(authorLocation,dObj[authorId].STATUS)}catch(ex){}}})}function manageUserChatStatus(authorLocation,status){var $currAuthorProfile=$("#"+authorLocation),userName=$currAuthorProfile.attr("authorName");"4"==status?($currAuthorProfile.find("div").attr("class","wms-4 chatOverride flLeft").unbind("click",chatInvoker).click(chatInvoker),$currAuthorProfile.find("a").html(i18n["zohodiscussions.chat.idleForChat"]),$currAuthorProfile.attr("title",userName+" "+i18n["zohodiscussions.chat.isNowIdle"]).unbind("click",chatInvoker).click(chatInvoker)):"3"==status?($currAuthorProfile.find("div").attr("class","wms-3 chatOverride flLeft").unbind("click",chatInvoker).click(chatInvoker),$currAuthorProfile.find("a").html(i18n["zohodiscussions.chat.busyforchat"]),$currAuthorProfile.attr("title",userName+" "+i18n["zohodiscussions.chat.isBusyToChat"]).unbind("click",chatInvoker).click(chatInvoker)):"1"==status?($currAuthorProfile.find("div").attr("class","wms-1 chatOverride flLeft"),$currAuthorProfile.find("a").html(i18n["zohodiscussions.chat.availableforchatmessage"]),$currAuthorProfile.attr("title",userName+" "+i18n["zohodiscussions.chat.isAvailableToChat"]).unbind("click",chatInvoker).click(chatInvoker)):"0"==status?($currAuthorProfile.find("div").attr("class","wms-0 chatOverride flLeft"),$currAuthorProfile.find("a").html(i18n["zohodiscussions.chat.offlineforchat"]).unbind("click",chatInvoker).click(chatInvoker),$currAuthorProfile.attr("title",i18n["zohodiscussions.chat.offlineforchat"]).unbind("click",chatInvoker).click(chatInvoker)):"-1"==status?($currAuthorProfile.find("div").attr("class","imgAddContact flLeft"),$currAuthorProfile.find("a").html(i18n["zohodiscussions.chat.invitedforchat"]),$currAuthorProfile.attr("title",i18n["zohodiscussions.chat.youHaveInvited"]+" "+userName+" "+i18n["zohodiscussions.chat.toChat"]).unbind("click",chatInvoker)):"-3"==status&&($currAuthorProfile.find("div").attr("class","imgAddContact flLeft"),$currAuthorProfile.find("a").html(i18n["zohodiscussions.chat.acceptinvitationforchat"]),$currAuthorProfile.attr("title",userName+" "+i18n["zohodiscussions.chat.youHaveInvited"]).unbind("click",chatInvoker)),$currAuthorProfile.find("div").unbind("click",chatInvoker).click(chatInvoker),$currAuthorProfile.find("a").unbind("click",chatInvoker).click(chatInvoker)}function manageUserChatStatusInTopicList($authorContainers,status,isTopic){var flag=0;"4"==status?(flag=1,$authorContainers.attr("class","wms-4 flLeft").unbind("click",chatInvoker).click(chatInvoker),"IS_SINGLE_POST"==isTopic&&$authorContainers.find('div[purpose="chatStatus"]').html(i18n["zohodiscussions.chat.busy"])):"3"==status?(flag=1,$authorContainers.attr("class","wms-3 flLeft").unbind("click",chatInvoker).click(chatInvoker),"IS_SINGLE_POST"==isTopic&&$authorContainers.find('div[purpose="chatStatus"]').html(i18n["zohodiscussions.chat.idle"])):"1"==status?(flag=1,$authorContainers.attr("class","wms-1 flLeft").unbind("click",chatInvoker).click(chatInvoker),"IS_SINGLE_POST"==isTopic&&$authorContainers.find('div[purpose="chatStatus"]').html(i18n["zohodiscussions.chat.available"])):"0"==status?(flag=1,$authorContainers.attr("class","wms-0 flLeft").unbind("click",chatInvoker).click(chatInvoker),"IS_SINGLE_POST"==isTopic&&$authorContainers.find('div[purpose="chatStatus"]').html(i18n["zohodiscussions.chat.offline"])):"-4"==status?$authorContainers.attr("class","flLeft").unbind("click",chatInvoker):"-5"==status&&$authorContainers.attr("class","flLeft").unbind("click",chatInvoker),"topicList"==isTopic?1==flag?$authorContainers.addClass("authorChatPresence chatStyleOverride"):$authorContainers.remove():$authorContainers.addClass("authorChatPresence chatOverride")}function chatInvoker(){var $this=$(this),name=$this.attr("authorName"),authorId=$this.attr("authorId");null==authorId&&(authorId=$this.parent().attr("authorId"),name=$this.parent().attr("authorName"));var authStatus=WmsContacts.status(authorId);-1<authStatus&&!1!==authStatus?WebMessanger.chat(authorId):-1==authStatus?confirm(name+" "+i18n["zohodiscussions.chat.reminder"])&&WmsContacts.add("zoho",name,ZUID):-3==authStatus?WmsContacts.accept("zoho",name,ZUID):WmsContacts.add("zoho",name,ZUID)}function updatePresence(usid,uname,status){if("true"==ch){if($("#recentStickyPosts").is(":visible"))$("#recentStickyPosts >li >div.ashColorText >div.authorChatPresence").each(function(index,item){var $item=$(item);$item.attr("authorId")==usid&&manageUserChatStatusInTopicList($item,status)});if($("#recentAnnouncementPosts").is(":visible"))$("#recentAnnouncementPosts >li >div.ashColorText >div.authorChatPresence").each(function(index,item){var $item=$(item);$item.attr("authorId")==usid&&manageUserChatStatusInTopicList($item,status)});if($("#topicListMainContainer").is(":visible")){if(void 0!==(uCont=$.parseJSON($("#uListForStatusUpdate").html()))[zuid="z"+usid])for(i=0;i<uCont[zuid].length;i++){manageUserChatStatusInTopicList($("#uc_"+uCont[zuid][i]+"_"+usid),status,"topicList")}if($("#singleForumHeaderView").is(":visible"))manageUserChatStatus("moderatorOnlineStatus_"+$("#singleForumHeaderView").attr("forumId")+"_"+usid,status)}else if($("#SinglePostContainer").is(":visible")){var uCont,zuid,topicId=$("#SinglePostContainer").attr("forumTopicId");if(void 0!==(uCont=$.parseJSON($("#uListForStatusUpdate").html()))[zuid="z"+usid])for(i=0;i<uCont[zuid].length;i++){manageUserChatStatusInTopicList($("#uc_"+topicId+"_"+uCont[zuid][i]+"_"+usid),status,"IS_SINGLE_POST")}}else if($("#userProfileMainContainer").is(":visible"))manageUserChatStatus("userOnlineStatus_"+usid,status);else if($("#myAreaInnerMainContent").is(":visible")){if($("#profileDetailCont").is(":visible")){manageUserChatStatus("followersOnlineStatus_"+usid,status),manageUserChatStatus("followingOnlineStatus_"+usid,status),$("#current_recentActivity_List >li >div.authorChatPresence").each(function(index,item){var $item=$(item);$item.attr("authorId")==usid&&manageUserChatStatusInTopicList($item,status)})}else{var currView="";if($("#watchListInnerContent").is(":visible"))currView=$("#watchListInnerContent").find('div[status="show"]').attr("id");else if($("#privateMsgInnerContentent").is(":visible")){currView=$("#privateMsgInnerContent").find('div[status="show"]').attr("id")}if(""!=currView){("privateMsgInnerContent"==currView?$("#"+currView+" div.moderateSinglePost ul li img.authorChatPresence"):$("#"+currView+" div.moderateSinglePost ul li div.authorChatPresence")).each(function(index,item){var $item=$(item);$item.attr("authorId")==usid&&manageUserChatStatusInTopicList($item,status)})}}manageUserChatStatus("authorPopup_"+usid,status)}}}function addPrivateMessage($this){var toMember=$this.attr("toMember"),toMemberName=$this.attr("authorname"),$privateMsgPrompt=$("#privateMsgPrompt"),$privateMsgToMemberArea=$("#privateMsgToMemberArea"),$privateMsgTitleArea=$("#privateMsgTitleArea"),$privateMsgContentArea=$("#privateMsgContentArea"),$privateMsgToMemberId=$("#privateMsgToMemberId");$privateMsgToMemberId.val(""),$privateMsgToMemberArea.val(""),$privateMsgTitleArea.val(""),$privateMsgContentArea.val(""),$privateMsgToMemberId.val(toMember),$privateMsgToMemberArea.val(toMemberName),$privateMsgPrompt.show().parent().show(),$("#cancelPrivateMsgButton, #cancelPrivateMsg").unbind("click").click(function(){$privateMsgToMemberArea.val(""),$privateMsgTitleArea.val(""),$privateMsgContentArea.val("");var $writePMCaptcha=$("#writePMCaptcha");$writePMCaptcha.find("img").attr("src","/images/spacer.gif"),$writePMCaptcha.find(":input").val(""),$writePMCaptcha.hide(),$privateMsgPrompt.hide().parent().hide()}),$("#addNewPrivateMsg").unbind("click").click(function(){showLoadingImage();var contentToPost=$privateMsgContentArea.val();if(""==(contentToPost=contentToPost.replace(/^\s+/g,"").replace(/\s+$/g,"")))return hideLoadingImage(),void showMessage(i18n["zohodiscussions.writePost.noContentInPost"],"failure");var titleToPost=$privateMsgTitleArea.val();if(""==(titleToPost=titleToPost.replace(/^\s+/g,"").replace(/\s+$/g,"")))return hideLoadingImage(),void showMessage(i18n["zohodiscussions.writePost.noTitleInPost"],"failure");doAjaxAction("/addPrivateMsg.do",$privateMsgPrompt.find("form").serialize(),function(data){var $writePMCaptcha=$("#writePMCaptcha");($writePMCaptcha.find("img").attr("src","/images/spacer.gif"),$writePMCaptcha.find(":input").val(""),$writePMCaptcha.hide(),hideLoadingImage(),"SUCCESS"==data)?showTipper(i18n["zohodiscussions.privateMsg.successfullyPMAdded"],"success"):(showMessage(toEvaluateData(data).reason,"failure"),hideLoadingImage());$privateMsgPrompt.hide().parent().hide()},function(err){var responseData=toEvaluateData(err.responseText);if("HIP_REQUIRED"==responseData.errorcode){var $writePMCaptcha=$("#writePMCaptcha");"new"==$writePMCaptcha.attr("currCaptcha")?showMessage(i18n["zohodiscussions.writePost.captchaMsg"],"failure"):showMessage(i18n["zohodiscussions.writePost.captchaErrorMsg"],"failure"),$writePMCaptcha.find('img[purpose="captchaImage"]').replaceWith("<img purpose=captchaImage name=hipImg border=0 src=/showcaptcha?digest="+responseData.reason+" align=absmiddle alt=HIP image>"),$("#captchaCodePM").attr("name",responseData.reason),$writePMCaptcha.attr("currCaptcha","old"),$writePMCaptcha.show()}else showMessage(responseData.reason,"failure");hideLoadingImage()})}),$privateMsgTitleArea.focus()}function myAreaEmbedClickAction(actionURL,myAreaAction){return isZSupport?getMyAreaBindActions(myAreaAction,"myarea"):"false"==isTopicQuickView&&(window.location.href=actionURL),!1}function authorProfileEmbedClickAction(myAreaAction,authorName,authorId){return null!=typeof authorName&&"guest"!=typeof authorName&&(null!=typeof authorId&&void 0!==authorId||(authorId=""),isZIntranet?void 0:("myarea"==myAreaAction?(newMyAreaClick(forumGroupId),getMyAreaBindActions("dashboard",myAreaAction,"niceurl")):"user"==myAreaAction?""!=authorId?ZSupport.callBackUserAction(forumGroupId,"",authorId):ZSupport.callBackUserAction(forumGroupId,authorName):"false"==isTopicQuickView&&(window.location.href=actionURL),!1))}function Collaboration(){}function WmsContactImpl(){}function WmsliteImpl(){}function bindReportsClicks($contextaction){$("#reportsLeftPanel").unbind("click",processReportClick).click(processReportClick),$("#reportsDateFilterArrow,#allTypeTrendDateFilter,#postResponseDateFilter,#repUnrepDateFilter,#topicStatusDateFilter,#mostVotedTopicsArrow,#userParticipationDateFilter").click(function(){displayStatisticsArrowClick($(this))}),$("#forumDropDownArrow").unbind("click",processForumArrowClick).click(processForumArrowClick),bindDateFilterClick($("#dateFilterCont").find("button")),avtivateReportsCalendar(),showOverallUsageCharts()}function avtivateReportsCalendar(){if(void 0===isZSupport||!1===isZSupport){if($("#dateFilterCont").length<=0)return;setDate("#fromDate"),setDate("#toDate")}}function setDate(id){$(id).datepicker({changeMonth:!0,changeYear:!0,dateFormat:"yy-mm-dd",gotoCurrent:!0,onChangeMonthYear:function(year,month,inst){month=month.toString().length<2?"0"+month:month,$this=$(this);var date=$.trim($this.val());""!=date&&$this.val(year+"-"+month+"-"+date.substring(date.length-2))}})}function processReportClick(event){var $target=$(event.target),$targetParent=$target.parent();$targetParent.is('[topicType="-1"]')||$targetParent.is('[topicType="0"]')||$targetParent.is('[topicType="1"]')||$targetParent.is('[topicType="2"]')||$targetParent.is('[topicType="3"]')||$targetParent.is('[topicType="4"]')||$targetParent.is('[purpose="fbReports"]')?bindReportsAction($targetParent):($target.is('[topicType="-1"]')||$target.is('[topicType="0"]')||$target.is('[topicType="1"]')||$target.is('[topicType="2"]')||$target.is('[topicType="3"]')||$target.is('[topicType="4"]')||$target.is('[purpose="fbReports"]'))&&bindReportsAction($target)}function bindReportsAction($target){showLoadingImage(),$("#dateFilter").text($("#reportsDateFilterArrow .forumOptions ul").find('li[dateFilter="1"]').text()),$("#forumDropDownArrow div").text($("#reportsForumFilter").find('li[forumId="-1"]').text()).attr("forumId","-1"),$("#dateFilterCont").hide(),$target.parent("ul").find("li").removeClass("selected"),$target.addClass("selected");var options={};options.forumGroupId=forumGroupId,options[csrfParamName]=csrfToken,options.ch=ch;var purpose=$target.attr("purpose"),isZSNewUI=$target.attr("isZSNewUI"),forumId=$target.attr("forumId"),categoryId=$target.attr("categoryId"),topicType=$target.attr("topicType");categoryId&&(options.categoryId=categoryId),forumId&&(options.forumId=forumId);var title=$target.find("a").text();topicType&&(options.topicType=topicType);var action=$("#reportsLeftPanel li.selected").attr("action");"/topicTypeReports.do"==action?$("#topicTypesFilterCont").show():$("#topicTypesFilterCont").hide(),purpose&&"fbReports"==purpose||isZSNewUI&&"true"===isZSNewUI?$("#reportsForumFilterCont").hide():$("#reportsForumFilterCont").show(),doAjaxAction(action,options,function(data){$("#reportsInnerContent").get(0).innerHTML=data,$("#reportsTitle").text(title),bindReportsClicks(),hideLoadingImage()})}function displayStatisticsArrowClick($target){var $listOfStatisticsOptions=$target.find("div.forumOptions");$listOfStatisticsOptions.show(),$listOfStatisticsOptions.find("li").unbind("click").click(function(){var $this=$(this),dateFilter=$this.attr("dateFilter");$("#postRespDateFilterText,#dateFilter").attr("dateFilter",dateFilter).text($this.text()),$listOfStatisticsOptions.mouseout(),"2"!=dateFilter?($("#dateFilterCont").hide(),doDateFilterAction($this)):$("#dateFilterCont").show()}),$target.hover(function(){var handle=$target.data("destroyHandle");$target.data("destroyHandle",!1),handle&&clearTimeout(handle)},function(){var handle=setTimeout(function(){$listOfStatisticsOptions.hide(),$target.unbind("mouseenter").unbind("mouseleave")},500);$target.data("destroyHandle",handle)})}function bindDateFilterClick($target){$target.unbind("click").click(function(){doDateFilterAction($(this))})}function doDateFilterAction($target){var $this=$target,options={},dateFilter=$this.attr("dateFilter");if("2"==dateFilter){var startDate=$target.parents().find('input[name="startDate"]').val(),endDate=$target.parents().find('input[name="endDate"]').val();if(!startDate||""==startDate)return void showMessage(i18n["zohodiscussions.statistics.provideStartDateMsg"],"failure");if(void 0!==isZSupport&&!0===isZSupport){var $startDate=$target.parents().find('input[name="startDate"]'),$endDate=$target.parents().find('input[name="endDate"]'),startDateDefaultValue=$startDate.val(),endDateDefaultValue=$endDate.val(),startDateSplit=startDateDefaultValue.split("/"),endDateSplit=endDateDefaultValue.split("/");startDate=startDateSplit[2]+"-"+startDateSplit[1]+"-"+startDateSplit[0],endDate=endDateSplit[2]+"-"+endDateSplit[1]+"-"+endDateSplit[0]}options.startDate=startDate,endDate&&""!=endDate&&(options.endDate=endDate)}var isTopFilter="true"==$this.attr("topFilter");options.dateFilter=dateFilter,options.forumGroupId=forumGroupId;var forumId=$("#forumDropDownArrow div").attr("forumId");forumId&&(options.forumId=forumId);var userId=$this.attr("authorId");userId&&0<userId&&(options.userId=userId),options[csrfParamName]=csrfToken;var action=isTopFilter?$("#reportsLeftPanel li.selected").attr("action"):$this.attr("action"),topicType=$("#reportsLeftPanel li.selected").attr("topicType");topicType&&(options.topicType=topicType);var chartFor=$this.attr("chartFor");chartFor&&(options.chartFor=chartFor),showLoadingImage(),doAjaxAction(action,options,function(data){hideLoadingImage(),(isTopFilter?$("#reportsInnerContent"):$this.parents("#allTypeTrendChartCont,#postRespTrendChartCont,#repUnrepChartCont,#topicStatusPieChartCont,#mostVotedTopicsChartCont,#userParticipationChartCont")).get(0).innerHTML=data,bindReportsClicks()},function(err,desc,exceptionobj){showMessage(toEvaluateData(err.responseText).reason,"failure"),hideLoadingImage()})}function processForumArrowClick(event){$(event.target);var $forumFilterList=$("#reportsForumFilterCont div.moreOptions");$forumFilterList.show(),$forumFilterList.find("ul").find("li").unbind("click").click(function(){var $listClick=$(this),options={};$forumFilterList.hide(),options.forumGroupId=forumGroupId,options[csrfParamName]=csrfToken;var forumId=$listClick.attr("forumId");options.forumId=forumId;var dateFilter=$("#dateFilter").attr("dateFilter");if("2"==(options.dateFilter=dateFilter)){var $dateFilterCont=$("#dateFilterCont"),startDate=$dateFilterCont.find('input[name="startDate"]').val(),endDate=$dateFilterCont.find('input[name="endDate"]').val();if(!startDate||""==startDate)return void showMessage(i18n["zohodiscussions.statistics.provideStartDateMsg"],"failure");options.startDate=startDate,endDate&&""!=endDate&&(options.endDate=endDate)}var topicType=$("#reportsLeftPanel li.selected").attr("topicType");topicType&&(options.topicType=topicType),showLoadingImage(),doAjaxAction($("#reportsLeftPanel li.selected").attr("action"),options,function(data){hideLoadingImage(),$("#reportsInnerContent").get(0).innerHTML=data,$("#forumDropDownArrow div").text($listClick.text()).attr("forumId",forumId),bindReportsClicks()},function(err,desc,exceptionobj){showMessage(toEvaluateData(err.responseText).reason,"failure"),hideLoadingImage()})}),$forumFilterList.hover(function(){var handle=$forumFilterList.data("destroyHandle");handle&&clearTimeout(handle)},function(){var handle=setTimeout(function(){$forumFilterList.hide(),$forumFilterList.unbind("mouseenter").unbind("mouseleave")},500);$forumFilterList.data("destroyHandle",handle)})}function showOverallUsageCharts(){isImageLoaded("topicTypeTrendImgCont");for(var chartForArr=[0,1,2,3,4],idx=0;idx<chartForArr.length;idx++)isImageLoaded("postRespTrendImgCont_"+chartForArr[idx]);isImageLoaded("statusPieChartImgCont"),isImageLoaded("statusMeterPlotImgCont"),isImageLoaded("repUnrepPieChartImgCont"),isImageLoaded("repUnrepMeterImgCont"),isImageLoaded("userParticipationImgCont")}function isImageLoaded(targetId){var $chartCont=$("#"+targetId);if(0<$chartCont.length){var imgLength=$chartCont.find("img").length,imgIndex=0;$chartCont.find("img").one("load",function(){++imgIndex==imgLength&&($chartCont.show(),$chartCont.prev('div[purpose="chartLoading"]').hide()),lightBox("#"+targetId)}).each(function(){this.complete&&$(this).trigger("load")})}}function initialiseUserActivityChart(){$("#postResponseDateFilter").click(function(){displayStatisticsArrowClick($(this))}),isImageLoaded("postRespTrendImgCont_2"),bindDateFilterClick($("#dateFilterCont").find("button")),avtivateReportsCalendar()}function triggerTopicType(topicType){$("#reportsLeftPanel").find('li[topicType="'+topicType+'"]').trigger("click")}function portalUsersList(){var privateForumMembersList=null,privateForumModeratorsList=null;if(void 0!==$("#privateForumMembersList").val()&&""!==$("#privateForumMembersList").val()){privateForumMembersList=$("#privateForumMembersList").val().split(",");for(var zdiscussionsUserEmailIdArr=$("#privateForumMembers").val().split(","),membercounter=0;membercounter<privateForumMembersList.length;membercounter++){$('<span currTagName="'+zdiscussionsUserEmailIdArr[membercounter]+'">'+privateForumMembersList[membercounter]+'<a class="removeTag">&nbsp;x</a></span>').insertBefore($("#forumMembersAutoSugg"))}}if(void 0!==$("#privateForumModeratorsList").val()&&""!==$("#privateForumModeratorsList").val()){privateForumModeratorsList=$("#privateForumModeratorsList").val().split(",");var zdiscussionsModeratorEmailIdArr=$("#privateForumModerators").val().split(",");for(membercounter=0;membercounter<privateForumModeratorsList.length;membercounter++){$('<span currTagName="'+zdiscussionsModeratorEmailIdArr[membercounter]+'">'+privateForumModeratorsList[membercounter]+'<a class="removeTag">&nbsp;x</a></span>').insertBefore($("#forumModeratorsAutoSugg"))}}$("#privateForumMembersContainer").click(function(){var $target=$("#forumMembersAutoSugg"),$containerId=$("#privateForumMembers");$target.focus(),portalUsersAutoSuggest($target,$containerId,privateForumMembersList)}),$("#privateForumModeratorsContainer").click(function(){var $target=$("#forumModeratorsAutoSugg"),$containerId=$("#privateForumModerators");$target.focus(),portalUsersAutoSuggest($target,$containerId,privateForumModeratorsList)})}function portalUsersObjFilter($containerId,allUsersList,privateForumUsersList){var portalUsersListJSON=[];if("privateForumMembers"===$containerId.attr("id"))for(var portalCreatedUserId=$("#portalCreatedUser").val(),membercounter=0;membercounter<allUsersList.length;membercounter++)portalCreatedUserId.toString()===allUsersList[membercounter].userid.toString()&&allUsersList.splice(membercounter,1);for(var allportalMember=0;allportalMember<allUsersList.length;allportalMember++)null!=privateForumUsersList?-1==privateForumUsersList.indexOf(allUsersList[allportalMember].label.toString())&&portalUsersListJSON.push(allUsersList[allportalMember]):portalUsersListJSON.push(allUsersList[allportalMember]);return portalUsersListJSON}function portalUsersAutoSuggest($target,$containerId,privateForumUsersList){$target.bind("paste",function(e){setTimeout(function(){var pasetedStr=$target.val();if(null!=pasetedStr){pasetedStr=pasetedStr.split(",");for(var counter=0;counter<pasetedStr.length;counter++){var tag=$.trim(pasetedStr[counter]);if(""!=tag&&"forumallTags"===$target.attr("id"))addTagsToContainer(tag,$("#forumTags"),$target);else if("allForumUsersEmail"===$target.attr("id")){/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/.test(tag)&&addTagsToContainer(tag,$("#emailIds"),$target)}}}})});var zdiscussionsUserId=$containerId.val(),targetParent=$target.parent().attr("id"),containerTopValue=0,autoSuggSearchListJSON=null;$target.autocomplete({source:function(request,response){if(2==$target.val().length||4<=$target.val().length){var searchQuery=$target.val().toLowerCase();if(void 0===$target.data(searchQuery)&&""===$target.data(searchQuery)||(autoSuggSearchListJSON=$target.data(searchQuery)),null==autoSuggSearchListJSON&&4<$target.val().length){var queryStr=$target.val().toLowerCase();queryStr=queryStr.substring(0,4),null!=$target.data(queryStr)&&(autoSuggSearchListJSON=$target.data(queryStr))}if(null==autoSuggSearchListJSON){var options={};options.forumGroupId=forumGroupId,options.searchFor=searchQuery,options[csrfParamName]=csrfToken;var action="";action="forumallTags"===$target.attr("id")?"/getTagsSearchResult.do":"/getUsersSearchResult.do",$(".ui-autocomplete").is(":visible")||($("#"+targetParent+"_search").show(),"privateForumMembers"==$containerId.attr("id")||"privateForumModerators"==$containerId.attr("id")?($("#"+targetParent+"_search").css("top",$("#"+targetParent).offset().top+59+"px"),$("#"+targetParent+"_search").css("left",$("#"+targetParent).offset().left+"px")):$("#"+targetParent+"_search").css("top",$("#"+targetParent).offset().top-22+"px"),$("#"+targetParent+"_search").css("width",$("#"+targetParent).width()+"px")),doAjaxAction(action,options,function(data){autoSuggSearchListJSON=$.parseJSON(data),$target.data(searchQuery,autoSuggSearchListJSON),$("#"+targetParent+"_search").hide(),$target.autocomplete("search")},function(errordata){$("#"+targetParent+"_search").hide()})}}if(null!=autoSuggSearchListJSON){"privateForumMembers"!=$containerId.attr("id")&&"privateForumModerators"!=$containerId.attr("id")||(autoSuggSearchListJSON=portalUsersObjFilter($containerId,autoSuggSearchListJSON,privateForumUsersList));for(var data=$.grep(autoSuggSearchListJSON,function(value){if(value.label.substring(0,request.term.length).toLowerCase()===request.term.toLowerCase())return!0}),selectedUsersList=$containerId.val().split(","),selecteduser=0;selecteduser<selectedUsersList.length-1;selecteduser++)for(var popupcounter=0;popupcounter<data.length;popupcounter++)(null==data[popupcounter].userid?data[popupcounter].label:data[popupcounter].userid)==selectedUsersList[selecteduser]&&data.splice(popupcounter,1);response(data=data.splice(0,5)),"allForumUsersEmail"===$target.attr("id")?containerTopValue=$(".userAutoSuggContainer").offset().top-7-45*data.length:"forumallTags"===$target.attr("id")&&(containerTopValue=$("#tagsContainer").offset().top-6-$(".ui-autocomplete").height()),0!==containerTopValue?$(".ui-autocomplete").css("top",containerTopValue+"px"):$(".ui-autocomplete").css("top",$("#"+targetParent).offset().top+59+"px"),$(".ui-autocomplete").css("width",$("#"+targetParent).width()+"px"),$(".ui-autocomplete").css("left",$("#"+targetParent).offset().left+"px")}},select:function(event,ui){var span="";return null==ui.item.userid?(zdiscussionsUserId=$containerId.val()+ui.item.label+",",span='<span currTagName="'+ui.item.label+'">'+ui.item.label+'<a class="removeTag">&nbsp;x</a></span>'):(zdiscussionsUserId=$containerId.val()+ui.item.userid+",",span='<span currTagName="'+ui.item.userid+'">'+ui.item.label+'<a class="removeTag">&nbsp;x</a></span>'),$target.before(span),$containerId.val(zdiscussionsUserId),!1},create:function(){$(this).data("autocomplete")._renderItem=function(ul,item){return null==item.useravatar?$("<li></li>").data("item.autocomplete",item).append("<a style='text-decoration:none;cursor:hand;'>"+item.label+"&nbsp;</img></a>").appendTo(ul):$("<li></li>").data("item.autocomplete",item).append("<a style='text-decoration:none;cursor:hand;'><img src='"+item.useravatar+"' width='40' height='40' style='vertical-align: middle;white-space:nowrap;'>&nbsp;&nbsp;&nbsp;"+item.label+"&nbsp;</img></a>").appendTo(ul)}},close:function(event,ui){1!==event.which&&13!==event.which||$(".ui-autocomplete-input").val("")}}),$target.parent().click(function(){$target.focus()}),$(".removeTag",$("#"+targetParent)).live("click",function(){removeTagsToContainer($(this).parent().attr("currTagName"),$containerId),$(this).parent().remove()})}function deleteOrAddTags(event,$targetTxtBox,$targetContainerId){if(8===event.keyCode||46===event.keyCode)"background-color:#E0E0E0"===$targetTxtBox.prev().attr("style")?(removeTagsToContainer(void 0,$targetContainerId),$targetTxtBox.prev().remove()):0<$targetTxtBox.prev().length&&""===$targetTxtBox.val()&&$targetTxtBox.prev().attr("style","background-color:#E0E0E0");else if(188===event.keyCode){var tag=$targetTxtBox.val().slice(0,-1);if(tag=$.trim(tag),"forumTags"===$targetContainerId.attr("id")&&""!=(tag=tag.replace(/^\s+|\s+$/g," ").replace(/\s+/g," "))&&(null==tag.match(/^[^\^\"'()~`!@#$%&:;\/\\?|<>{}[\]*-+=]+$/)?showMessage(i18n["zohodiscussions.singlepost.specialCharacterNotAllowedMsg"],"failure"):addTagsToContainer(tag,$targetContainerId,$targetTxtBox)),"emailIds"===$targetContainerId.attr("id")||"privateForumMembers"===$targetContainerId.attr("id")||"privateForumModerators"===$targetContainerId.attr("id")){/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/.test(tag)?addTagsToContainer(tag,$targetContainerId,$targetTxtBox):showTipper(i18n["zohodiscussions.feedbackwidget.emailIdemptyErrMsg"])}$targetTxtBox.val("")}else"background-color:#E0E0E0"===$targetTxtBox.prev().attr("style")&&$targetTxtBox.prev().attr("style","background-color:#EFEFEF")}function removeTagsToContainer(removeCurrTag,$targetContainer){var selectedMembersList=$targetContainer.val().slice(0,-1).split(","),elementArrLength=selectedMembersList.length,removeContainerTag="";void 0===removeCurrTag&&(elementArrLength-=1);for(var counter=0;counter<elementArrLength;counter++)selectedMembersList[counter]!==removeCurrTag&&(removeContainerTag=removeContainerTag+selectedMembersList[counter]+",");","===removeContainerTag&&(removeContainerTag=""),$targetContainer.val(removeContainerTag)}function addTagsToContainer(addTagName,$targetContainer,$targetTxtBox){var selectedMembersList=$targetContainer.val();selectedMembersList=selectedMembersList+addTagName+",",$targetContainer.val(selectedMembersList);var span='<span currTagName="'+addTagName+'">'+addTagName+'<a class="removeTag">&nbsp;x</a></span>';$targetTxtBox.before(span),$targetTxtBox.val("")}function usersListAutoSuggest(filterPurpose,fetchPage){if("pendingUser"==filterPurpose)return $("#searchAction").show(),$("#searchAction").click(function(){userSearchAction()}),!1;var portalUsersListJSON=null;$("#searchText").keyup(function(event){var lookupUser=$(this).val().toLowerCase();if(""!==lookupUser)if(null==$("#searchText").data(filterPurpose+"_"+lookupUser)||""==$("#searchText").data(filterPurpose+"_"+lookupUser)){var options={};options.forumGroupId=forumGroupId,options.filterPurpose=filterPurpose,options.searchFor=lookupUser,options[csrfParamName]=csrfToken,options.fetchPage=fetchPage,doAjaxAction("/getUsersSearchResult.do",options,function(data){portalUsersListJSON=$.parseJSON(data),$("#searchText").data(filterPurpose+"_"+lookupUser,portalUsersListJSON),null!=portalUsersListJSON&&""!=portalUsersListJSON&&$("#searchText").keyup()})}else portalUsersListJSON=$("#searchText").data(filterPurpose+"_"+lookupUser);null!=portalUsersListJSON&&membersListTemplate(lookupUser,filterPurpose,portalUsersListJSON)})}function getMoreUsers(filterPurpose,fetchPage,searchFor){var portalUsersListJSON=null;if(searchFor=searchFor.toLowerCase(),null==$("#searchText").data(filterPurpose+"_"+searchFor+"_"+fetchPage)||""==$("#searchText").data(filterPurpose+"_"+searchFor+"_"+fetchPage)){var options={};options.forumGroupId=forumGroupId,options.filterPurpose=filterPurpose,options.searchFor=searchFor,options[csrfParamName]=csrfToken,options.fetchPage=fetchPage,doAjaxAction("/getUsersSearchResult.do",options,function(data){portalUsersListJSON=$.parseJSON(data),$("#searchText").data(filterPurpose+"_"+searchFor+"_"+fetchPage,portalUsersListJSON),null!=portalUsersListJSON&&membersListTemplate(searchFor,filterPurpose,portalUsersListJSON)})}else portalUsersListJSON=$("#searchText").data(filterPurpose+"_"+searchFor+"_"+fetchPage),membersListTemplate(searchFor,filterPurpose,portalUsersListJSON)}function membersListTemplate(lookupUser,filterPurpose,portalUsersListJSON){var $container=$("#userFilterContainer").find(".wrapper");$container.html(""),$.template("usersListContainer",'<div id="usercont" class="ashBorderBox" ><fieldset class="hideIt"><legend>'+i18n["zohodiscussions.general.allUsers"]+'</legend><div class="subFrompageslist"><ul class="resetMargin"></ul></div>'),$.tmpl("usersListContainer").appendTo($container);for(var usercounter=0;usercounter<25&&usercounter<portalUsersListJSON.length;usercounter++)-1<portalUsersListJSON[usercounter].label.toLowerCase().indexOf(lookupUser)&&($.template("usersList",'<li id="manageUserActions_${userid}"><div class="flLeft photos"><img src="${useravatar}" /></div><div class="flLeft"><span class="listText"> ${label} </span>{{if(userlabel != null)}}<span class="activeLabel tinyText">${userlabel}</span>{{/if}}<div class="ashText metaList"><span class="greenText">'+i18n["zohodiscussions.general.E-Mail"]+': <a href="javaScript:;">${emailid}</a></span></div><div class="ashText metaList"><span class="greenText">{{if isadminuser}}'+i18n["zohodiscussions.email.action.admin"]+"{{else}}"+i18n["zohodiscussions.UserDetails.Member"]+'{{/if}}</span></div></div><div class="iconArea flRight">{{if !isblocked}}<a class="action flLeft" href="javascript:;" userId="${userid}" userName="${label}" purpose="userSettings"><div class="imgCogIcon flLeft"></div>'+i18n["zohodiscussions.general.manage"]+'</a>{{/if}}{{if canblockthisuser}}{{if !isblocked}} <a class="action" href="javascript:;" id="blockUser" purpose="blockUser" userId="${userid}" userName="${label}"><div class="imgDisableIcon flLeft"></div>'+i18n["zohodiscussions.general.block"]+'</a>{{else}} <a class="action" href="javascript:;" id="blockUser" purpose="unblockUser" userId="${userid}" userName="${label}"><div class="imgDisableIcon flLeft"></div>'+i18n["zohodiscussions.general.unblock"]+'</a> {{/if}}{{/if}} {{if canmoderateuserortopic}}<a href="javascript:;" class="action ${ismoderate != true?"moderate":"unmoderate"}" purpose="moderateUser" id="moderateUser" userId="${userid}" userName="${label}"><div class="imgModerateIcon flLeft"></div>${ismoderate == true?"'+i18n["zohodiscussions.moderationList.Unmoderate"]+'":"'+i18n["zohodiscussions.moderationList.moderate"]+'"}</a>{{/if}} {{if candeletethisuser}}<a href="javascript:;" class="action" userId="${userid}" userName="${label}" purpose="userDelete"><div class="imgDeleteIcon flLeft" ></div>'+i18n["zohodiscussions.general.delete"]+"</a>{{/if}}</div></li>"),$.tmpl("usersList",portalUsersListJSON[usercounter]).appendTo($container.find(".resetMargin")));if(""===$container.find(".resetMargin").html()&&($.template("userNotFound",i18n["zohodiscussions.allportalmemberslist.nosearchingResult"]),$.tmpl("userNotFound",portalUsersListJSON[0]).appendTo($container.find(".resetMargin"))),0<portalUsersListJSON.length){var prevPageLinkStyle=1==portalUsersListJSON[0].fetchpage?"navBtnDisabled":"navBtnEnabled",nextPageLinkStyle=24<portalUsersListJSON.length?"navBtnEnabled":"navBtnDisabled",startPost=1;1<portalUsersListJSON[0].fetchpage&&(startPost=25*(portalUsersListJSON[0].fetchpage-1)+1),$.template("usersPaginationContainer",'<ul class="ulNoStyle flRight smallText" id="usersPaginationContainer"><li class="flLeft '+prevPageLinkStyle+'" onclick=getMoreUsers("'+filterPurpose+'",${fetchpage-1},"'+$("#searchText").val().toLowerCase()+'");  fetchPage="${fetchpage}">&laquo; ${prev}</li><li class="flLeft" style="margin:5px 3px 2px;padding:3px;"><span style="padding-top:3px;">'+startPost+" - "+(startPost+portalUsersListJSON.length-1)+'</span></li><li class="flLeft '+nextPageLinkStyle+'" onclick=getMoreUsers("'+filterPurpose+'",${fetchpage+1},"'+$("#searchText").val().toLowerCase()+'"); fetchPage="${fetchpage+1}">${next} &raquo;</li><ul>'),$.tmpl("usersPaginationContainer",portalUsersListJSON[0]).appendTo($container.find(".hideIt"))}}Collaboration.handleUserList=function(chid,list){},Collaboration.handleMessage=function(chid,uname,zuid,dname,msg){},Collaboration.handlePresence=function(chid,uname,zuid,dname,status){},Collaboration.join=function(chid){WebMessanger.joinCollab(chid)},Collaboration.quit=function(chid){WebMessanger.quit(chid)},Collaboration.serverup=function(){},Collaboration.serverdown=function(){},Collaboration.handleZohoMessage=function(prd,msg,url,urlstring,category,sender,att,params,id,dname,orgs,groups){return"FM"==prd&&(setTimeout(function(){showBubble(msg,category)},2),!0)},Collaboration.handleCustomMessage=function(msg){},Collaboration.handleCrossProductMessage=function(prd,msg){},Collaboration.onConnect=function(){},Collaboration.openURL=function(url,urlstring,attachments,prd){return!0},Collaboration.handleCollabAdd=function(uname,dname,zuid,time,chid){},Collaboration.handleCollabDelete=function(uname,dname,zuid,time,chid){},Collaboration.handleUserAdd=function(chid,userObj){},Collaboration.handleUserDeleted=function(chid,userObj){},Collaboration.handleIsOnline=function(statusobj){updateStatus(statusobj)},Collaboration.handleLogout=function(reason){setTimeout(function(){$.get("/cleardomain.do","",function(){window.location.href=window.location.href})},5)},Collaboration.goOffline=function(){},Collaboration.handleChatNotifyMessage=function(chid,sender,msgObj){},Collaboration.getPageTitle=function(){return!1},Collaboration.handleWmsDisable=function(reason){setTimeout(function(){$.get("/cleardomain.do","",function(){window.location.href=window.location.href})},5)},Collaboration.handleServiceMessage=function(msgObj){},Collaboration.handleComposeMail=function(toemailId,ccemailId){return!1},Collaboration.handleLanguageChange=function(msgObj){},WmsContactImpl.handlePresence=function(zuid,uname,dname,scode,statusmsg){setTimeout(function(){updatePresence(zuid,uname,scode)},2)},WmsContactImpl.handleAddressBook=function(){},WmsContactImpl.handleInvite=function(zuid,uname,dname){},WmsContactImpl.notifyInvite=function(zuid,uname,dname){},WmsContactImpl.handleAccept=function(zuid,uname,dname,scode,statusmsg){},WmsContactImpl.notifyAccept=function(zuid,uname,dname,scode,statusmsg){},WmsContactImpl.handleReject=function(zuid,uname,dname){},WmsContactImpl.notifyRemove=function(zuid,uname,dname){},WmsContactImpl.handleDelete=function(zuid,uname,dname){},WmsContactImpl.handleContactUpdated=function(){},WmsContactImpl.handleStatusMessage=function(status,scode){},WmsContactImpl.handeAllStatusMessages=function(){},WmsContactImpl.handleHideContactsUI=function(){},WmsContactImpl.handleShowContactsUI=function(){},WmsContactImpl.handleGetContacts=function(){var dataOb=WmsContacts.getZohoContacts();if($("#topicListMainContainer").is(":visible")||$("#allForums_MainContentCont").is(":visible"))setPresenceInTopicList(dataOb),$("#singleForumHeaderView").is(":visible")&&setPresence(dataOb,"moderatorsChatList_"+$("#singleForumHeaderView").attr("forumId"));else if($("#SinglePostContainer").is(":visible")){setPresenceInTopicList(dataOb,$("#SinglePostContainer").attr("forumtopicid"))}else if($("#myAreaParentContainer").is(":visible"))$("#recentActivityContent").is(":visible")?(setPresenceInMyArea(dataOb,"current_recentActivity_List"),setPresence(dataOb,"followingUserDetails"),setPresence(dataOb,"followersUserDetails")):$("#watchListInnerContent").is(":visible")?setPresenceInMyArea(dataOb,"userChat_watchTopics"):$("#privateMsgInnerContent").is(":visible")&&setPresenceInMyArea(dataOb,"userChat_inbox");else if($("#userProfileMainContainer").is(":visible")){var authorId=$("#userProfileMainContainer").attr("authorId");if("undefined"!=typeof WmsContacts&&"true"==ch){var authStatus=WmsContacts.status(authorId);!1===authStatus&&(authStatus=9),manageUserChatStatus("userOnlineStatus_"+authorId,authStatus)}}},WmsContactImpl.handleMPReject=function(protocol,contactname,loginname){},WmsContactImpl.handleMPAccept=function(protocol,contactname,loginname){},WmsContactImpl.handleMPDelete=function(protocol,contactname,loginname){},WmsContactImpl.handleMPAdd=function(protocol,contactname,loginname){},WmsContactImpl.handleMPInvite=function(protocol,contactname,loginname){},WmsContactImpl.handleLogin=function(loginname,status,statusmsg,protocol){},WmsContactImpl.handleLogout=function(loginname,status,statusmsg,protocol){},WmsContactImpl.handleGetAccounts=function(accountslist){},WmsContactImpl.handleInvitations=function(invitearr){},WmsliteImpl.serverdown=function(){},WmsliteImpl.serverup=function(){},WmsliteImpl.handleMessage=function(mtype,msgObj){},WmsliteImpl.handleAccountDisabled=function(reason){},WmsliteImpl.handleServiceMessage=function(msg){},WmsliteImpl.handleLogout=function(reason){setTimeout(function(){$.get("/cleardomain.do","",function(){var url=window.location.href;-1<url.indexOf("#")&&window.location.reload(),window.location.href=url})},5)};